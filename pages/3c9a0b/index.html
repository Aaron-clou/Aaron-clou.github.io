<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Type-parameter modes variance and cardinality preservation | Dafny</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/dafnycommunity/img/bgico2.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3282046_1qux519eoim.css">
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.5.0/dist/twikoo.all.min.js"></script>
    <meta name="description" content="Dafny中文社区">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/dafnycommunity/assets/css/0.styles.ecdcfe28.css" as="style"><link rel="preload" href="/dafnycommunity/assets/js/app.99d07194.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/2.ab4658c0.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/86.e3798708.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/7.5451cfed.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/4.06497870.js" as="script"><link rel="prefetch" href="/dafnycommunity/assets/js/10.ac38cab7.js"><link rel="prefetch" href="/dafnycommunity/assets/js/11.38d5ee16.js"><link rel="prefetch" href="/dafnycommunity/assets/js/12.c434ce94.js"><link rel="prefetch" href="/dafnycommunity/assets/js/13.4e922264.js"><link rel="prefetch" href="/dafnycommunity/assets/js/14.db841cfa.js"><link rel="prefetch" href="/dafnycommunity/assets/js/15.b9c227cc.js"><link rel="prefetch" href="/dafnycommunity/assets/js/16.41dadc32.js"><link rel="prefetch" href="/dafnycommunity/assets/js/17.48b5f1eb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/18.ec254833.js"><link rel="prefetch" href="/dafnycommunity/assets/js/19.288ca382.js"><link rel="prefetch" href="/dafnycommunity/assets/js/20.cfeb5fdb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/21.ce8ddc5a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/22.1b8c89f0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/23.cb062ace.js"><link rel="prefetch" href="/dafnycommunity/assets/js/24.ff271672.js"><link rel="prefetch" href="/dafnycommunity/assets/js/25.5541f3af.js"><link rel="prefetch" href="/dafnycommunity/assets/js/26.a1bbc4cb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/27.522d7884.js"><link rel="prefetch" href="/dafnycommunity/assets/js/28.9335c003.js"><link rel="prefetch" href="/dafnycommunity/assets/js/29.3fc0b07a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/3.ab8a97d8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/30.57708681.js"><link rel="prefetch" href="/dafnycommunity/assets/js/31.8571b949.js"><link rel="prefetch" href="/dafnycommunity/assets/js/32.f91be5de.js"><link rel="prefetch" href="/dafnycommunity/assets/js/33.8089c59b.js"><link rel="prefetch" href="/dafnycommunity/assets/js/34.874d0299.js"><link rel="prefetch" href="/dafnycommunity/assets/js/35.aff8adfd.js"><link rel="prefetch" href="/dafnycommunity/assets/js/36.ac78b86e.js"><link rel="prefetch" href="/dafnycommunity/assets/js/37.3fae0334.js"><link rel="prefetch" href="/dafnycommunity/assets/js/38.3db4a8d6.js"><link rel="prefetch" href="/dafnycommunity/assets/js/39.e585cc70.js"><link rel="prefetch" href="/dafnycommunity/assets/js/40.afcb8fbe.js"><link rel="prefetch" href="/dafnycommunity/assets/js/41.01f314da.js"><link rel="prefetch" href="/dafnycommunity/assets/js/42.8e4fe21d.js"><link rel="prefetch" href="/dafnycommunity/assets/js/43.571fb232.js"><link rel="prefetch" href="/dafnycommunity/assets/js/44.14aebad2.js"><link rel="prefetch" href="/dafnycommunity/assets/js/45.32f18970.js"><link rel="prefetch" href="/dafnycommunity/assets/js/46.ce0d522f.js"><link rel="prefetch" href="/dafnycommunity/assets/js/47.0bd83351.js"><link rel="prefetch" href="/dafnycommunity/assets/js/48.648f667a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/49.83709ae0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/5.b8548e7f.js"><link rel="prefetch" href="/dafnycommunity/assets/js/50.060e0424.js"><link rel="prefetch" href="/dafnycommunity/assets/js/51.a1291856.js"><link rel="prefetch" href="/dafnycommunity/assets/js/52.45f73497.js"><link rel="prefetch" href="/dafnycommunity/assets/js/53.525782ca.js"><link rel="prefetch" href="/dafnycommunity/assets/js/54.45a04a86.js"><link rel="prefetch" href="/dafnycommunity/assets/js/55.65a94ba0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/56.2d038113.js"><link rel="prefetch" href="/dafnycommunity/assets/js/57.579db650.js"><link rel="prefetch" href="/dafnycommunity/assets/js/58.832d4c89.js"><link rel="prefetch" href="/dafnycommunity/assets/js/59.13befb53.js"><link rel="prefetch" href="/dafnycommunity/assets/js/6.349bf431.js"><link rel="prefetch" href="/dafnycommunity/assets/js/60.41227bb1.js"><link rel="prefetch" href="/dafnycommunity/assets/js/61.1d1b92f4.js"><link rel="prefetch" href="/dafnycommunity/assets/js/62.2cdbc236.js"><link rel="prefetch" href="/dafnycommunity/assets/js/63.83de9482.js"><link rel="prefetch" href="/dafnycommunity/assets/js/64.4ecd0d25.js"><link rel="prefetch" href="/dafnycommunity/assets/js/65.25118b81.js"><link rel="prefetch" href="/dafnycommunity/assets/js/66.cdab1b54.js"><link rel="prefetch" href="/dafnycommunity/assets/js/67.655e6e84.js"><link rel="prefetch" href="/dafnycommunity/assets/js/68.84effb44.js"><link rel="prefetch" href="/dafnycommunity/assets/js/69.8f07f81a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/70.d9a299e6.js"><link rel="prefetch" href="/dafnycommunity/assets/js/71.16ef2000.js"><link rel="prefetch" href="/dafnycommunity/assets/js/72.8252acc5.js"><link rel="prefetch" href="/dafnycommunity/assets/js/73.f53e39bc.js"><link rel="prefetch" href="/dafnycommunity/assets/js/74.5ef910c4.js"><link rel="prefetch" href="/dafnycommunity/assets/js/75.72174d00.js"><link rel="prefetch" href="/dafnycommunity/assets/js/76.bebf75c9.js"><link rel="prefetch" href="/dafnycommunity/assets/js/77.b85547c7.js"><link rel="prefetch" href="/dafnycommunity/assets/js/78.a0a1f574.js"><link rel="prefetch" href="/dafnycommunity/assets/js/79.a731d645.js"><link rel="prefetch" href="/dafnycommunity/assets/js/8.522ce892.js"><link rel="prefetch" href="/dafnycommunity/assets/js/80.6e5b64b0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/81.6e19e312.js"><link rel="prefetch" href="/dafnycommunity/assets/js/82.9244e788.js"><link rel="prefetch" href="/dafnycommunity/assets/js/83.f08c5aed.js"><link rel="prefetch" href="/dafnycommunity/assets/js/84.085ef3f8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/85.c41e6e0e.js"><link rel="prefetch" href="/dafnycommunity/assets/js/87.fdac1c1c.js"><link rel="prefetch" href="/dafnycommunity/assets/js/88.665ac8c8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/89.78dc55eb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/9.4d4f4bdb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/90.4757b202.js"><link rel="prefetch" href="/dafnycommunity/assets/js/91.a0746cf2.js">
    <link rel="stylesheet" href="/dafnycommunity/assets/css/0.styles.ecdcfe28.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dafnycommunity/" class="home-link router-link-active"><img src="/dafnycommunity/img/logo-2.png" alt="Dafny" class="logo"> <span class="site-name can-hide">Dafny</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dafnycommunity/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="配置" class="dropdown-title"><a href="/dafnycommunity/peizhi/" class="link-title">配置</a> <span class="title" style="display:none;">配置</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>入门介绍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/56e571/" class="nav-link">什么是dafny?</a></li></ul></li><li class="dropdown-item"><h4>用起来吧！</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/4fa796/" class="nav-link">安装</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/085606/" class="nav-link">快速上手</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/39fb20/" class="nav-link">可能遇到的问题?</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><a href="/dafnycommunity/zhinan/" class="link-title">指南</a> <span class="title" style="display:none;">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafny快速入门</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/6e15a6/" class="nav-link">基础学习 Basic</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/eba166/" class="nav-link">方法 Method</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/83cdf9/" class="nav-link">关键字 Keyword</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/01d76e/" class="nav-link">函数 Function</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0fadc1/" class="nav-link">类 Class </a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a010ab/" class="nav-link">泛型 Generics</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/c4fda3/" class="nav-link">声明 Statement</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e8438e/" class="nav-link">表达式 Expression</a></li></ul></li><li class="dropdown-item"><h4>Dafny简单例子</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0978ce/" class="nav-link">寻找最大最小数和</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e3e481/" class="nav-link">斐波那契数列</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/02fdef/" class="nav-link">线性查询</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9b332b/" class="nav-link">引理-计算序列非负元素个数</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/3d1110/" class="nav-link">集合</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2146d4/" class="nav-link">终止</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/dafnycommunity/jiaocheng/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafny指导</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/877eb3/" class="nav-link">介绍</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/bf40c0/" class="nav-link">方法 Methods</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2e0c73/" class="nav-link">前置/后置条件 Pre/Postconditions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/36c1b4/" class="nav-link">断言 Assertions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a1d5a4/" class="nav-link">函数 Functions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/d89435/" class="nav-link">循环不变体 Loop Invariants</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/828a83/" class="nav-link">数组 Arrays</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/17e8d1/" class="nav-link">量词(函数) Quantifiers</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cc01af/" class="nav-link">谓词(函数) Predicates</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/13bbcd/" class="nav-link">框架 Framing</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1319be/" class="nav-link">二分搜索 Binary Search</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/30a8c2/" class="nav-link">总结</a></li></ul></li><li class="dropdown-item"><h4>Dafny进阶语法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/273cac/" class="nav-link">引理和归纳 Lemmas and Induction</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9d19b8/" class="nav-link">模块 Modules</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/b9300a/" class="nav-link">集合 sets</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cb3d21/" class="nav-link">序列 sequence</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fc6196/" class="nav-link">终止 Terminal</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a2a107/" class="nav-link">值类型 Values Types</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><a href="/dafnycommunity/ziyuan/" class="link-title">资源</a> <span class="title" style="display:none;">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>实践探索</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/718207/" class="nav-link">自动归纳</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1f579f/" class="nav-link">自动调用引理</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/f6638c/" class="nav-link">定义、证明、算法正确性</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1d2420/" class="nav-link">各种推导式</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/20c275/" class="nav-link">不同类型的证明</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/67167e/" class="nav-link">集合元素上的函数</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/be298d/" class="nav-link">在集合上的迭代</a></li></ul></li><li class="dropdown-item"><h4>常用工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/8065fd/" class="nav-link">Type System</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0f17ab/" class="nav-link">Style Guide</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fe5721/" class="nav-link">Cheet Sheet</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/1b94a4/" class="nav-link">✨收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🏷️语言" class="dropdown-title"><!----> <span class="title" style="display:;">🏷️语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dafnycommunity/" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/dafnycommunity/en-US/" class="nav-link">English</a></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/caf1f9/" class="nav-link">💬社区留言板</a></div> <a href="https://github.com/aaron-clou/dafnycommunity" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://s1.ax1x.com/2022/04/01/qh3tDe.png"> <div class="blogger-info"><h3>Dafny</h3> <span>新一代验证语言</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/dafnycommunity/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="配置" class="dropdown-title"><a href="/dafnycommunity/peizhi/" class="link-title">配置</a> <span class="title" style="display:none;">配置</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>入门介绍</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/56e571/" class="nav-link">什么是dafny?</a></li></ul></li><li class="dropdown-item"><h4>用起来吧！</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/4fa796/" class="nav-link">安装</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/085606/" class="nav-link">快速上手</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/39fb20/" class="nav-link">可能遇到的问题?</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="指南" class="dropdown-title"><a href="/dafnycommunity/zhinan/" class="link-title">指南</a> <span class="title" style="display:none;">指南</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafny快速入门</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/6e15a6/" class="nav-link">基础学习 Basic</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/eba166/" class="nav-link">方法 Method</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/83cdf9/" class="nav-link">关键字 Keyword</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/01d76e/" class="nav-link">函数 Function</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0fadc1/" class="nav-link">类 Class </a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a010ab/" class="nav-link">泛型 Generics</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/c4fda3/" class="nav-link">声明 Statement</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e8438e/" class="nav-link">表达式 Expression</a></li></ul></li><li class="dropdown-item"><h4>Dafny简单例子</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0978ce/" class="nav-link">寻找最大最小数和</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e3e481/" class="nav-link">斐波那契数列</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/02fdef/" class="nav-link">线性查询</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9b332b/" class="nav-link">引理-计算序列非负元素个数</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/3d1110/" class="nav-link">集合</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2146d4/" class="nav-link">终止</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="教程" class="dropdown-title"><a href="/dafnycommunity/jiaocheng/" class="link-title">教程</a> <span class="title" style="display:none;">教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafny指导</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/877eb3/" class="nav-link">介绍</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/bf40c0/" class="nav-link">方法 Methods</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2e0c73/" class="nav-link">前置/后置条件 Pre/Postconditions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/36c1b4/" class="nav-link">断言 Assertions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a1d5a4/" class="nav-link">函数 Functions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/d89435/" class="nav-link">循环不变体 Loop Invariants</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/828a83/" class="nav-link">数组 Arrays</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/17e8d1/" class="nav-link">量词(函数) Quantifiers</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cc01af/" class="nav-link">谓词(函数) Predicates</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/13bbcd/" class="nav-link">框架 Framing</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1319be/" class="nav-link">二分搜索 Binary Search</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/30a8c2/" class="nav-link">总结</a></li></ul></li><li class="dropdown-item"><h4>Dafny进阶语法</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/273cac/" class="nav-link">引理和归纳 Lemmas and Induction</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9d19b8/" class="nav-link">模块 Modules</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/b9300a/" class="nav-link">集合 sets</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cb3d21/" class="nav-link">序列 sequence</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fc6196/" class="nav-link">终止 Terminal</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a2a107/" class="nav-link">值类型 Values Types</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="资源" class="dropdown-title"><a href="/dafnycommunity/ziyuan/" class="link-title">资源</a> <span class="title" style="display:none;">资源</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>实践探索</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/718207/" class="nav-link">自动归纳</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1f579f/" class="nav-link">自动调用引理</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/f6638c/" class="nav-link">定义、证明、算法正确性</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1d2420/" class="nav-link">各种推导式</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/20c275/" class="nav-link">不同类型的证明</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/67167e/" class="nav-link">集合元素上的函数</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/be298d/" class="nav-link">在集合上的迭代</a></li></ul></li><li class="dropdown-item"><h4>常用工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/8065fd/" class="nav-link">Type System</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0f17ab/" class="nav-link">Style Guide</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fe5721/" class="nav-link">Cheet Sheet</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/1b94a4/" class="nav-link">✨收藏</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="🏷️语言" class="dropdown-title"><!----> <span class="title" style="display:;">🏷️语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dafnycommunity/" class="nav-link">简体中文</a></li><li class="dropdown-item"><!----> <a href="/dafnycommunity/en-US/" class="nav-link">English</a></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/caf1f9/" class="nav-link">💬社区留言板</a></div> <a href="https://github.com/aaron-clou/dafnycommunity" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>dafny-quick-start</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>dafny-tutorials</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>detailed-document</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>publication-lecture</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dafnycommunity/pages/a9363c/" class="sidebar-link">Automatic Induction</a></li><li><a href="/dafnycommunity/pages/30441e/" class="sidebar-link">Calling Lemmas Automatically</a></li><li><a href="/dafnycommunity/pages/746026/" class="sidebar-link">Case study of definitions, proofs, algorithm correctness GCD</a></li><li><a href="/dafnycommunity/pages/da6921/" class="sidebar-link">Comprehensions</a></li><li><a href="/dafnycommunity/pages/8d8607/" class="sidebar-link">Different Styles of Proofs</a></li><li><a href="/dafnycommunity/pages/097ba0/" class="sidebar-link">Functions over Set Elements</a></li><li><a href="/dafnycommunity/pages/c4484e/" class="sidebar-link">Iterating over a Collection</a></li><li><a href="/dafnycommunity/pages/7fe522/" class="sidebar-link">old and unchanged</a></li><li><a href="/dafnycommunity/pages/369e25/" class="sidebar-link">Short-Circuit Operators</a></li><li><a href="/dafnycommunity/pages/f8c1c5/" class="sidebar-link">Statement versus Expression Syntax</a></li><li><a href="/dafnycommunity/pages/5a4346/" class="sidebar-link">The Parent Trick for proving termination and a function-by-method use case</a></li><li><a href="/dafnycommunity/pages/c45b5a/" class="sidebar-link">Type-Parameter Completion</a></li><li><a href="/dafnycommunity/pages/3c9a0b/" aria-current="page" class="active sidebar-link">Type-parameter modes variance and cardinality preservation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_0-subtypes" class="sidebar-link">0. Subtypes</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_1-type-parameters" class="sidebar-link">1. Type parameters</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_2-variance" class="sidebar-link">2. Variance</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_2-0-co-variance" class="sidebar-link">2.0. Co-variance</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_2-1-contra-variance" class="sidebar-link">2.1. Contra-variance</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_2-2-non-variance" class="sidebar-link">2.2. Non-variance</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_3-declaring-variance" class="sidebar-link">3. Declaring variance</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_4-positive-and-negative-positions" class="sidebar-link">4. Positive and negative positions</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_5-five-type-parameter-modes" class="sidebar-link">5. Five type-parameter modes</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_6-injectivity" class="sidebar-link">6. Injectivity</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_7-a-logical-contradiction" class="sidebar-link">7. A logical contradiction</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_8-cardinality-requirement" class="sidebar-link">8. Cardinality requirement</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_9-type-parameters-and-cardinality" class="sidebar-link">9. Type parameters and cardinality</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_10-combining-variance-and-cardinality-preservation" class="sidebar-link">10. Combining variance and cardinality preservation</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_11-built-in-type-constructors" class="sidebar-link">11. Built-in type constructors</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_11-0-iset-and" class="sidebar-link">11.0. iset and -&gt;</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_11-1-two-subtle-consequences" class="sidebar-link">11.1. Two subtle consequences</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_11-2-set-and-iset" class="sidebar-link">11.2. set and iset</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/3c9a0b/#_11-3-map-and-imap" class="sidebar-link">11.3. map and imap</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_12-other-sources" class="sidebar-link">12. Other sources</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#_13-summary" class="sidebar-link">13. Summary</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/dafnycommunity/pages/3c9a0b/#acknowledgments" class="sidebar-link">Acknowledgments</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#references" class="sidebar-link">References</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/3c9a0b/#a-finite-powerset-preserves-cardinality" class="sidebar-link">A. Finite powerset preserves cardinality</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/dafnycommunity/" title="首页" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/dafnycommunity/en-US/#语言" data-v-0c557b5e>语言</a></li><li data-v-0c557b5e><a href="/dafnycommunity/en-US/#publication-lecture" data-v-0c557b5e>publication-lecture</a></li></ul> <div class="info" data-v-0c557b5e><div title="作者" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/Aaron-clou" target="_blank" title="作者" class="beLink" data-v-0c557b5e>lijiahai</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-03-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Type-parameter modes variance and cardinality preservation<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p>Dafny Power User:
Type-parameter modes: variance and cardinality preservation</p> <p>K. Rustan M. Leino</p> <p>Manuscript KRML 280, 9 August 2021</p> <p><strong>Abstract.</strong> Dafny supports 5 type-parameter <em>variance</em> and <em>cardinality-preservation</em> modes. Variance is common in languages with types, and cardinality preservation is a concern that arises in the context of verification. This note explains these modes and motivates the need for cardinality preservation. Along the way, it explains some phrases like “strict positivity”.</p> <p>This note is long, so here's a little reading guide:</p> <ul><li>If you're a beginner and want to learn about type-parameter variance, read the first 4 sections.</li> <li>If you're using type-parameter modes and are wondering about the syntax of each mode, see the table in Section <a href="http://leino.science/papers/krml280.html#sec-combining-variance-and-cardinality-preservation" target="_blank" rel="noopener noreferrer">10<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>If you want to see which type-parameter modes are used with Dafny's built-in types, see Section <a href="http://leino.science/papers/krml280.html#sec-built-in-type-constructors" target="_blank" rel="noopener noreferrer">11<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>If you wonder what trouble you'd be in without cardinality-preservation rules (or, as some would say it, without “strict positivity”), then Section <a href="http://leino.science/papers/krml280.html#sec-a-logical-contradiction" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> will give you the idea (and the first code snippet in Section <a href="http://leino.science/papers/krml280.html#sec-type-parameters-and-cardinality" target="_blank" rel="noopener noreferrer">9<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> adds type parameters to that example).</li> <li>If you're a language designer, you may find the rest of Section <a href="http://leino.science/papers/krml280.html#sec-built-in-type-constructors" target="_blank" rel="noopener noreferrer">11<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to be food for thought.</li> <li>There's a little proof about finite powersets and cardinalities in Appendix <a href="http://leino.science/papers/krml280.html#sec-finite-powerset-preserves-cardinality" target="_blank" rel="noopener noreferrer">A<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li>Finally, I have come to think that “strict positivity” is not a good term to use. I think “cardinality preservation” is more to the point, see Section <a href="http://leino.science/papers/krml280.html#sec-other-sources" target="_blank" rel="noopener noreferrer">12<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li></ul> <h2 id="_0-subtypes"><a href="#_0-subtypes" class="header-anchor">#</a> 0. Subtypes</h2> <p>Dafny defines a <em>subtype</em> relation on types. If <code>A</code> is a subtype of <code>B</code>, then every value of <code>A</code> is also a value of type <code>B</code>. For example, the subset type <code>nat</code> is a subtype of <code>int</code>. As another example, given</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>trait Tr {
  // ...
}
class Cl extends Tr {
  // ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>type <code>Cl</code> is a subtype of <code>Tr</code>.</p> <p>Note. The definition of subtype above mentions “If”. This is not an “If and only if”, because it doesn't go the other way around. For example, the type</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type Unreal = r: real | r == r + 1.0
  witness *
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>defines a type <code>Unreal</code> that has no values. Thus, every value of <code>Unreal</code> is also a value of <code>int</code>. Still, Dafny does <em>not</em> consider <code>Unreal</code> to be a subtype of <code>int</code>.</p> <p>The subtype relation is reflexive—that is, every type is (trivially) a subtype of itself—and transitive. Other than that, there are three sources of subtyping in Dafny. One is that a subset type (like the built-in <code>nat</code> and the type <code>Unreal</code> above) is a subtype of its base type (<code>int</code> for <code>nat</code> and <code>real</code> for <code>Unreal</code>). Another is that a class or trait is a subtype of each trait it <code>extends</code>. For example, as we saw above, <code>Cl</code> is a subtype of <code>Tr</code>, and every reference type is a subtype of the built-in trait <code>object</code> (which, e.g., every class implicitly extends). The third source of subtyping stems from variance of type parameters, as I will explain in the next few sections.</p> <h2 id="_1-type-parameters"><a href="#_1-type-parameters" class="header-anchor">#</a> 1. Type parameters</h2> <p>A type can be <em>parameterized</em> by other types. For example,</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>class Cell&lt;Data&gt; {
  var data: Data
  // ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>introduces a class <code>Cell</code> parameterized by a type <code>Data</code>, and</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype PS&lt;X, Y&gt; = PSCtor(x: X, ys: seq&lt;Y&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>introduces a datatype <code>PS</code> parameterized by two types, where the values are essentially pairs consisting of one value (<code>x</code>) of the first type and a sequence (<code>ys</code>) of values of the other type.</p> <p>Since <code>Cell</code> and <code>PS</code> have (1 and 2, respectively) type parameters, they sometimes known as (unary and binary) <em>type constructors</em>. This just means they are not types by themselves, but they need their parameters to be filled in to be types. For example, <code>PS&lt;int, real&gt;</code> and <code>PS&lt;bool, bool&gt;</code> are types, whereas <code>PS&lt;int&gt;</code> and <code>PS</code> are not.</p> <p>Aside. In some cases, Dafny will fill in or infer the type arguments automatically. In those cases, you may be able to write just <code>PS</code> in your program. For example,</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>var p: PS := PSCtor(5, [3.14, 2.7]);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is a legal statement. This is just a syntactic shorthand, and the type arguments of <code>PS</code> are still there, even if the program text omits them.</p> <h2 id="_2-variance"><a href="#_2-variance" class="header-anchor">#</a> 2. Variance</h2> <p>Whether or not a parameterized type is a subtype of another may depend on the parameters. For example, it turns out that <code>seq&lt;nat&gt;</code> is a subtype of <code>seq&lt;int&gt;</code>, but <code>seq&lt;bool&gt;</code> is not a subtype of <code>seq&lt;real&gt;</code>. The reason behind this is that <code>seq</code> is <em>co-variant</em> in its argument.</p> <h3 id="_2-0-co-variance"><a href="#_2-0-co-variance" class="header-anchor">#</a> 2.0. Co-variance</h3> <p>When a (here, unary) type constructor <code>M</code> is co-variant in its argument, then</p> <blockquote><p>for any types <code>A</code> and <code>B</code> such that <code>A</code> is a subtype of <code>B</code>, <code>M&lt;A&gt;</code> is a subtype of <code>M&lt;B&gt;</code>.</p></blockquote> <p>Let me write the subtype relation as <code>&lt;:</code>. Then, what I just said about <code>M</code> can be written as</p> <blockquote><p><code>A, B :: A &lt;: B ==&gt; M&lt;A&gt; &lt;: M&lt;B&gt;</code></p></blockquote> <p>This is really just saying that <code>M</code> is <em>monotonic</em> (with respect to the subtyping ordering) in its argument. For example, in math, a function <code>f</code> over the reals is monotonic (with respect to the less-or-equal ordering) when</p> <blockquote><p><code>x, y :: x</code> <code>y ==&gt; f(x)</code> <code>f(y)</code></p></blockquote> <p>A type constructor with many arguments may be co-variant in some of its type arguments and not others. For example, if <code>Trois</code> is a type constructor with three arguments and is co-variant in the first and third argument, then</p> <blockquote><p><code>A, B, H, X, Y ::</code> <code>A &lt;: B &amp;&amp; X &lt;: Y ==&gt; Trois&lt;A, H, X&gt; &lt;: Trois&lt;B, H, Y&gt;</code></p></blockquote> <h3 id="_2-1-contra-variance"><a href="#_2-1-contra-variance" class="header-anchor">#</a> 2.1. Contra-variance</h3> <p>Some type constructors are <em>contra-variant</em> in some of their type arguments. This means that the subtype of the argument has an opposite effect on the subtyping of the constructed type. More precisely, when a (here, unary) type constructor <code>M</code> is contra-variant in its argument, then</p> <blockquote><p><code>A, B :: A &lt;: B ==&gt; M&lt;B&gt; &lt;: M&lt;A&gt;</code></p></blockquote> <p>This corresponds to the math notion of a function being <em>anti-monotonic</em>.</p> <p>For illustration, consider the declarations</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Color = Blue | Green
type Coloring&lt;X&gt; = X -&gt; Color
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>which, for any type <code>X</code>, defines <code>Coloring&lt;X&gt;</code> to be the type whose values are functions that give each <code>X</code> value a <code>Color</code>. As it turns out, type constructor <code>Coloring</code> is contra-variant in its argument. Consequently, every value of <code>Coloring&lt;int&gt;</code> is a value of <code>Coloring&lt;nat&gt;</code>. This makes sense—each value of <code>Coloring&lt;int&gt;</code> is a function that gives every integer a color, and each value of <code>Coloring&lt;nat&gt;</code> is a function that gives every non-negative integer a color, and every function that gives <em>all</em> integers a color also gives the non-negative integers a color.</p> <h3 id="_2-2-non-variance"><a href="#_2-2-non-variance" class="header-anchor">#</a> 2.2. Non-variance</h3> <p>For some type constructors, if you provide different type arguments, the resulting types have no relation to each other. For example, using class <code>Cell</code> from above, there is no subtype relation between <code>Cell&lt;nat&gt;</code> and <code>Cell&lt;int&gt;</code>. In this case, we say that the type constructor is <em>non-variant</em> in its argument.</p> <p>Note. Perversely, non-variance is sometimes called <em>invariance</em>. That's a terrible mistake. “Invariant” refers to something that <em>does not change</em>, which is very much the opposite of the effect of non-variant type parameters. When you change the argument given to a non-variant type parameter, the resulting type can be something completely different—<em>not</em> the same thing. So, please… don't refer to non-variant as “invariant”!</p> <h2 id="_3-declaring-variance"><a href="#_3-declaring-variance" class="header-anchor">#</a> 3. Declaring variance</h2> <p>Dafny defines the type-parameter variance of the built-in type constructors. For example, <code>seq</code> is co-variant in its type argument. (I'll mention the other collection types in Section <a href="http://leino.science/papers/krml280.html#sec-built-in-type-constructors" target="_blank" rel="noopener noreferrer">11<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.) As another example, for any <code>n</code>, the <code>n</code>-ary arrow type constructor is contra-variant in each of its <code>n</code> input types and co-variant in its output type. Reference types (user-defined classes, built-in arrays, etc.) are required to be non-variant in each of their type parameters.</p> <p>For <code>datatype</code> and <code>codatatype</code> declarations, subset types, opaque types, and type synonyms, there's some freedom in choosing the variance for each type parameter. To declare a type constructor to be co-variant in a type parameter, mark the type parameter with a prefix <code>+</code>. For contra-variance, mark the type parameter with a prefix <code>-</code>. The absence of any such mark declares the type constructor to be non-variant in that type parameter.</p> <p>For example, the declaration</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type Example&lt;+A, -B, C, +D&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>introduces an opaque-type type constructor <code>Example</code> with four type arguments. The type constructor is co-variant in its first and fourth arguments, contra-variant in its second argument, and non-variant in its third argument.</p> <p>As another example, the built-in tuple type constructors (which are datatypes) are co-variant in each of their arguments.</p> <p>Note. In Section <a href="http://leino.science/papers/krml280.html#sec-contra-variance" target="_blank" rel="noopener noreferrer">2.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, I said that <code>Coloring&lt;X&gt;</code> is contra-variant. That's not quite true. The <em>right-hand side</em> of the definition of <code>Coloring&lt;X&gt;</code> is contra-variant in <code>X</code>. If you want <code>Coloring</code> to have this property, you must explicitly mark the parameter as such. That is, <code>Coloring&lt;X&gt;</code> declared in <a href="http://leino.science/papers/krml280.html#sec-contra-variance" target="_blank" rel="noopener noreferrer">2.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is non-variant in <code>X</code>, whereas declaring it as</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type Coloring&lt;-X&gt; = X -&gt; Color
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>makes it contra-variant.</p> <p>There are no restrictions on the type-parameter variance of opaque types. But for the other type declarations, the right-hand side definition of the type must be consistent with each type-parameter variance given on the left-hand side.</p> <p>For example, consider the following attempt at defining a datatype:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Record&lt;-X&gt; = Record(x: X)  // error: X is not used contra-variantly
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This declaration introduces <code>X</code> as a contra-variant type parameter of <code>Record</code>, but the right-hand side definition of <code>Record</code> does not use <code>X</code> according to that variance. If <code>X</code> is instead introduced as a co-variant or non-variant type parameter, the definition is legal.</p> <p>Note. Even if the right-hand side is consistent with declaring a type parameter as co-variant or as contra-variant, the declaration of a type constructor does not need to advertise that to its users. In other words, it's fine to declare</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Record&lt;X&gt; = Record(x: X)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>even though</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Record&lt;+X&gt; = Record(x: X)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is also legal and would allow more uses of <code>Record</code>. As another example, the Section <a href="http://leino.science/papers/krml280.html#sec-contra-variance" target="_blank" rel="noopener noreferrer">2.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> declaration of <code>Coloring</code> makes it non-variant, whereas its right-hand side would be consistent with making <code>Coloring</code> contra-variant. This is the same kind of choice of abstraction that is available throughout a programming language. For example, a function can have an <code>int</code> result type even it returns only non-negative integers. This establishes a contract between the implementation of a function and its callers. In particular, it says that the caller must be prepared to receive any integer result, and it gives the implementation the freedom to in the future return negative integers without breaking any callers.</p> <h2 id="_4-positive-and-negative-positions"><a href="#_4-positive-and-negative-positions" class="header-anchor">#</a> 4. Positive and negative positions</h2> <p>When looking at the right-hand side of a type declaration to see if the type parameters are used in accordance with their variance, it is useful to think of <em>positive and negative positions</em>. The basic idea is that an occurrence of a type <code>X</code> in a type expression <code>T</code> is in a positive position if the occurrence is to the left of an <em>even</em> number of arrows in <code>T</code>, and it is in a negative position if it occurs to the left of an <em>odd</em> number of arrows.</p> <p>To illustrate, consider the following type expression:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>(A, (B -&gt; bool) -&gt; C, seq&lt;D -&gt; (E -&gt; F)&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>In this type expression, <code>A</code>, <code>B</code>, <code>C</code>, and <code>F</code> are in positive positions and <code>D</code> and <code>E</code> are in negative positions.</p> <p>To explain the origin of the names “positive” and “negative”, let me write <code>T(X)</code> to denote a type expression where I have singled out a particular occurrence of <code>X</code>. If the <code>X</code> in <code>T(X)</code> occurs in a positive position, then any subtype/supertype change in <code>X</code> will cause a change in the same direction in <code>T(X)</code>. That is, it is as if <code>T(X)</code> “multiplies” <code>X</code> by a positive number. Conversely, if <code>X</code> is in a negative position, then any subtype/supertype change in <code>X</code> will cause a change in the opposite direction in <code>T(X)</code>. That is, it is as if <code>T(X)</code> “multiplies” <code>X</code> by a negative number.</p> <p>In more symbols, if <code>X</code> occurs in a positive position in <code>T(X)</code>, then</p> <blockquote><p><code>X, Y :: X &lt;: Y ==&gt; T(X) &lt;: T(Y)</code></p></blockquote> <p>and if <code>X</code> occurs in a negative position in <code>T(X)</code>, then</p> <blockquote><p><code>X, Y :: X &lt;: Y ==&gt; T(Y) &lt;: T(X)</code></p></blockquote> <p>It's no accident that these formulas look like the ones that define co-variance and contra-variance in Section <a href="http://leino.science/papers/krml280.html#sec-variance" target="_blank" rel="noopener noreferrer">2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, because those concepts are tightly related to the concepts of positive and negative positions.</p> <p>Consider a type-constructor declaration with a type parameter <code>X</code> and a right-hand side <code>RHS</code>. If <code>X</code> is marked as co-variant, then it is used correctly if all its occurrences in <code>RHS</code> are in positive positions. If <code>X</code> is marked as contra-variant, then it is used correctly if all its occurrences in <code>RHS</code> are in negative positions.</p> <p>Let me tidy up a detail. In my above definitions of positive and negative positions, I only mentioned arrow type constructors. If for a moment we ignore syntax and write an arrow type like <code>A -&gt; B</code> as <code>Arrow&lt;A, B&gt;</code>, then we can view the (built-in) definition of <code>Arrow</code> as</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type Arrow&lt;-X, +Y&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Now, the definition of positive/negative positions goes as follows. For any type <code>T</code>,</p> <ul><li><p>If <code>T</code> has the form <code>X</code> where <code>X</code> is a type parameter, then this occurrence of <code>X</code> is in a positive position.</p></li> <li></li></ul> <p>If</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>T
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>has the form</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>TC&lt;..., U, ...&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>where type expression</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>U
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is passed in as the type parameter</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>A
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>in type constructor</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>TC
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>, then</p> <ul><li>if <code>A</code> is declared as co-variant, then all the positive positions in <code>U</code> are positive positions in <code>T</code> and all negative positions in <code>U</code> are negative positions in <code>T</code></li> <li>if <code>A</code> is declared as contra-variant, then all the positive positions in <code>U</code> are negative positions in <code>T</code> and all negative positions in <code>U</code> are positive positions in <code>T</code></li> <li>if <code>A</code> is declared as non-variant, then <code>U</code> contributes neither positive nor negative positions to <code>T</code></li></ul> <p>For example, in the type</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>seq&lt;(A, Cell&lt;B -&gt; bool&gt;, C -&gt; D)&gt; -&gt; Example&lt;int, E, F, G&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>where <code>Cell</code> and <code>Example</code> are as defined above (and, recall, the built-in <code>seq</code> and the built-in tuple types are co-variant in their arguments, and the type constructor <code>-&gt;</code> is like <code>Arrow</code> above), the type variables in positive positions are <code>C</code> and <code>G</code>, and the type variables in negative positions are <code>A</code>, <code>D</code>, and <code>E</code>.</p> <h2 id="_5-five-type-parameter-modes"><a href="#_5-five-type-parameter-modes" class="header-anchor">#</a> 5. Five type-parameter modes</h2> <p>In most programming languages that support type-parameter variance, you will encounter only the 3 modes of variance I've discussed so far. If that's all you want to know, you can stop reading now. (Dafny's defaults are such that you rarely need to know about more than these 3 modes.)</p> <p>Dafny, it turns out, has 5 type-parameter modes. The additional modes come about because Dafny is concerned with formal verification. To motivate and explain the additional modes, I will review a property about datatypes, show a subtle way that mere type declarations can cause a logical contradiction, introduce the concept of cardinality preservation, and then come back to Dafny.</p> <h2 id="_6-injectivity"><a href="#_6-injectivity" class="header-anchor">#</a> 6. Injectivity</h2> <p>The constructors of a <code>datatype</code> or <code>codatatype</code> are <em>injective</em> in their arguments. This means that there is only one way to construct a particular datatype value.</p> <p>In more detail, let's review four properties of datatypes. For illustration, let's consider a standard <code>List</code> definition (of integers—just to keep things simple).</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype List = Nil | Cons(head: int, tail: List)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>First, this definition says that there are two variants of lists: those that are constructed using <code>Nil</code> and those that are constructed using <code>Cons</code>. So, for any value <code>xs</code> of type <code>List</code>, the disjunction</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>xs.Nil? || xs.Cons?
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>always holds. Second, the two variants give rise to different values. So,</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>!(xs.Nil? &amp;&amp; xs.Cons?)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>always holds. Third, each constructor is a <em>function</em>, in the sense that its arguments (and nothing else!) determine the value they produce. So,</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>x == y &amp;&amp; xs == ys  ==&gt;  Cons(x, xs) == Cons(y, ys)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>always holds. Fourth, two values of the same variant are equal only if the corresponding arguments are equal. So,</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>Cons(x, xs) == Cons(y, ys)  ==&gt;  x == y &amp;&amp; xs == ys
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>It's this fourth property that is called injectivity. More precisely, a datatype constructor is injective in each argument. (An alternate name for “injective” is “one-to-one”.) When a function is injective (in an argument), there exists an <em>inverse</em> function (for that argument). For a datatype, those inverse functions are called <em>destructors</em>, and they can be given names by introducing names for the parameters of the constructors. In the <code>List</code> declaration above, the inverse functions for <code>Cons</code> were introduced as <code>.head</code> and <code>.tail</code>. So, we have</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>Cons(x, xs).head == x  &amp;&amp;  Cons(x, xs).tail == xs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_7-a-logical-contradiction"><a href="#_7-a-logical-contradiction" class="header-anchor">#</a> 7. A logical contradiction</h2> <p>Consider the following type declarations:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type F = D -&gt; bool
datatype D = Ctor(f: F)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>I'm now going to argue that there is an infinite number of values of type <code>D</code>. Regardless of how many <code>D</code> values there are, we can define a function <code>f``0</code> of type <code>F</code> that always returns <code>false</code>. If we pass in <code>f``0</code> to <code>Ctor</code>, we get a <code>D</code> value, call it <code>d``0</code>. (We just proved that the set of <code>D</code> values is nonempty!) From our definition of <code>f``0</code>, we have that <code>f``0``(d``0``) == false</code>. Next, let's define a function <code>f``1</code> that is like <code>f``0</code>, except that it returns <code>true</code> for <code>d``0</code>. Define <code>d``1</code> to be the value <code>Ctor(f``1``)</code>. Because <code>f``0</code> is different from <code>f``1</code>, the injectivity of <code>Ctor</code> tells us that <code>d``0</code> is different from <code>d``1</code>. (We have now shown that there are at least 2 <code>D</code> values!) Next, define a function <code>f``2</code> that is like <code>f``1</code>, except that it returns <code>true</code> for <code>d``1</code>. By passing <code>f``2</code> to <code>Ctor</code>, we get yet another <code>D</code> value. We can continue this process forever, which shows that there is no finite bound on the number of <code>D</code> values. Hence, the set of <code>D</code> values is infinite.</p> <p>How many <code>F</code> values are there? If <code>D</code> were finite, you would immediately answer <code>2``|D|</code>, where <code>|D|</code> is the size of <code>D</code>—also known as the <em>cardinality</em> of <code>D</code>—because for each <code>D</code> value, <code>F</code> may return one of <code>2</code> values. This is called the <em>powerset</em> of <code>D</code>. But as we just concluded above, <code>D</code> is infinite. Well, it turns out that the answer is still the same: the cardinality of <code>F</code> is <code>2``|D|</code>, where we're using <em>cardinal</em> numbers instead of natural numbers. This sounds mathematical, but all you need to know is that the inequality <code>n &lt; 2``n</code> holds for cardinal numbers just like it holds for natural numbers (see, e.g., Theorem 22.10 of [<a href="http://leino.science/papers/krml280.html#monk:settheory" target="_blank" rel="noopener noreferrer">3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>]). In other words, the number of <code>F</code> values is strictly larger than the number of <code>D</code> values.</p> <p>This is trouble.</p> <p>For every <code>F</code> value, we can construct a <code>D</code> value, and thus <code>|F| &lt;= |D|</code>. But we concluded above that <code>|D| &lt; 2``|D|</code> and <code>2``|D|`` == |F|</code>. Putting these facts together by transitivity, we get <code>|F| &lt; |F|</code>, which is just <code>false</code>.</p> <p>Using a construction akin to Cantor's diagonalization argument [<a href="http://leino.science/papers/krml280.html#simmons:diagonal" target="_blank" rel="noopener noreferrer">6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>] or Russell's paradox [<a href="http://leino.science/papers/krml280.html#russell:paradox" target="_blank" rel="noopener noreferrer">5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>], we can exploit this contradiction in cardinalities and prove <code>false</code>:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>lemma False()
  ensures false
{
  var g := (d: D) =&gt; !d.f(d);
  var dd := Ctor(g);
  calc {
    g(dd);
  ==  // def. g
    !dd.f(dd);
  ==  { assert dd.f == g; }
    !g(dd);
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>Well, it's more accurate to say that this <em>could</em> be trouble, because it would let us prove <code>false</code>. Luckily, the type definitions for <code>F</code> and <code>D</code> are not accepted by Dafny. That is, to avoid this logical contradiction, Dafny does not allow a datatype (here, <code>D</code>) to be defined in terms of right-hand sides that would have larger cardinalities than <code>D</code> itself.</p> <h2 id="_8-cardinality-requirement"><a href="#_8-cardinality-requirement" class="header-anchor">#</a> 8. Cardinality requirement</h2> <p>To avoid the contradiction in cardinalities when defining a type <code>D</code> as some type expression <code>T(D)</code>, we must make sure the cardinalities of <code>D</code> and <code>T(D)</code> can be the same. That is, we need to be able to make <code>D</code> large enough that its cardinality equals that of <code>T(D)</code>. The previous section showed an example where this is not possible, because no matter how big you make <code>D</code>, <code>T(D)</code> will be exponentially larger. I'll refer to this condition as the <em>cardinality requirement</em>.</p> <p>A contradiction in cardinalities can occur only if a type is defined in terms of itself. That is, suppose a type <code>D</code> is defined to be <code>RHS</code>. If <code>RHS</code> does not depend on <code>D</code>, then <code>D</code> will, without risk of any contradiction, have the same cardinality as <code>RHS</code>. A problem can occur only if <code>RHS</code> depends on <code>D</code>. For all cases of non-trivial dependencies, one can use an argument like in Section <a href="http://leino.science/papers/krml280.html#sec-a-logical-contradiction" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to show that <code>D</code> has an infinite number of elements. Therefore, when designing a restriction to enforce the cardinality requirement, we only need to think about types of infinite cardinality.</p> <p>In type theory, we can think of a fixed repertoire of type compositions. Types are either type names or sum-type, product-type, or arrow-type compositions. Type names include built-in types like <code>bool</code> and <code>int</code>, and also include user-defined types, like <code>D</code> from above. Sum types correspond to the variants of a datatype. Product types correspond to the list of arguments in each such variant. Finally, arrow types are the types of functions.</p> <p>Using standard type-theory notation for these types and for the cardinality of the type named , the cardinality of types, denoted , is defined as follows:</p> <p>From this definition, we see that the cardinality is a polynomial of the cardinalities of the type names involved, except in the case of arrow types. For any polynomial and infinite cardinal number , equals . So, the only way to violate the cardinality requirement is if <code>D</code> occurs in the left-hand argument of an arrow type.</p> <p>Note. Just because <code>D</code> occurs in the left-hand argument to an arrow does not mean there is a problem with cardinalities. In particular, arrow types are harmless if the right-hand type has cardinality 0 or 1, and so are product types where an argument has cardinality 0. For example, <code>Empty</code> is an empty type (that is, a type with cardinality 0) and <code>Singleton</code> is a unit type (that is, a type with cardinality 1), then there is no cardinality concern with the type</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype D = Done | More(D -&gt; Empty, D -&gt; Singleton, (D, Empty) -&gt; int)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Nevertheless, Dafny's rules forbid this type, too, because the rules do not look for the special cases with cardinality-0 or cardinality-1 types. That's alright. By forbidding these trivial types, the rules both eliminate actual cardinality problems and stay simple.</p> <p>The crucial point is this: Except for cardinality-0 types that are used as arguments to product types or as left-hand arguments to arrow types,</p> <blockquote><p>a type expression <code>T(D)</code> that mentions <code>D</code> is always at least as big as <code>D</code>.</p></blockquote> <p>This leads us to a proposed way to enforce the cardinality requirement:</p> <blockquote><p>For any type <code>D</code> defined to be <code>T(D)</code>, do not allow <code>D</code> to be mentioned in the left-hand argument of any arrow type in <code>T(D)</code>.</p></blockquote> <p>The proposed rule talks about left-hand arguments of arrow types, which reminds us of the positive/negative positions we discussed in Section <a href="http://leino.science/papers/krml280.html#sec-positive-and-negative-positions" target="_blank" rel="noopener noreferrer">4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> as a way to enforce variance restrictions. Some people think of the cardinality requirement as taking a step beyond saying <code>D</code> must be in positive positions. That is, whereas a doubly negative position (like <code>X</code> in <code>(X -&gt; bool) -&gt; bool</code>) is a positive position, the cardinality requirement seems to call for a <em>strictly positive</em> positions, where a doubly negative position is still a negative position. For this reason, you sometimes hear that the cardinality requirement is enforced by <em>strict positivity</em>. (I'll have more to say about this in Section <a href="http://leino.science/papers/krml280.html#sec-other-sources" target="_blank" rel="noopener noreferrer">12<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.)</p> <p>But wait! Weren't we discussing type parameters? What does the cardinality requirement have to do with type parameters?</p> <h2 id="_9-type-parameters-and-cardinality"><a href="#_9-type-parameters-and-cardinality" class="header-anchor">#</a> 9. Type parameters and cardinality</h2> <p>A variation of the example logical contradiction we saw in Section <a href="http://leino.science/papers/krml280.html#sec-a-logical-contradiction" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> can be written using type parameters:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type G&lt;X&gt; = X -&gt; bool
datatype E = Ctor(g: G&lt;E&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Once the type synonym <code>G</code> is expanded, we get the same example, and indeed the same contradiction.</p> <p>In a modular setting, it is not realistic to rely on being able to expand all types before checking for cardinality problems. For example, suppose type <code>G</code> is declared in a different module that exports <code>G</code> as an opaque type. A client module might then see just</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type G&lt;X&gt;
datatype E = Ctor(g: G&lt;E&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>from which it is not evident whether or not there may be problems with cardinality.</p> <p>To solve this problem, Dafny lets every type constructor declare which of its type parameters are used in ways that preserve cardinality. The mark <code>!</code> in the following example illustrates:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>type Example&lt;X, !Y&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This declaration says that <code>Example</code> uses type parameter <code>X</code> in a way that adheres to the cardinality requirement, whereas it does not promise the same for <code>Y</code>. This means that</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Good = None | Some(Example&lt;Good, int&gt;)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is legal, whereas</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>datatype Bad = None | Some(Example&lt;int, Bad&gt;) // error: violates cardinality requirement
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is not, because it may violate the cardinality requirement.</p> <p>We can now state the enforcement of the cardinality requirement precisely. Ignoring syntax, like I did in Section <a href="http://leino.science/papers/krml280.html#sec-positive-and-negative-positions" target="_blank" rel="noopener noreferrer">4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, we can view all types as type constructors that take a list of type parameters, each of which is identified as cardinality preserving or possibly not cardinality preserving. For any type <code>T</code>,</p> <ul><li><p>If <code>T</code> has the form <code>X</code> where <code>X</code> is a type parameter, then this occurrence of <code>X</code> is a cardinality-preserving position iff <code>X</code> is marked as cardinality preserving.</p></li> <li></li></ul> <p>If</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>T
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>has the form</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>TC&lt;..., U, ...&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>where type expression</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>U
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is passed in as the type parameter</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>A
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>in type constructor</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>TC
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>, then</p> <ul><li>if <code>A</code> is declared as cardinality preserving, then all the cardinality-preserving positions in <code>U</code> are cardinality-preserving positions in <code>T</code></li> <li>if <code>A</code> is not declared as cardinality preserving, then <code>U</code> does not contribute any cardinality-preserving positions to <code>T</code></li></ul> <p>The cardinality requirement is now enforced by the following <em>cardinality-preservation rule</em>: for any type <code>D&lt;..., X, ...&gt;</code> defined as <code>RHS</code>,</p> <ul><li>In <code>RHS</code>, <code>D</code> is allowed to be used only in cardinality-preserving positions.</li> <li>If <code>X</code> is marked as cardinality preserving, then, in <code>RHS</code>, <code>X</code> is allowed to be used only in cardinality-preserving positions.</li></ul> <h2 id="_10-combining-variance-and-cardinality-preservation"><a href="#_10-combining-variance-and-cardinality-preservation" class="header-anchor">#</a> 10. Combining variance and cardinality preservation</h2> <p>With 3 kinds of variance, each with cardinality preservation or not, you'd think we'd have 6 modes altogether. But there is no way to be contra-variant <em>and</em> cardinality preserving—in terms of arrow types, contra-variance says the type parameter is to the left of some arrow, and that makes it not preserve cardinality. Therefore, Dafny supports 5 modes. The default mode is non-variant, cardinality preserving. The other four modes can be indicated with the prefix marks <code>+</code>, <code>*</code>, <code>-</code>, and <code>!</code>, as shown by this table:</p> <table><thead><tr><th style="text-align:right;"></th> <th style="text-align:center;">cardinality preserving</th> <th style="text-align:center;"></th></tr></thead> <tbody><tr><td style="text-align:right;">variance</td> <td style="text-align:center;">yes</td> <td style="text-align:center;">not necessarily</td></tr> <tr><td style="text-align:right;"></td> <td style="text-align:center;"></td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:right;">co-variant</td> <td style="text-align:center;"><code>+</code></td> <td style="text-align:center;"><code>*</code></td></tr> <tr><td style="text-align:right;">contra-variant</td> <td style="text-align:center;">N/A</td> <td style="text-align:center;"><code>-</code></td></tr> <tr><td style="text-align:right;">non-variant</td> <td style="text-align:center;">(default)</td> <td style="text-align:center;"><code>!</code></td></tr></tbody></table> <h2 id="_11-built-in-type-constructors"><a href="#_11-built-in-type-constructors" class="header-anchor">#</a> 11. Built-in type constructors</h2> <p>Dafny has several built-in type constructors. Here are their type-parameter modes:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>set&lt;+A&gt;          // finite sets
iset&lt;*A&gt;         // possibly infinite sets
seq&lt;+A&gt;          // sequences
multiset&lt;+A&gt;     // multisets
map&lt;+A, +B&gt;      // finite maps
imap&lt;*A, +B&gt;     // possibly infinite maps
(+A, +B, +C)     // tuple types
-A -&gt; +B         // arrow type for total functions
-A --&gt; +B        // arrow type for partial functions
-A ~&gt; +B         // arrow type for general functions
array&lt;A&gt;         // arrays
array2&lt;A&gt;        // multi-dimensional arrays
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>Most of these are probably what you'd expect. For example, as we have seen above in examples, sequences are co-variant in their type argument, and they are also cardinality preserving. Tuple types (a 3-tuple is shown above) are built-in datatypes and they are co-variant and cardinality-preserving in all their arguments. Array types of any dimension are reference types, which are restricted to be non-variant in their type parameters, and they are also cardinality preserving. Arrow types are co-variant and cardinality preserving in their last type parameter and, as we have discussed, contra-variant and not cardinality preserving in the other type parameters.</p> <p>Some of type modes among the built-in types are more subtle. If you're tired of considering subtleties and are happy to accept the type-parameter modes of the built-in types, you can skip the rest of this section. If you want understand the rationale behind these type-parameter modes, keep reading.</p> <h3 id="_11-0-iset-and"><a href="#_11-0-iset-and" class="header-anchor">#</a> 11.0. <code>iset</code> and <code>-&gt;</code></h3> <p>An <code>iset&lt;X&gt;</code> is a possibly infinite set of <code>X</code>'s. We can think of such a set as a function that for each <code>X</code> returns <code>true</code> or <code>false</code>, depending on whether or not the value is in the set. So, <code>iset&lt;X&gt;</code> is like the type <code>X -&gt; bool</code>, which is not cardinality preserving in <code>X</code>.<a href="http://leino.science/papers/krml280.html#fn-fn-issue1219" target="_blank" rel="noopener noreferrer">0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> But why is <code>iset&lt;X&gt;</code> co-variant in <code>X</code> while <code>X -&gt; bool</code> is contra-variant in <code>X</code>?</p> <p>What I'm about to say applies to any types <code>Y</code> and <code>X</code> where <code>Y</code> is a subtype of <code>X</code>, but I find it helpful to think of specific, familiar types, so I will instead use the types <code>nat</code> and <code>int</code>.</p> <p>Since <code>nat</code> is a subtype of <code>int</code>, co-variance would say that every <code>iset&lt;nat&gt;</code> value is also an <code>iset&lt;int&gt;</code> value. Indeed, a set containing only non-negative integers is also an <code>iset&lt;int&gt;</code>, so it makes sense that <code>iset</code> is co-variant in its type argument.</p> <p>If <code>-&gt;</code> were co-variant, then any <code>nat -&gt; bool</code> function would have to be a <code>int -&gt; bool</code> function, which isn't so. For example, consider the <code>nat -&gt; bool</code> function</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>(n: nat) =&gt; 1000 / (n+1) &lt; 20
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This function evaluates to <code>false</code> for <code>3</code> and evaluates to <code>true</code> for <code>999</code>. If we ignore the &quot;<code>: nat</code>&quot; type of the function's argument and try to think of the function as having type <code>int -&gt; bool</code>, we expect to get a <code>bool</code> value if we apply the function to any integer. But the function's body is undefined for <code>-1</code>, so clearly it's not like an <code>int -&gt; bool</code> function. We conclude that <code>-&gt;</code> is not co-variant in its first argument.</p> <p>Instead, it is contra-variant in its first argument. That is, every <code>int -&gt; bool</code> function is also a <code>nat -&gt; bool</code> function. Being the latter says you get a <code>bool</code> result whenever you apply it to a non-negative integer. Since that's also true for any <code>int -&gt; bool</code> function, it makes sense to say <code>-&gt;</code> is contra-variant in its first argument.</p> <h3 id="_11-1-two-subtle-consequences"><a href="#_11-1-two-subtle-consequences" class="header-anchor">#</a> 11.1. Two subtle consequences</h3> <p>There are two subtle consequences of the decision to make <code>iset</code> co-variant and <code>_ -&gt; bool</code> contra-variant. They have to do with expressing membership/domain. To talk about them, let me first be explicit about the following principle in the Dafny language design:</p> <ul><li><p>The <strong>Static Types Don't Alter Values</strong> principle.</p> <p>A static type says something about the value, but does not alter the value. If <code>Y</code> is a subtype of <code>X</code>, then you're allowed to assign a value of type <code>Y</code> to a variable of type <code>X</code>. In Dafny, such an assignment does not alter the value assigned. For example, given variables</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>x: X    y: Y    originalY: Y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>the following assignments are allowed and result in the assertion being verified:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>originalY := y; // save the value of y
x := y; // assign y to a variable of a different type (a supertype)
y := x; // assign x back to y
assert x == y == originalY;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>The assignment from <code>y</code> to <code>x</code> is allowed, since <code>Y</code> is a subtype of <code>X</code>. The assignment from <code>x</code> to <code>y</code> is allowed by the type system, but generates a proof obligation that the value of <code>x</code> at the time of the assignment is indeed a value of type <code>Y</code>. Since neither assignment alters the value, the final assertion succeeds.</p></li></ul> <p>Now, if <code>s</code> has type <code>iset&lt;int&gt;</code>, then the expression <code>-7 in s</code> evaluates to a boolean that tells us whether or not <code>-7</code> is an element of set <code>s</code>. Suppose <code>t</code> has type <code>iset&lt;nat&gt;</code>. Is the expression <code>-7 in t</code> legal? Yes, because we could assign <code>t</code> to <code>s</code> (which, according to the language-design principle above, does not alter the value) and then ask <code>-7 in s</code>. Since there is a way to ask about <code>-7</code>'s membership in <code>t</code>, it seems fine to allow the expression <code>-7 in t</code> directly, and that's what Dafny does.</p> <p>Note. One could try to imagine a different language design, where an <code>iset&lt;int&gt;</code> value would be allowed to masquerade as an <code>iset&lt;nat&gt;</code> value. In such a language, consider the following program snippet, where variables <code>s</code> and <code>t</code> have types <code>iset&lt;int&gt;</code> and <code>iset&lt;nat&gt;</code>, respectively:</p> <div class="language-dafnyx line-numbers-mode"><pre class="language-text"><code>t := s;
assert s == t;
assert -7 in s &lt;==&gt; -7 in t;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>By the Static Types Don't Alter Values principle, the first assertion should hold. And if <code>s</code> and <code>t</code> are indeed equal, then the next assertion should also hold. But that's nonsense, since every element of an <code>iset&lt;nat&gt;</code> is non-negative. Perhaps the language could outlaw the expression <code>-7 in t</code>, since <code>-7</code> is not a value in the element type (<code>nat</code>) of the static type of <code>t</code>—but this doesn't help, since (as we considered above) we can ask about <code>-7</code>'s membership in <code>t</code> without writing <code>-7 in t</code> directly. The conclusion is that such an imagined language design goes against the Static Types Don't Alter Values principle.</p> <p>Next, if <code>f</code> is an <code>int -&gt; bool</code> function, we can (by contra-variance) assign it to a variable <code>g</code> of type <code>nat -&gt; bool</code>. Since <code>f</code> is defined on every integer, the expression <code>f.requires(-7)</code> is <code>true</code>. So what about <code>g.requires(-7)</code>? It would be strange for it to return <code>true</code>, since <code>-7</code> is not a value of the first type parameter of <code>g</code>'s type. But we also can't let it return <code>false</code>, because then <code>g</code> is not equal to <code>f</code>, which violates the Static Types Don't Alter Values principle. The only way out is to try to outlaw <code>g.requires(-7)</code>.</p> <p>For an expression <code>e</code> of static type <code>A -&gt; B</code>, Dafny defines <code>e.requires</code> to have type <code>A -&gt; bool</code>. So, <code>f.requires</code> has type <code>int -&gt; bool</code>, which means one can pass <code>-7</code> to it. But <code>g.requires</code> has type <code>nat -&gt; bool</code>, so it is not legal to pass it <code>-7</code>.</p> <h3 id="_11-2-set-and-iset"><a href="#_11-2-set-and-iset" class="header-anchor">#</a> 11.2. <code>set</code> and <code>iset</code></h3> <p>Having looked at <code>iset&lt;X&gt;</code> in detail, our first thought might be that <code>set&lt;X&gt;</code> would be the same. After all, we can view both <code>iset&lt;X&gt;</code> and <code>set&lt;X&gt;</code> as having values of the form <code>X -&gt; bool</code>. While co-variance applies to <code>iset</code> and <code>set</code> alike, the cardinality concern we had with <code>X -&gt; bool</code> and <code>iset&lt;X&gt;</code> does not apply to <code>set&lt;X&gt;</code> (explained next). Therefore, <code>set</code>'s type parameter is declared with <code>+</code>.</p> <p>For any type <code>X</code>, the values of <code>iset&lt;X&gt;</code> are in one-to-one correspondence with the powerset of <code>X</code>—that is, all functions from <code>X</code> to <code>bool</code>, or, equivalently, all possible subsets of <code>X</code>—whose cardinality is <code>2``|X|</code>. The values of <code>set&lt;X&gt;</code> correspond to the <em>finite powerset</em> of <code>X</code>—that is, the functions from <code>X</code> to <code>bool</code> that return <code>true</code> only for a finite number of elements, or, equivalently, all <em>finite</em> subsets of <code>X</code>. The cardinality of the finite powerset is far smaller. Specifically, if <code>X</code> has infinite cardinality (which is the case we are interested in, see Section <a href="http://leino.science/papers/krml280.html#sec-cardinality-requirement" target="_blank" rel="noopener noreferrer">8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), then the cardinality of the finite powerset of <code>X</code> equals the cardinality of <code>X</code> itself (see Appendix <a href="http://leino.science/papers/krml280.html#sec-finite-powerset-preserves-cardinality" target="_blank" rel="noopener noreferrer">A<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for a proof).</p> <h3 id="_11-3-map-and-imap"><a href="#_11-3-map-and-imap" class="header-anchor">#</a> 11.3. <code>map</code> and <code>imap</code></h3> <p>The last point to explain about the type-parameter modes of the built-in type constructors regards finite maps (<code>map&lt;X, Y&gt;</code>) and possibly infinite maps (<code>imap&lt;X, Y&gt;</code>).</p> <p>You can view <code>map&lt;X, Y&gt;</code> and <code>imap&lt;X, Y&gt;</code> as (finite and possibly infinite) sets of pairs <code>(x, y)</code>, with <code>x</code> a value of <code>X</code> and <code>y</code> a value of <code>Y</code>. Thus, as you consider subtypes (or supertypes) of either <code>X</code> or <code>Y</code>, the possible pairs shrink (or grow, respectively). This justifies the map types as being co-variant in both arguments.</p> <p>Values of type <code>imap&lt;X, Y&gt;</code> are in one-to-one correspondence with the values of type <code>X -&gt; Y</code>, so our concerns about cardinality preservation apply (hence, <code>imap</code> declares its first argument with the mark <code>*</code>). But the cardinality of <code>map&lt;X, Y&gt;</code>, which allows only a finite number of mappings from <code>X</code> to <code>Y</code>, is far smaller. So, analogously to <code>set&lt;X&gt;</code>, when <code>X</code> is infinite, <code>map&lt;X, Y&gt;</code> has no more elements than both <code>|X|</code> and <code>|Y|</code>.</p> <h2 id="_12-other-sources"><a href="#_12-other-sources" class="header-anchor">#</a> 12. Other sources</h2> <p>It seems that every textbook or course on types would cover the topic of cardinality preservation (or “strict positivity” as it's often called), but I have had difficulty finding such coverage. When I was first learning about this, the most useful reference I found was a seminal paper by Elsa Gunter [<a href="http://leino.science/papers/krml280.html#gunter:1992" target="_blank" rel="noopener noreferrer">1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>]. But even that paper left me puzzled as to what types a verification language <em>can</em> allow without the risk of a logical contradiction.</p> <p>I now think that what had muddled my mind was the phrase “strict positivity”. I don't know who invented or popularized that phrase, but given the syntactic enforcement of cardinality preservation, I understand that it's tempting to think of the restriction as a stricter version of the positive-position restriction for type-parameter variance (Section <a href="http://leino.science/papers/krml280.html#sec-positive-and-negative-positions" target="_blank" rel="noopener noreferrer">4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>). But if you think of the requirement as barring a type name from occurring “to the left of any arrow”, then the motivation is not clear. “Positivity” has well established connotations with monotonicity, whereas “strict positivity” has nothing to do with monotonicity. Once you realize the salient point is how the cardinality of a type parameter affects the cardinality of the type generated by a type constructor, the light in your head comes on. If you—like I did—feel betrayed by the phrase “strict positivity”, you—like I do—will feel compelled to instead use the name <em>cardinality preservation</em>.</p> <p>Many other verification languages incorporate restrictions to avoid logic contradictions. Of these, I want to mention the F* language [<a href="http://leino.science/papers/krml280.html#fstar" target="_blank" rel="noopener noreferrer">4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>], which does not forbid types like those in Section <a href="http://leino.science/papers/krml280.html#sec-a-logical-contradiction" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>; instead, to avoid logical contradictions, F* omits the injectivity property of constructors (see Section <a href="http://leino.science/papers/krml280.html#sec-injectivity" target="_blank" rel="noopener noreferrer">6<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) for such types. In other words, the constructors of a datatype in F* are injective only if the type satisfies the cardinality requirement.</p> <h2 id="_13-summary"><a href="#_13-summary" class="header-anchor">#</a> 13. Summary</h2> <p>Consider a (here, unary) type constructor <code>T</code>. <em>Variance</em> is a set of type-parameter modes that tell you what you can conclude about the subtyping relationship between <code>T(X)</code> and <code>T(Y)</code> by knowing something about the subtyping relationship between <code>X</code> and <code>Y</code>. <em>Cardinality preservation</em> is a set of type-parameter modes that tell you what you can conclude about the relative cardinalities of <code>T(X)</code> and <code>T(Y)</code> by knowing something about the relative cardinalities of <code>X</code> and <code>Y</code>. Dafny supports 5 type-parameter modes that a type constructor can use to express the desired combination of variance and cardinality preservation.</p> <h4 id="acknowledgments"><a href="#acknowledgments" class="header-anchor">#</a> Acknowledgments</h4> <p>I first learned—years ago—about the logical contradiction in Section <a href="http://leino.science/papers/krml280.html#sec-a-logical-contradiction" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> from Jean-Christophe Filliâtre and Christine Paulin-Mohring.</p> <p>Andreas Lochbihler demonstrated to me that the contradiction is detectable in Dafny, even though Dafny has no concepts or types that deal with cardinal numbers directly.</p> <p>Discussions with Nik Swamy caused me to introduce the 5, not 3, type-parameter modes in Dafny, but I realize now that I was then still confused by the phrase “strict positivity”.</p> <p>Recently, I had some illuminating discussions with Andrei Paskevich and Jatin Arora on this topic.</p> <p>Remy Willems asked me questions about the type-parameter mark <code>!</code> in Dafny, which prompted me to write this note to explore the topic in more detail. Little did I know I would spend this many words!</p> <p>I'm grateful to all of these colleagues.</p> <p>Dafny error message movie reference [<a href="http://leino.science/papers/krml280.html#continuumtransfunctioner" target="_blank" rel="noopener noreferrer">0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>].</p> <h2 id="references"><a href="#references" class="header-anchor">#</a> References</h2> <p>[0]“Continuum Transfunctioner”. In Philip Stark, writer, and Danny Leiner, director, <em>Dude, Where's My Car?</em>, Twentieth Century Fox, Alcon Entertainment, 2000. <a href="http://www.bing.com/search?q=+Continuum+Transfunctioner+Philip+Stark+writer+Danny+Leiner+director+_Dude+Where+Twentieth+Century+Alcon+Entertainment++" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[1]Elsa L. Gunter. Why we can't have SML-style datatype declarations in HOL. In Luc J. M. Claesen and Michael J. C. Gordon, editors, <em>Higher Order Logic Theorem Proving and its Applications, Proceedings of the IFIP TC10/WG10.2 Workshop HOL'92.</em>, volume A-20 of <em>IFIP Transactions</em>, pages 561–568. North-Holland/Elsevier, September 1992. Preprint available at <a href="http://egunter.cs.illinois.edu/papers/HOL1992.pdf" target="_blank" rel="noopener noreferrer">http://egunter.cs.illinois.edu/papers/HOL1992.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=+have+style+datatype+declarations++Elsa+Gunter+" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2]Arturo Magidin. The cardinality of the set of all finite subsets of an infinite set. Math StackExchange, March 2011. <a href="https://math.stackexchange.com/questions/27096/the-cardinality-of-the-set-of-all-finite-subsets-of-an-infinite-set/27098#27098" target="_blank" rel="noopener noreferrer">https://math.stackexchange.com/questions/27096/the-cardinality-of-the-set-of-all-finite-subsets-of-an-infinite-set/27098#27098<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=+cardinality+finite+subsets+infinite++Arturo+Magidin+" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[3]J. Donald Monk. <em>Introduction to Set Theory</em>. McGraw-Hill, 1969. Electronic version available from <a href="http://euclid.colorado.edu/~monkd/monk11.pdf" target="_blank" rel="noopener noreferrer">http://euclid.colorado.edu/~monkd/monk11.pdf<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=_Introduction+Theory_+++Donald+Monk+" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[4]Nilhil Swamy, et al. F*: A higher-order effectful language designed for program verification. <a href="https://fstar-lang.org/" target="_blank" rel="noopener noreferrer">https://fstar-lang.org/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=Nilhil+Swamy+higher+order+effectful+language+designed+program+verification+https+fstar+lang++" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[5]Bertrand Russell. <em>The Principles of Mathematics</em>. W. W. Norton &amp; Company, New York, 2d. ed. reprint edition, 1996. First published in 1903. <a href="http://www.bing.com/search?q=_The+Principles+Mathematics_++Bertrand+Russell+" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[6]Keith Simmons. <em>Universality and the Liar: An Essay on Truth and the Diagonal Argument</em>. Cambridge University Press, 1993. ISBN 978-0-521-43069-2, <a href="https://www.google.com/books/edition/Universality_and_the_Liar/wEj3Spept0AC" target="_blank" rel="noopener noreferrer">https://www.google.com/books/edition/Universality_and_the_Liar/wEj3Spept0AC<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=Keith+Simmons+_Universality+Liar+Essay+Truth+Diagonal+Argument_+Cambridge+University+Press+ISBN+https+google+books+edition+Universality_and_the_Liar+wEj3Spept0AC++" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[7]chelivery. Cardinality of the set of all finite subset of . Math StackExchange, December 2016. <a href="https://math.stackexchange.com/questions/2057826/cardinality-of-the-set-of-all-finite-subset-of-mathbbr/2057908#2057908" target="_blank" rel="noopener noreferrer">https://math.stackexchange.com/questions/2057826/cardinality-of-the-set-of-all-finite-subset-of-mathbbr/2057908#2057908<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. <a href="http://www.bing.com/search?q=Cardinality+finite+subset+mathbb+++chelivery+" target="_blank" rel="noopener noreferrer">🔎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="a-finite-powerset-preserves-cardinality"><a href="#a-finite-powerset-preserves-cardinality" class="header-anchor">#</a> A. Finite powerset preserves cardinality</h2> <p>While I haven't found the result in a textbook or journal article, <code>math.stackexchange.com</code> contains at least two proofs that finite powersets preserve cardinality [<a href="http://leino.science/papers/krml280.html#stackexchange:0" target="_blank" rel="noopener noreferrer">2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="http://leino.science/papers/krml280.html#stackexchange:1" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>]. Here's a version of [<a href="http://leino.science/papers/krml280.html#stackexchange:1" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>], but for any infinite set (not just ).</p> <p><strong>Theorem.</strong> Let be an infinite set and be the set of all finite subsets of . Then, .</p> <p><em>Proof.</em> To prove and to have the same cardinality, we need to show a bijection between the two. By the Schröder-Bernstein Theorem, it suffices to show an injective function from to and a (possibly different) surjective function from to . The function from each element in to the singleton set in is injective. So, it remains to show a surjective function from to .</p> <p>For any natural number , let denote the -element subsets of . We then have that</p> <p>Since, for each , is a subset of , there exists a surjective function . We define a function by . Function is surjective, because for any value in , , so by the surjectivity of there is an such that , and thus .</p> <p>Alright, so we have a surjective function, , from to , but we need to show a surjective function from to . We have (see Section <a href="http://leino.science/papers/krml280.html#sec-cardinality-requirement" target="_blank" rel="noopener noreferrer">8<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), and and (since is infinite), so by cardinal arithmetic, . Hence, there is a surjective function, call it , from to . We conclude that is a surjective function from to , which completes our proof.</p> <hr> <p>0.This had been defined incorrectly in Dafny. The <a href="https://github.com/dafny-lang/dafny/issues/1219" target="_blank" rel="noopener noreferrer">issue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> was reported by Travis Hance and <a href="https://github.com/dafny-lang/dafny/pull/1240" target="_blank" rel="noopener noreferrer">fixed<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> by Jatin Arora. <a href="http://leino.science/papers/krml280.html#back-fn-fn-issue1219" target="_blank" rel="noopener noreferrer">↩<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/aaron-clou/dafnycommunity/edit/master/docs/80.语言/30.publication-lecture/65.Type-parameter modes variance and cardinality preservation.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/03/26, 14:38:56</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/dafnycommunity/pages/c45b5a/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Type-Parameter Completion</div></a> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/dafnycommunity/pages/c45b5a/" class="prev">Type-Parameter Completion</a></span> <!----></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/dafnycommunity/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/dafnycommunity/pages/0978ce/"><div>
            寻找最大和最小数
            <!----></div></a> <span class="date">04-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/dafnycommunity/pages/e3e481/"><div>
            斐波那契数列
            <!----></div></a> <span class="date">04-06</span></dt></dl><dl><dd>03</dd> <dt><a href="/dafnycommunity/pages/02fdef/"><div>
            线性查询
            <!----></div></a> <span class="date">04-06</span></dt></dl> <dl><dd></dd> <dt><a href="/dafnycommunity/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/Aaron-clou/dafnycommunity" title="Github" target="_blank" class="iconfont icon-github-fill"></a><a href="https://gitee.com/leo214/dafnycommunity" title="Gitee" target="_blank" class="iconfont icon-gitee2"></a><a href="1374921025@qq.com" title="Email" target="_blank" class="iconfont icon-email-fill"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2022
    <span>Li Jiahai | Dafny Community | 2022</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><!----><div id="tcomment"></div><div></div></div></div>
    <script src="/dafnycommunity/assets/js/app.99d07194.js" defer></script><script src="/dafnycommunity/assets/js/2.ab4658c0.js" defer></script><script src="/dafnycommunity/assets/js/86.e3798708.js" defer></script><script src="/dafnycommunity/assets/js/7.5451cfed.js" defer></script><script src="/dafnycommunity/assets/js/4.06497870.js" defer></script>
  </body>
</html>
