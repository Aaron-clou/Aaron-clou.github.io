<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dafny type system | Dafny</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/dafnycommunity/img/bgico2.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3282046_1qux519eoim.css">
    <script src="https://cdn.jsdelivr.net/npm/twikoo@1.5.0/dist/twikoo.all.min.js"></script>
    <meta name="description" content="Dafnyä¸­æ–‡ç¤¾åŒº">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/dafnycommunity/assets/css/0.styles.ecdcfe28.css" as="style"><link rel="preload" href="/dafnycommunity/assets/js/app.99d07194.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/2.ab4658c0.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/63.83de9482.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/7.5451cfed.js" as="script"><link rel="preload" href="/dafnycommunity/assets/js/4.06497870.js" as="script"><link rel="prefetch" href="/dafnycommunity/assets/js/10.ac38cab7.js"><link rel="prefetch" href="/dafnycommunity/assets/js/11.38d5ee16.js"><link rel="prefetch" href="/dafnycommunity/assets/js/12.c434ce94.js"><link rel="prefetch" href="/dafnycommunity/assets/js/13.4e922264.js"><link rel="prefetch" href="/dafnycommunity/assets/js/14.db841cfa.js"><link rel="prefetch" href="/dafnycommunity/assets/js/15.b9c227cc.js"><link rel="prefetch" href="/dafnycommunity/assets/js/16.41dadc32.js"><link rel="prefetch" href="/dafnycommunity/assets/js/17.48b5f1eb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/18.ec254833.js"><link rel="prefetch" href="/dafnycommunity/assets/js/19.288ca382.js"><link rel="prefetch" href="/dafnycommunity/assets/js/20.cfeb5fdb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/21.ce8ddc5a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/22.1b8c89f0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/23.cb062ace.js"><link rel="prefetch" href="/dafnycommunity/assets/js/24.ff271672.js"><link rel="prefetch" href="/dafnycommunity/assets/js/25.5541f3af.js"><link rel="prefetch" href="/dafnycommunity/assets/js/26.a1bbc4cb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/27.522d7884.js"><link rel="prefetch" href="/dafnycommunity/assets/js/28.9335c003.js"><link rel="prefetch" href="/dafnycommunity/assets/js/29.3fc0b07a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/3.ab8a97d8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/30.57708681.js"><link rel="prefetch" href="/dafnycommunity/assets/js/31.8571b949.js"><link rel="prefetch" href="/dafnycommunity/assets/js/32.f91be5de.js"><link rel="prefetch" href="/dafnycommunity/assets/js/33.8089c59b.js"><link rel="prefetch" href="/dafnycommunity/assets/js/34.874d0299.js"><link rel="prefetch" href="/dafnycommunity/assets/js/35.aff8adfd.js"><link rel="prefetch" href="/dafnycommunity/assets/js/36.ac78b86e.js"><link rel="prefetch" href="/dafnycommunity/assets/js/37.3fae0334.js"><link rel="prefetch" href="/dafnycommunity/assets/js/38.3db4a8d6.js"><link rel="prefetch" href="/dafnycommunity/assets/js/39.e585cc70.js"><link rel="prefetch" href="/dafnycommunity/assets/js/40.afcb8fbe.js"><link rel="prefetch" href="/dafnycommunity/assets/js/41.01f314da.js"><link rel="prefetch" href="/dafnycommunity/assets/js/42.8e4fe21d.js"><link rel="prefetch" href="/dafnycommunity/assets/js/43.571fb232.js"><link rel="prefetch" href="/dafnycommunity/assets/js/44.14aebad2.js"><link rel="prefetch" href="/dafnycommunity/assets/js/45.32f18970.js"><link rel="prefetch" href="/dafnycommunity/assets/js/46.ce0d522f.js"><link rel="prefetch" href="/dafnycommunity/assets/js/47.0bd83351.js"><link rel="prefetch" href="/dafnycommunity/assets/js/48.648f667a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/49.83709ae0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/5.b8548e7f.js"><link rel="prefetch" href="/dafnycommunity/assets/js/50.060e0424.js"><link rel="prefetch" href="/dafnycommunity/assets/js/51.a1291856.js"><link rel="prefetch" href="/dafnycommunity/assets/js/52.45f73497.js"><link rel="prefetch" href="/dafnycommunity/assets/js/53.525782ca.js"><link rel="prefetch" href="/dafnycommunity/assets/js/54.45a04a86.js"><link rel="prefetch" href="/dafnycommunity/assets/js/55.65a94ba0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/56.2d038113.js"><link rel="prefetch" href="/dafnycommunity/assets/js/57.579db650.js"><link rel="prefetch" href="/dafnycommunity/assets/js/58.832d4c89.js"><link rel="prefetch" href="/dafnycommunity/assets/js/59.13befb53.js"><link rel="prefetch" href="/dafnycommunity/assets/js/6.349bf431.js"><link rel="prefetch" href="/dafnycommunity/assets/js/60.41227bb1.js"><link rel="prefetch" href="/dafnycommunity/assets/js/61.1d1b92f4.js"><link rel="prefetch" href="/dafnycommunity/assets/js/62.2cdbc236.js"><link rel="prefetch" href="/dafnycommunity/assets/js/64.4ecd0d25.js"><link rel="prefetch" href="/dafnycommunity/assets/js/65.25118b81.js"><link rel="prefetch" href="/dafnycommunity/assets/js/66.cdab1b54.js"><link rel="prefetch" href="/dafnycommunity/assets/js/67.655e6e84.js"><link rel="prefetch" href="/dafnycommunity/assets/js/68.84effb44.js"><link rel="prefetch" href="/dafnycommunity/assets/js/69.8f07f81a.js"><link rel="prefetch" href="/dafnycommunity/assets/js/70.d9a299e6.js"><link rel="prefetch" href="/dafnycommunity/assets/js/71.16ef2000.js"><link rel="prefetch" href="/dafnycommunity/assets/js/72.8252acc5.js"><link rel="prefetch" href="/dafnycommunity/assets/js/73.f53e39bc.js"><link rel="prefetch" href="/dafnycommunity/assets/js/74.5ef910c4.js"><link rel="prefetch" href="/dafnycommunity/assets/js/75.72174d00.js"><link rel="prefetch" href="/dafnycommunity/assets/js/76.bebf75c9.js"><link rel="prefetch" href="/dafnycommunity/assets/js/77.b85547c7.js"><link rel="prefetch" href="/dafnycommunity/assets/js/78.a0a1f574.js"><link rel="prefetch" href="/dafnycommunity/assets/js/79.a731d645.js"><link rel="prefetch" href="/dafnycommunity/assets/js/8.522ce892.js"><link rel="prefetch" href="/dafnycommunity/assets/js/80.6e5b64b0.js"><link rel="prefetch" href="/dafnycommunity/assets/js/81.6e19e312.js"><link rel="prefetch" href="/dafnycommunity/assets/js/82.9244e788.js"><link rel="prefetch" href="/dafnycommunity/assets/js/83.f08c5aed.js"><link rel="prefetch" href="/dafnycommunity/assets/js/84.085ef3f8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/85.c41e6e0e.js"><link rel="prefetch" href="/dafnycommunity/assets/js/86.e3798708.js"><link rel="prefetch" href="/dafnycommunity/assets/js/87.fdac1c1c.js"><link rel="prefetch" href="/dafnycommunity/assets/js/88.665ac8c8.js"><link rel="prefetch" href="/dafnycommunity/assets/js/89.78dc55eb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/9.4d4f4bdb.js"><link rel="prefetch" href="/dafnycommunity/assets/js/90.4757b202.js"><link rel="prefetch" href="/dafnycommunity/assets/js/91.a0746cf2.js">
    <link rel="stylesheet" href="/dafnycommunity/assets/css/0.styles.ecdcfe28.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="ç›®å½•" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dafnycommunity/" class="home-link router-link-active"><img src="/dafnycommunity/img/logo-2.png" alt="Dafny" class="logo"> <span class="site-name can-hide">Dafny</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dafnycommunity/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é…ç½®" class="dropdown-title"><a href="/dafnycommunity/peizhi/" class="link-title">é…ç½®</a> <span class="title" style="display:none;">é…ç½®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å…¥é—¨ä»‹ç»</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/56e571/" class="nav-link">ä»€ä¹ˆæ˜¯dafny?</a></li></ul></li><li class="dropdown-item"><h4>ç”¨èµ·æ¥å§ï¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/4fa796/" class="nav-link">å®‰è£…</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/085606/" class="nav-link">å¿«é€Ÿä¸Šæ‰‹</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/39fb20/" class="nav-link">å¯èƒ½é‡åˆ°çš„é—®é¢˜?</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><a href="/dafnycommunity/zhinan/" class="link-title">æŒ‡å—</a> <span class="title" style="display:none;">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafnyå¿«é€Ÿå…¥é—¨</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/6e15a6/" class="nav-link">åŸºç¡€å­¦ä¹  Basic</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/eba166/" class="nav-link">æ–¹æ³• Method</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/83cdf9/" class="nav-link">å…³é”®å­— Keyword</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/01d76e/" class="nav-link">å‡½æ•° Function</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0fadc1/" class="nav-link">ç±» Class </a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a010ab/" class="nav-link">æ³›å‹ Generics</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/c4fda3/" class="nav-link">å£°æ˜ Statement</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e8438e/" class="nav-link">è¡¨è¾¾å¼ Expression</a></li></ul></li><li class="dropdown-item"><h4>Dafnyç®€å•ä¾‹å­</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0978ce/" class="nav-link">å¯»æ‰¾æœ€å¤§æœ€å°æ•°å’Œ</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e3e481/" class="nav-link">æ–æ³¢é‚£å¥‘æ•°åˆ—</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/02fdef/" class="nav-link">çº¿æ€§æŸ¥è¯¢</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9b332b/" class="nav-link">å¼•ç†-è®¡ç®—åºåˆ—éè´Ÿå…ƒç´ ä¸ªæ•°</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/3d1110/" class="nav-link">é›†åˆ</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2146d4/" class="nav-link">ç»ˆæ­¢</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•™ç¨‹" class="dropdown-title"><a href="/dafnycommunity/jiaocheng/" class="link-title">æ•™ç¨‹</a> <span class="title" style="display:none;">æ•™ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>DafnyæŒ‡å¯¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/877eb3/" class="nav-link">ä»‹ç»</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/bf40c0/" class="nav-link">æ–¹æ³• Methods</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2e0c73/" class="nav-link">å‰ç½®/åç½®æ¡ä»¶ Pre/Postconditions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/36c1b4/" class="nav-link">æ–­è¨€ Assertions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a1d5a4/" class="nav-link">å‡½æ•° Functions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/d89435/" class="nav-link">å¾ªç¯ä¸å˜ä½“ Loop Invariants</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/828a83/" class="nav-link">æ•°ç»„ Arrays</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/17e8d1/" class="nav-link">é‡è¯(å‡½æ•°) Quantifiers</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cc01af/" class="nav-link">è°“è¯(å‡½æ•°) Predicates</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/13bbcd/" class="nav-link">æ¡†æ¶ Framing</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1319be/" class="nav-link">äºŒåˆ†æœç´¢ Binary Search</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/30a8c2/" class="nav-link">æ€»ç»“</a></li></ul></li><li class="dropdown-item"><h4>Dafnyè¿›é˜¶è¯­æ³•</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/273cac/" class="nav-link">å¼•ç†å’Œå½’çº³ Lemmas and Induction</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9d19b8/" class="nav-link">æ¨¡å— Modules</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/b9300a/" class="nav-link">é›†åˆ sets</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cb3d21/" class="nav-link">åºåˆ— sequence</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fc6196/" class="nav-link">ç»ˆæ­¢ Terminal</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a2a107/" class="nav-link">å€¼ç±»å‹ Values Types</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="èµ„æº" class="dropdown-title"><a href="/dafnycommunity/ziyuan/" class="link-title">èµ„æº</a> <span class="title" style="display:none;">èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®è·µæ¢ç´¢</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/718207/" class="nav-link">è‡ªåŠ¨å½’çº³</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1f579f/" class="nav-link">è‡ªåŠ¨è°ƒç”¨å¼•ç†</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/f6638c/" class="nav-link">å®šä¹‰ã€è¯æ˜ã€ç®—æ³•æ­£ç¡®æ€§</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1d2420/" class="nav-link">å„ç§æ¨å¯¼å¼</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/20c275/" class="nav-link">ä¸åŒç±»å‹çš„è¯æ˜</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/67167e/" class="nav-link">é›†åˆå…ƒç´ ä¸Šçš„å‡½æ•°</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/be298d/" class="nav-link">åœ¨é›†åˆä¸Šçš„è¿­ä»£</a></li></ul></li><li class="dropdown-item"><h4>å¸¸ç”¨å·¥å…·</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/8065fd/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Type System</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0f17ab/" class="nav-link">Style Guide</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fe5721/" class="nav-link">Cheet Sheet</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/1b94a4/" class="nav-link">âœ¨æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ·ï¸è¯­è¨€" class="dropdown-title"><!----> <span class="title" style="display:;">ğŸ·ï¸è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dafnycommunity/" class="nav-link">ç®€ä½“ä¸­æ–‡</a></li><li class="dropdown-item"><!----> <a href="/dafnycommunity/en-US/" class="nav-link">English</a></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/caf1f9/" class="nav-link">ğŸ’¬ç¤¾åŒºç•™è¨€æ¿</a></div> <a href="https://github.com/aaron-clou/dafnycommunity" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://s1.ax1x.com/2022/04/01/qh3tDe.png"> <div class="blogger-info"><h3>Dafny</h3> <span>æ–°ä¸€ä»£éªŒè¯è¯­è¨€</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/dafnycommunity/" class="nav-link">é¦–é¡µ</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="é…ç½®" class="dropdown-title"><a href="/dafnycommunity/peizhi/" class="link-title">é…ç½®</a> <span class="title" style="display:none;">é…ç½®</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å…¥é—¨ä»‹ç»</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/56e571/" class="nav-link">ä»€ä¹ˆæ˜¯dafny?</a></li></ul></li><li class="dropdown-item"><h4>ç”¨èµ·æ¥å§ï¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/4fa796/" class="nav-link">å®‰è£…</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/085606/" class="nav-link">å¿«é€Ÿä¸Šæ‰‹</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/39fb20/" class="nav-link">å¯èƒ½é‡åˆ°çš„é—®é¢˜?</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æŒ‡å—" class="dropdown-title"><a href="/dafnycommunity/zhinan/" class="link-title">æŒ‡å—</a> <span class="title" style="display:none;">æŒ‡å—</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>Dafnyå¿«é€Ÿå…¥é—¨</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/6e15a6/" class="nav-link">åŸºç¡€å­¦ä¹  Basic</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/eba166/" class="nav-link">æ–¹æ³• Method</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/83cdf9/" class="nav-link">å…³é”®å­— Keyword</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/01d76e/" class="nav-link">å‡½æ•° Function</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0fadc1/" class="nav-link">ç±» Class </a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a010ab/" class="nav-link">æ³›å‹ Generics</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/c4fda3/" class="nav-link">å£°æ˜ Statement</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e8438e/" class="nav-link">è¡¨è¾¾å¼ Expression</a></li></ul></li><li class="dropdown-item"><h4>Dafnyç®€å•ä¾‹å­</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0978ce/" class="nav-link">å¯»æ‰¾æœ€å¤§æœ€å°æ•°å’Œ</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/e3e481/" class="nav-link">æ–æ³¢é‚£å¥‘æ•°åˆ—</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/02fdef/" class="nav-link">çº¿æ€§æŸ¥è¯¢</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9b332b/" class="nav-link">å¼•ç†-è®¡ç®—åºåˆ—éè´Ÿå…ƒç´ ä¸ªæ•°</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/3d1110/" class="nav-link">é›†åˆ</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2146d4/" class="nav-link">ç»ˆæ­¢</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ•™ç¨‹" class="dropdown-title"><a href="/dafnycommunity/jiaocheng/" class="link-title">æ•™ç¨‹</a> <span class="title" style="display:none;">æ•™ç¨‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>DafnyæŒ‡å¯¼</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/877eb3/" class="nav-link">ä»‹ç»</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/bf40c0/" class="nav-link">æ–¹æ³• Methods</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/2e0c73/" class="nav-link">å‰ç½®/åç½®æ¡ä»¶ Pre/Postconditions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/36c1b4/" class="nav-link">æ–­è¨€ Assertions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a1d5a4/" class="nav-link">å‡½æ•° Functions</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/d89435/" class="nav-link">å¾ªç¯ä¸å˜ä½“ Loop Invariants</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/828a83/" class="nav-link">æ•°ç»„ Arrays</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/17e8d1/" class="nav-link">é‡è¯(å‡½æ•°) Quantifiers</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cc01af/" class="nav-link">è°“è¯(å‡½æ•°) Predicates</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/13bbcd/" class="nav-link">æ¡†æ¶ Framing</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1319be/" class="nav-link">äºŒåˆ†æœç´¢ Binary Search</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/30a8c2/" class="nav-link">æ€»ç»“</a></li></ul></li><li class="dropdown-item"><h4>Dafnyè¿›é˜¶è¯­æ³•</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/273cac/" class="nav-link">å¼•ç†å’Œå½’çº³ Lemmas and Induction</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/9d19b8/" class="nav-link">æ¨¡å— Modules</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/b9300a/" class="nav-link">é›†åˆ sets</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/cb3d21/" class="nav-link">åºåˆ— sequence</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fc6196/" class="nav-link">ç»ˆæ­¢ Terminal</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/a2a107/" class="nav-link">å€¼ç±»å‹ Values Types</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="èµ„æº" class="dropdown-title"><a href="/dafnycommunity/ziyuan/" class="link-title">èµ„æº</a> <span class="title" style="display:none;">èµ„æº</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>å®è·µæ¢ç´¢</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/718207/" class="nav-link">è‡ªåŠ¨å½’çº³</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1f579f/" class="nav-link">è‡ªåŠ¨è°ƒç”¨å¼•ç†</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/f6638c/" class="nav-link">å®šä¹‰ã€è¯æ˜ã€ç®—æ³•æ­£ç¡®æ€§</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/1d2420/" class="nav-link">å„ç§æ¨å¯¼å¼</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/20c275/" class="nav-link">ä¸åŒç±»å‹çš„è¯æ˜</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/67167e/" class="nav-link">é›†åˆå…ƒç´ ä¸Šçš„å‡½æ•°</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/be298d/" class="nav-link">åœ¨é›†åˆä¸Šçš„è¿­ä»£</a></li></ul></li><li class="dropdown-item"><h4>å¸¸ç”¨å·¥å…·</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dafnycommunity/pages/8065fd/" aria-current="page" class="nav-link router-link-exact-active router-link-active">Type System</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/0f17ab/" class="nav-link">Style Guide</a></li><li class="dropdown-subitem"><a href="/dafnycommunity/pages/fe5721/" class="nav-link">Cheet Sheet</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/1b94a4/" class="nav-link">âœ¨æ”¶è—</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ğŸ·ï¸è¯­è¨€" class="dropdown-title"><!----> <span class="title" style="display:;">ğŸ·ï¸è¯­è¨€</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dafnycommunity/" class="nav-link">ç®€ä½“ä¸­æ–‡</a></li><li class="dropdown-item"><!----> <a href="/dafnycommunity/en-US/" class="nav-link">English</a></li></ul></div></div><div class="nav-item"><a href="/dafnycommunity/pages/caf1f9/" class="nav-link">ğŸ’¬ç¤¾åŒºç•™è¨€æ¿</a></div> <a href="https://github.com/aaron-clou/dafnycommunity" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å®è·µæ¢ç´¢</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>å¸¸ç”¨å·¥å…·</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dafnycommunity/pages/8065fd/" aria-current="page" class="active sidebar-link">Dafny type system</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_0-åŸºæœ¬ç±»å‹" class="sidebar-link">0.â€‚åŸºæœ¬ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_0-0-booleans" class="sidebar-link">0.0.â€‚Booleans</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_0-1-æ•°å­—ç±»å‹" class="sidebar-link">0.1.â€‚æ•°å­—ç±»å‹</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_0-2-å­—ç¬¦" class="sidebar-link">0.2.â€‚å­—ç¬¦</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_1-ç±»å‹å‚æ•°" class="sidebar-link">1.â€‚ç±»å‹å‚æ•°</a></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_2-é›†åˆç±»å‹" class="sidebar-link">2.â€‚é›†åˆç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_2-0-é›†åˆ" class="sidebar-link">2.0.â€‚é›†åˆ</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_2-1-multisets" class="sidebar-link">2.1.â€‚Multisets</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_2-2-åºåˆ—" class="sidebar-link">2.2.â€‚åºåˆ—</a></li><li class="sidebar-sub-header level4"><a href="/dafnycommunity/pages/8065fd/#_2-2-0-å­—ç¬¦ä¸²" class="sidebar-link">2.2.0.â€‚å­—ç¬¦ä¸²</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_2-3-æœ‰é™ä¸æ— é™å›¾" class="sidebar-link">2.3.â€‚æœ‰é™ä¸æ— é™å›¾</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_3-è±¡å¾ç±»å‹" class="sidebar-link">3.â€‚è±¡å¾ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_3-0-åŒä¹‰è¯ç±»å‹" class="sidebar-link">3.0.â€‚åŒä¹‰è¯ç±»å‹</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_3-1-ä¸é€æ˜ç±»å‹" class="sidebar-link">3.1.â€‚ä¸é€æ˜ç±»å‹</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_4-æ•°æ®ç±»å‹" class="sidebar-link">4.â€‚æ•°æ®ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_4-0-å½’çº³ç±»å‹" class="sidebar-link">4.0.â€‚å½’çº³ç±»å‹</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_4-1-å…ƒç»„ç±»å‹" class="sidebar-link">4.1.â€‚å…ƒç»„ç±»å‹</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_4-2-å…±åŒå½’çº³ç±»å‹" class="sidebar-link">4.2.â€‚å…±åŒå½’çº³ç±»å‹</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_5-å‚ç…§ç±»å‹" class="sidebar-link">5.â€‚å‚ç…§ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-0-ç±»" class="sidebar-link">5.0.â€‚ç±»</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-1-æ•°ç»„" class="sidebar-link">5.1.â€‚æ•°ç»„</a></li><li class="sidebar-sub-header level4"><a href="/dafnycommunity/pages/8065fd/#_5-1-0-ä¸€ç»´æ•°ç»„" class="sidebar-link">5.1.0.â€‚ä¸€ç»´æ•°ç»„</a></li><li class="sidebar-sub-header level4"><a href="/dafnycommunity/pages/8065fd/#_5-1-1-å¤šç»´æ•°ç»„" class="sidebar-link">5.1.1.â€‚å¤šç»´æ•°ç»„</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-2-ç‰¹å¾" class="sidebar-link">5.2.â€‚ç‰¹å¾</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-3-ç±»å‹-object" class="sidebar-link">5.3.â€‚ç±»å‹ object</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-4-è¿­ä»£å™¨ç±»å‹" class="sidebar-link">5.4.â€‚è¿­ä»£å™¨ç±»å‹</a></li><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_5-5-å¼‚æ­¥ä»»åŠ¡ç±»å‹" class="sidebar-link">5.5.â€‚å¼‚æ­¥ä»»åŠ¡ç±»å‹</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_6-å‡½æ•°ç±»å‹" class="sidebar-link">6.â€‚å‡½æ•°ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_6-0-lambdaè¡¨è¾¾å¼" class="sidebar-link">6.0.â€‚Lambdaè¡¨è¾¾å¼</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_7-æ–°ç±»å‹" class="sidebar-link">7.â€‚æ–°ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/dafnycommunity/pages/8065fd/#_7-0-æ•°å­—è½¬æ¢æ“ä½œ" class="sidebar-link">7.0.â€‚æ•°å­—è½¬æ¢æ“ä½œ</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/dafnycommunity/pages/8065fd/#_8-å­é›†ç±»å‹" class="sidebar-link">8.â€‚å­é›†ç±»å‹</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level4"><a href="/dafnycommunity/pages/8065fd/#å‚è€ƒèµ„æ–™" class="sidebar-link">å‚è€ƒèµ„æ–™</a></li></ul></li></ul></li><li><a href="/dafnycommunity/pages/0f17ab/" class="sidebar-link">Style Guide for Dafny programs</a></li><li><a href="/dafnycommunity/pages/a65c3f/" class="sidebar-link">Cheet Sheet</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-0c557b5e><div class="articleInfo" data-v-0c557b5e><ul class="breadcrumbs" data-v-0c557b5e><li data-v-0c557b5e><a href="/dafnycommunity/" title="é¦–é¡µ" class="iconfont icon-home router-link-active" data-v-0c557b5e></a></li> <li data-v-0c557b5e><a href="/dafnycommunity/ziyuan/#èµ„æº" data-v-0c557b5e>èµ„æº</a></li><li data-v-0c557b5e><a href="/dafnycommunity/ziyuan/#å¸¸ç”¨å·¥å…·" data-v-0c557b5e>å¸¸ç”¨å·¥å…·</a></li></ul> <div class="info" data-v-0c557b5e><div title="ä½œè€…" class="author iconfont icon-touxiang" data-v-0c557b5e><a href="https://github.com/Aaron-clou" target="_blank" title="ä½œè€…" class="beLink" data-v-0c557b5e>lijiahai</a></div> <div title="åˆ›å»ºæ—¶é—´" class="date iconfont icon-riqi" data-v-0c557b5e><a href="javascript:;" data-v-0c557b5e>2022-03-26</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">ç›®å½•</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Dafny type system<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="dafny-type-system"><a href="#dafny-type-system" class="header-anchor">#</a> Dafny Type System</h1> <p><em>Dafnyè¯­è¨€å‚è€ƒçš„è¿™ä¸€éƒ¨åˆ†æè¿°äº†Dafnyç¼–ç¨‹è¯­è¨€ä¸­çš„ç±»å‹ã€‚æ‰€æè¿°çš„æ˜¯Dafnyç‰ˆæœ¬1.9.3.20107ä¸­å®ç°çš„å†…å®¹ï¼Œå¼‚æ­¥ä»»åŠ¡ç±»å‹å°šæœªè¿›å…¥ä¸»åˆ†æ”¯ã€‚</em></p> <blockquote><p><a href="http://leino.science/papers/krml243.html#sec-basic-types" target="_blank" rel="noopener noreferrer">0.â€‚åŸºæœ¬ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-booleans" target="_blank" rel="noopener noreferrer">0.0.â€‚å¸ƒå°”å€¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-numeric-types" target="_blank" rel="noopener noreferrer">0.1.â€‚æ•°å­—ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-char" target="_blank" rel="noopener noreferrer">0.2.â€‚å­—ç¬¦<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-type-parameters" target="_blank" rel="noopener noreferrer">1.â€‚ç±»å‹å‚æ•°<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-collection-types" target="_blank" rel="noopener noreferrer">2.â€‚é›†åˆç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-sets" target="_blank" rel="noopener noreferrer">2.0.â€‚é›†åˆ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-multisets" target="_blank" rel="noopener noreferrer">2.1.â€‚å¤šé›†<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-sequences" target="_blank" rel="noopener noreferrer">2.2.â€‚åºåˆ—<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-string" target="_blank" rel="noopener noreferrer">2.2.0.â€‚å­—ç¬¦ä¸²<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-finite-and-infinite-maps" target="_blank" rel="noopener noreferrer">2.3.â€‚æœ‰é™ä¸æ— é™å›¾<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-types-that-stand-for-other-types" target="_blank" rel="noopener noreferrer">3.â€‚è±¡å¾ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-type-synonyms" target="_blank" rel="noopener noreferrer">3.0.â€‚åŒä¹‰è¯ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-opaque-types" target="_blank" rel="noopener noreferrer">3.1.â€‚ä¸é€æ˜ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-datatypes" target="_blank" rel="noopener noreferrer">4.â€‚æ•°æ®ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-inductive-datatypes" target="_blank" rel="noopener noreferrer">4.0.â€‚å½’çº³æ•°æ®ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-tuple-types" target="_blank" rel="noopener noreferrer">4.1.â€‚å…ƒç»„ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-co-inductive-datatypes" target="_blank" rel="noopener noreferrer">4.2.â€‚å…±åŒå½’çº³ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-reference-types" target="_blank" rel="noopener noreferrer">5.â€‚å‚ç…§ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-classes" target="_blank" rel="noopener noreferrer">5.0.â€‚ç±»<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-arrays" target="_blank" rel="noopener noreferrer">5.1.â€‚æ•°ç»„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-one-dimensional-arrays" target="_blank" rel="noopener noreferrer">5.1.0.â€‚ä¸€ç»´æ•°ç»„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-multi-dimensional-arrays" target="_blank" rel="noopener noreferrer">5.1.1.â€‚å¤šç»´æ•°ç»„<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-traits" target="_blank" rel="noopener noreferrer">5.2.â€‚ç‰¹å¾<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-type-object" target="_blank" rel="noopener noreferrer">5.3.â€‚ç±»å‹ <code>object</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-iterator-types" target="_blank" rel="noopener noreferrer">5.4.â€‚è¿­ä»£å™¨ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-async-task-types" target="_blank" rel="noopener noreferrer">5.5.â€‚å¼‚æ­¥ä»»åŠ¡ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-function-types" target="_blank" rel="noopener noreferrer">6.â€‚å‡½æ•°ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-lambda-expressions" target="_blank" rel="noopener noreferrer">6.0.â€‚Lambdaè¡¨è¾¾å¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-newtypes" target="_blank" rel="noopener noreferrer">7.â€‚æ–°ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-numeric-conversions" target="_blank" rel="noopener noreferrer">7.0.â€‚æ•°å­—è½¬åŒ–æ“ä½œ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="http://leino.science/papers/krml243.html#sec-subset-types" target="_blank" rel="noopener noreferrer">8.â€‚å­é›†ç±»å‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <h2 id="_0-åŸºæœ¬ç±»å‹"><a href="#_0-åŸºæœ¬ç±»å‹" class="header-anchor">#</a> 0.â€‚åŸºæœ¬ç±»å‹</h2> <p>Dafnyæä¾›äº†ä¸‰ç§åŸºæœ¬ç±»å‹ï¼Œ<code>bool</code>è¡¨ç¤ºå¸ƒå°”ï¼Œ<code>int</code>è¡¨ç¤ºæ•´æ•°ï¼Œ<code>real</code>è¡¨ç¤ºå®æ•°ã€‚</p> <h3 id="_0-0-booleans"><a href="#_0-0-booleans" class="header-anchor">#</a> 0.0.â€‚Booleans</h3> <p>æœ‰ä¸¤ä¸ªå¸ƒå°”å€¼ï¼Œæ¯ä¸ªå€¼åœ¨è¯­è¨€ä¸­éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„æ–‡æœ¬ï¼š<code>false</code>å’Œ<code>true</code>ã€‚</p> <p>é™¤äº†åœ¨æ‰€æœ‰ç±»å‹ä¸Šå®šä¹‰çš„ç›¸ç­‰ï¼ˆ<code>=</code>ï¼‰å’Œdisequalityï¼ˆ<code>ï¼=</code>ï¼‰ï¼Œç±»å‹<code>bool</code>è¿˜æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>&lt;==&gt;</code></td> <td>å½“ä¸”ä»…å½“</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>==&gt;</code></td> <td>è•´å«</td></tr> <tr><td><code>&lt;==</code></td> <td>åå‘è•´å«</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>&amp;&amp;</code></td> <td>è¿æ¥(ä¸”)</td></tr> <tr><td><code>||</code></td> <td>æå–(æˆ–)</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>!</code></td> <td>å¦å®š(é)</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>å¦å®šæ˜¯ä¸€å…ƒçš„ï¼›å…¶ä»–çš„æ˜¯äºŒè¿›åˆ¶çš„ã€‚è¯¥è¡¨æ˜¾ç¤ºäº†ä¸€ç»„ç»“åˆåŠ›ä¸æ–­å¢å¼ºçš„è¿ç®—ç¬¦ï¼Œç­‰å¼ç»“åˆæ¯”åˆå–å’Œæå–å¼ºï¼Œæ¯”å¦å®šå¼±ã€‚åœ¨æ¯ä¸ªç»„ä¸­ï¼Œä¸åŒçš„è¿ç®—ç¬¦ä¸å…³è”ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨æ‹¬å·ã€‚ä¾‹å¦‚,</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &amp;&amp; B || C    // error
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°†æ˜¯ä¸æ˜ç¡®çš„ï¼Œè€Œå¿…é¡»å†™ä¸º</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>(A &amp;&amp; B) || C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æˆ–</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &amp;&amp; (B || C)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å–å†³äºé¢„æœŸçš„æ„æ€ã€‚</p> <p>è¡¨è¾¾å¼<code>A&lt;=&gt;B</code>å’Œ<code>A==B</code>ç»™å‡ºäº†ç›¸åŒçš„å€¼ï¼Œä½†è¯·æ³¨æ„ï¼Œ<code>&lt;=&gt;</code>æ˜¯å…³è”çš„ï¼Œ<code>=</code>æ˜¯é“¾æ¥çš„ã€‚æ‰€ä»¥</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &lt;==&gt; B &lt;==&gt; C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸ä¸‹å¼ç›¸åŒ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &lt;==&gt; (B &lt;==&gt; C)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å’Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>(A &lt;==&gt; B) &lt;==&gt; C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é‰´äº</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A == B == C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åªæ˜¯ä¸‹å¼çš„é€Ÿè®°</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A == B &amp;&amp; B == C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åˆå–æ˜¯å…³è”çš„ï¼Œæå–ä¹Ÿæ˜¯ã€‚è¿™äº›è¿ç®—ç¬¦æ˜¯<em>çŸ­è·¯ï¼ˆä»å·¦åˆ°å³ï¼‰</em>ï¼Œè¿™æ„å‘³ç€åªæœ‰åœ¨ç¬¬ä¸€ä¸ªæ“ä½œæ•°çš„è®¡ç®—ä¸ç¡®å®šè¡¨è¾¾å¼çš„å€¼æ—¶ï¼Œæ‰ä¼šè®¡ç®—å®ƒä»¬çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚ä»é€»è¾‘ä¸Šè®²ï¼Œè¡¨è¾¾å¼<code>A&amp;&amp;B</code>æ˜¯åœ¨å®šä¹‰äº†<code>A</code>å¹¶ä¸”<code>A</code>çš„è®¡ç®—ç»“æœä¸º<code>false</code>æˆ–<code>B</code>æ—¶å®šä¹‰çš„ã€‚å®šä¹‰<code>A&amp;&amp;B</code>æ—¶ï¼Œå…¶å«ä¹‰ä¸æ™®é€šçš„å¯¹ç§°æ•°å­¦è¿è¯ç›¸åŒâˆ§. | | |å’Œâˆ¨.</p> <p>å«ä¹‰æ˜¯â€œå³å…³è”â€ï¼Œä»å·¦åˆ°å³çŸ­è·¯ã€‚åå‘è•´æ¶µ<code>B&lt;==A</code>ä¸<code>A==&gt;B</code>å®Œå…¨ç›¸åŒï¼Œä½†å¯ä»¥æŒ‰ç›¸åçš„é¡ºåºå†™å…¥æ“ä½œæ•°ã€‚å› æ­¤ï¼Œåå‘å«ä¹‰æ˜¯â€œå·¦å…³è”â€ï¼Œæ˜¯ä»â€œå³â€åˆ°â€œå·¦â€çš„çŸ­è·¯ã€‚ä¸ºäº†è¯´æ˜å…³è”æ€§è§„åˆ™ï¼Œä»¥ä¸‹å››è¡Œä¸­çš„æ¯ä¸€è¡Œéƒ½è¡¨ç¤ºäº†ç›¸åŒçš„å±æ€§ï¼Œå³<code>bool</code>ç±»å‹çš„ä»»ä½•<code>A</code>ã€<code>B</code>å’Œ<code>C</code>ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A ==&gt; B ==&gt; C
A ==&gt; (B ==&gt; C)  // parentheses redundant, since ==&gt; is right associative
C &lt;== B &lt;== A
(C &lt;== B) &lt;== A  // parentheses redundant, since &lt;== is left associative
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä¸ºäº†è¯´æ˜çŸ­è·¯è§„åˆ™ï¼Œè¯·æ³¨æ„ï¼Œè¡¨è¾¾å¼<code>a.Length</code>ä»…åœ¨<code>a</code>ä¸ä¸º<code>null</code>æ—¶æ‰ä¸ºæ•°ç»„<code>a</code>å®šä¹‰ (è§ å°èŠ‚ <a href="http://leino.science/papers/krml243.html#sec-reference-types" target="_blank" rel="noopener noreferrer">5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), è¿™æ„å‘³ç€ä»¥ä¸‹ä¸¤ä¸ªè¡¨è¾¾å¼æ ¼å¼æ­£ç¡®ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a != null ==&gt; 0 &lt;= a.Length
0 &lt;= a.Length &lt;== a != null
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>è¿™ä¸¤ç§è¡¨è¾¾çš„åä½œç”¨æ˜¯ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a.Length &lt; 0 ==&gt; a == null  // not well-formed
a == null &lt;== a.Length &lt; 0  // not well-formed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä½†è¿™äº›è¡¨è¾¾å¼çš„æ ¼å¼ä¸å¥½ï¼Œå› ä¸ºæ ¼å¼å¥½è¦æ±‚å·¦ï¼ˆå’Œå³ï¼‰æ“ä½œæ•°<code>a.Length&lt;0</code>æœ¬èº«æ ¼å¼è‰¯å¥½ã€‚</p> <p>è•´æ¶µ<code>A==&gt;B</code>ç›¸å½“äºæå–<code>ï¼A | | B</code>ï¼Œä½†æœ‰æ—¶ï¼ˆå°¤å…¶æ˜¯åœ¨è§„èŒƒä¸­ï¼‰æ›´æ¸…æ™°æ˜“è¯»ã€‚ç”±äº<code>||</code>æ˜¯ä»å·¦å‘å³çŸ­è·¯ï¼Œè¯·æ³¨æ„</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a == null || 0 &lt;= a.Length
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç»“æ„è‰¯å¥½ï¼Œè€Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>0 &lt;= a.Length || a == null  // not well-formed
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç»“æ„è¾ƒå·®ã€‚</p> <p>æ­¤å¤–ï¼Œå¸ƒå°”è¯­æ”¯æŒ<em>é€»è¾‘é‡è¯</em>ï¼ˆforallå’Œexistsï¼‰ï¼Œåœ¨Dafnyè¯­è¨€å‚è€ƒçš„å¦ä¸€éƒ¨åˆ†ä¸­æœ‰æè¿°ã€‚</p> <h3 id="_0-1-æ•°å­—ç±»å‹"><a href="#_0-1-æ•°å­—ç±»å‹" class="header-anchor">#</a> 0.1.â€‚æ•°å­—ç±»å‹</h3> <p>Dafny æ”¯æŒä¸¤ç§ <em>numeric ç±»å‹</em>ï¼Œ<em>integer-based</em>ï¼ŒåŒ…æ‹¬æ‰€æœ‰æ•´æ•°çš„åŸºæœ¬ç±»å‹ <code>int</code>ï¼Œå’Œ <em>real-based</em>ï¼ŒåŒ…æ‹¬æ‰€æœ‰å®æ•°çš„åŸºæœ¬ç±»å‹ <code>real</code>ã€‚ ç”¨æˆ·å®šä¹‰çš„åŸºäº <code>int</code> å’Œ <code>real</code> çš„æ•°å­—ç±»å‹ï¼Œç§°ä¸º <em>newtypes</em>ï¼Œåœ¨ç¬¬ [7] èŠ‚(http://leino.science/papers/krml243.html#sec-newtypes) ä¸­æœ‰æè¿°ã€‚ æ­¤å¤–ï¼Œä»£è¡¨ <code>int</code> çš„éè´Ÿå­èŒƒå›´çš„ <em>subset type</em> <code>nat</code> åœ¨ç¬¬ [8] èŠ‚ï¼ˆhttp://leino.science/papers/krml243.html#sec-subset-typesï¼‰ä¸­è¿›è¡Œäº†æè¿° .
è¯¥è¯­è¨€åŒ…å«æ¯ä¸ªéè´Ÿæ•´æ•°çš„æ–‡å­—ï¼Œä¾‹å¦‚â€œ0â€ã€â€œ13â€å’Œâ€œ1985â€ã€‚ æ•´æ•°ä¹Ÿå¯ä»¥ä½¿ç”¨å‰ç¼€â€œ0xâ€ä»¥åå…­è¿›åˆ¶ä¹¦å†™ï¼Œå¦‚â€œ0x0â€ã€â€œ0xDâ€å’Œâ€œ0x7c1â€ï¼ˆå§‹ç»ˆä½¿ç”¨å°å†™â€œxâ€ï¼Œä½†åå…­è¿›åˆ¶æ•°å­—æœ¬èº«ä¸åŒºåˆ†å¤§å°å†™ï¼‰ã€‚ å…è®¸ä½¿ç”¨å‰å¯¼é›¶ã€‚ è¦å½¢æˆè´Ÿæ•´æ•°ï¼Œè¯·ä½¿ç”¨ä¸€å…ƒå‡å·è¿ç®—ç¬¦ã€‚
ä¸€äº›éè´Ÿå®æ•°ä¹Ÿæœ‰æ–‡å­—ã€‚ è¿™äº›è¢«å†™æˆä¸€ä¸ªå°æ•°ç‚¹ï¼Œä¸¤è¾¹éƒ½æœ‰ä¸€ä¸ªéç©ºçš„åè¿›åˆ¶æ•°å­—åºåˆ—ã€‚ ä¾‹å¦‚ï¼Œâ€œ1.0â€ã€â€œ1609.344â€å’Œâ€œ0.5772156649â€ã€‚
å¯¹äºæ•´æ•°ï¼ˆåè¿›åˆ¶å’Œåå…­è¿›åˆ¶å½¢å¼ï¼‰å’Œå®æ•°ï¼Œæ–‡å­—ä¸­çš„ä»»ä½•ä¸¤ä½æ•°å­—éƒ½å¯ä»¥ç”¨ä¸‹åˆ’çº¿åˆ†éš”ï¼Œä»¥æé«˜æ–‡å­—çš„å¯è¯»æ€§ã€‚ ä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>1_000_000        // easier to read than 1000000
0_12_345_6789    // strange but legal formatting of 123456789
0x8000_0000      // same as 0x80000000 -- hex digits are often placed in groups of 4
0.000_000_000_1  // same as 0.0000000001 -- 1 Ã…ngstrÃ¶m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>é™¤äº†ç›¸ç­‰å’Œä¸ç›¸ç­‰ä¹‹å¤–ï¼Œæ•°å€¼ç±»å‹è¿˜æ”¯æŒä»¥ä¸‹å…³ç³»è¿ç®—ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>operator</td> <td>description</td></tr> <tr><td></td> <td></td></tr> <tr><td>&lt;</td> <td>less than</td></tr> <tr><td><code>&lt;=</code></td> <td>at most</td></tr> <tr><td><code>&gt;=</code></td> <td>at least</td></tr> <tr><td><code>&gt;</code></td> <td>greater than</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>å°±åƒç›¸ç­‰å’Œä¸ç›¸ç­‰ä¸€æ ·ï¼Œè¿™äº›è¿ç®—ç¬¦æ˜¯é“¾æ¥çš„ï¼Œåªè¦å®ƒä»¬é“¾æ¥åœ¨â€œç›¸åŒçš„æ–¹å‘â€ã€‚ é‚£å°±æ˜¯è¯´ï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &lt;= B &lt; C == D &lt;= E
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>is simply a shorthand for</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &lt;= B &amp;&amp; B &lt; C &amp;&amp; C == D &amp;&amp; D &lt;= E
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è€Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A &lt; B &gt; C
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸è¢«å…è®¸ã€‚
æ¯ç§æ•°å­—ç±»å‹ä¹Ÿæœ‰è¿ç®—ç¬¦ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>+</code></td> <td>åŠ </td></tr> <tr><td><code>-</code></td> <td>å‡</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>*</code></td> <td>ä¹˜</td></tr> <tr><td><code>/</code></td> <td>é™¤</td></tr> <tr><td><code>%</code></td> <td>å–æ¨¡</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>-</code></td> <td>å¦å®š (ä¸€å…ƒå‡)</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>äºŒå…ƒè¿ç®—ç¬¦æ˜¯å·¦ç»“åˆçš„ï¼Œå®ƒä»¬åœ¨ä¸¤ç»„ä¸­ç›¸äº’å…³è”ã€‚ è¿™äº›ç»„æŒ‰ç»‘å®šèƒ½åŠ›å¢åŠ çš„é¡ºåºåˆ—å‡ºï¼Œç­‰å¼ç»‘å®šæ¯”ä¹˜æ³•è¿ç®—ç¬¦æ›´å¼ºï¼Œæ¯”ä¸€å…ƒè¿ç®—ç¬¦å¼±ã€‚ ä»…åŸºäºæ•´æ•°çš„æ•°å€¼ç±»å‹æ”¯æŒæ¨¡æ•°ã€‚ æ•´æ•°é™¤æ³•å’Œæ¨¡æ•°æ˜¯<em>æ¬§å‡ é‡Œå¾—é™¤æ³•å’Œæ¨¡æ•°</em>ã€‚ è¿™æ„å‘³ç€æ— è®ºä¸¤ä¸ªæ“ä½œæ•°çš„ç¬¦å·å¦‚ä½•ï¼Œæ¨¡æ•°å§‹ç»ˆè¿”å›éè´Ÿæ•°ã€‚ æ›´å‡†ç¡®åœ°è¯´ï¼Œå¯¹äºä»»ä½•æ•´æ•°<code>a</code>å’Œéé›¶æ•´æ•°<code>b</code>ï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a == a / b * b + a % b
0 &lt;= a % b &lt; B
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å…¶ä¸­â€œBâ€è¡¨ç¤ºâ€œbâ€çš„ç»å¯¹å€¼ã€‚
åŸºäºå®æ•°çš„æ•°å€¼ç±»å‹æœ‰ä¸€ä¸ªæˆå‘˜ <code>Trunc</code>ï¼Œå®ƒè¿”å›å®æ•°å€¼çš„ <em>floor</em>ï¼Œå³ä¸è¶…è¿‡å®æ•°å€¼çš„æœ€å¤§æ•´æ•°ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºä»»ä½•ç±»å‹ä¸ºâ€œrealâ€çš„â€œrâ€å’Œâ€œrâ€ï¼Œä»¥ä¸‹å±æ€§æˆç«‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>3.14.Trunc == 3
(-2.5).Trunc == -3
-2.5.Trunc == -2
real(r.Trunc) &lt;= r
r &lt;= r' ==&gt; r.Trunc &lt;= r'.Trunc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¯·æ³¨æ„ï¼Œåœ¨ç¬¬ä¸‰è¡Œä¸­ï¼Œæˆå‘˜è®¿é—®ï¼ˆå¦‚ <code>.Trunc</code>ï¼‰çš„ç»‘å®šæ¯”ä¸€å…ƒå‡å·æ›´å¼ºã€‚ ç¬¬å››è¡Œä½¿ç”¨ä» <code>int</code> åˆ° <code>real</code> çš„è½¬æ¢å‡½æ•° <code>real</code>ï¼Œå¦‚ç¬¬ [7.0] èŠ‚ (http://leino.science/papers/krml243.html#sec-numeric-conversions) ä¸­æ‰€è¿°</p> <h3 id="_0-2-å­—ç¬¦"><a href="#_0-2-å­—ç¬¦" class="header-anchor">#</a> 0.2.â€‚å­—ç¬¦</h3> <p>Dafny æ”¯æŒ <em>characters</em> çš„ <code>char</code> ç±»å‹ã€‚ å­—ç¬¦æ–‡å­—ç”¨å•å¼•å·æ‹¬èµ·æ¥ï¼Œå¦‚ <code>'D'</code>ã€‚ è¦å°†å•å¼•å·å†™æˆå­—ç¬¦æ–‡å­—ï¼Œå¿…é¡»ä½¿ç”¨<em>è½¬ä¹‰åºåˆ—</em>ã€‚ è½¬ä¹‰åºåˆ—ä¹Ÿå¯ç”¨äºå†™å…¥å…¶ä»–å­—ç¬¦ã€‚ æ”¯æŒçš„è½¬ä¹‰åºåˆ—å¦‚ä¸‹ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è½¬ä¹‰å­—ç¬¦</td> <td>å«ä¹‰</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>\'</code></td> <td>å­—ç¬¦ <code>'</code></td></tr> <tr><td><code>\&quot;</code></td> <td>å­—ç¬¦ &quot;</td></tr> <tr><td><code>\\</code></td> <td>å­—ç¬¦ <code>\</code></td></tr> <tr><td><code>\0</code></td> <td>ç©ºå­—ç¬¦ï¼ŒåŒ <code>\u0000</code></td></tr> <tr><td><code>\n</code></td> <td>æ¢è¡Œ</td></tr> <tr><td><code>\r</code></td> <td>å›è½¦</td></tr> <tr><td><code>\t</code></td> <td>æ°´å¹³åˆ¶è¡¨</td></tr> <tr><td><code>\u*xxxx*</code></td> <td>åå…­è¿›åˆ¶ç¼–ç é€šç”¨å­—ç¬¦ <code>*xxxx*</code></td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>åŒå¼•å·çš„è½¬ä¹‰åºåˆ—æ˜¯å¤šä½™çš„ï¼Œå› ä¸º '&quot;' å’Œ '&quot;' è¡¨ç¤ºç›¸åŒçš„å­—ç¬¦â€”â€”æä¾›è¿™ä¸¤ç§å½¢å¼æ˜¯ä¸ºäº†æ”¯æŒä¸å­—ç¬¦ä¸²æ–‡å­—ç›¸åŒçš„è½¬ä¹‰åºåˆ—ï¼ˆç¬¬ [2.2.0] èŠ‚ï¼ˆhttp: //leino.science/papers/krml243.html#sec-string))ã€‚ åœ¨ <code>\u*xxxx*</code> å½¢å¼ä¸­ï¼Œ<code>u</code> æ€»æ˜¯å°å†™ï¼Œä½†å››ä¸ªåå…­è¿›åˆ¶æ•°å­—ä¸åŒºåˆ†å¤§å°å†™ã€‚
å­—ç¬¦å€¼æ˜¯æœ‰åºçš„ï¼Œå¯ä»¥ä½¿ç”¨æ ‡å‡†å…³ç³»è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>&lt;</code></td> <td>å°‘äº</td></tr> <tr><td><code>&lt;=</code></td> <td>è‡³å¤š</td></tr> <tr><td><code>&gt;=</code></td> <td>è‡³å°‘</td></tr> <tr><td><code>&gt;</code></td> <td>å¤§äº</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>å­—ç¬¦åºåˆ—è¡¨ç¤ºå­—ç¬¦ä¸²ï¼Œå¦‚ç¬¬ 2.2.0 èŠ‚æ‰€è¿°ã€‚(http://leino.science/papers/krml243.html#sec-string).</p> <h2 id="_1-ç±»å‹å‚æ•°"><a href="#_1-ç±»å‹å‚æ•°" class="header-anchor">#</a> 1.â€‚ç±»å‹å‚æ•°</h2> <p>Dafny ä¸­çš„è®¸å¤šç±»å‹ï¼ˆä»¥åŠå‡½æ•°å’Œæ–¹æ³•ï¼‰éƒ½å¯ä»¥é€šè¿‡ç±»å‹è¿›è¡Œå‚æ•°åŒ–ã€‚ è¿™äº›<em>ç±»å‹å‚æ•°</em>é€šå¸¸åœ¨å°–æ‹¬å·å†…å£°æ˜ï¼Œå¯ä»¥ä»£è¡¨ä»»ä½•ç±»å‹ã€‚ æœ‰æ—¶éœ€è¦é™åˆ¶è¿™äº›ç±»å‹å‚æ•°ï¼Œä»¥ä¾¿å®ƒä»¬åªèƒ½ç”±æŸäº›ç±»å‹çš„ç³»åˆ—å®ä¾‹åŒ–ã€‚ å› æ­¤ï¼ŒDafny ä¸ä»…åœ¨å¹½çµä¸Šä¸‹æ–‡ä¸­è€Œä¸”åœ¨ç¼–è¯‘ä¸Šä¸‹æ–‡ä¸­åŒºåˆ†æ”¯æŒç›¸ç­‰æ“ä½œçš„ç±»å‹ã€‚ ä¸ºäº†è¡¨æ˜ä¸€ä¸ªç±»å‹å‚æ•°è¢«é™åˆ¶ä¸ºè¿™ç§<em>æ”¯æŒå¹³ç­‰çš„</em>ç±»å‹ï¼Œç±»å‹å‚æ•°çš„åç§°é‡‡ç”¨åç¼€â€œ<code>(==)</code>â€ã€‚[0](http://leino.science/papers/krml243. html#fn-fn-type-mode) ä¾‹å¦‚ï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>method CompareâŒ©T(==)âŒª(a: T, b: T) returns (eq: bool)
{
  if a == b { eq := true; } else { eq := false; }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ˜¯ä¸€ç§æ–¹æ³•ï¼Œå…¶ç±»å‹å‚æ•°ä»…é™äºæ”¯æŒç›¸ç­‰çš„ç±»å‹ã€‚ åŒæ ·ï¼Œè¯·æ³¨æ„ <em>all</em> ç±»å‹åœ¨ <em>ghost</em> ä¸Šä¸‹æ–‡ä¸­æ”¯æŒç›¸ç­‰ï¼› åŒºåˆ«ä»…é€‚ç”¨äºéå¹½çµï¼ˆå³ç¼–è¯‘ï¼‰ä»£ç ã€‚ å…±å½’çº³æ•°æ®ç±»å‹ã€å‡½æ•°ç±»å‹ä»¥åŠå¸¦æœ‰å¹»åƒå‚æ•°çš„å½’çº³æ•°æ®ç±»å‹æ˜¯ä¸æ”¯æŒç­‰å¼çš„ç±»å‹çš„ç¤ºä¾‹ã€‚
Dafny æœ‰ä¸€äº›æ¨ç†æ”¯æŒï¼Œå¯ä»¥ä½¿æŸäº›ç­¾åä¸é‚£ä¹ˆæ··ä¹±ï¼ˆåœ¨ Dafny è¯­è¨€å‚è€ƒçš„ä¸åŒéƒ¨åˆ†ä¸­è¿›è¡Œäº†æè¿°ï¼‰ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ç§æ”¯æŒä¼šæ¨æ–­å‡ºå¿…é¡»å°†ç±»å‹å‚æ•°é™åˆ¶ä¸ºæ”¯æŒç›¸ç­‰çš„ç±»å‹ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒDafny ä¼šè‡ªåŠ¨æ·»åŠ â€œ<code>(==)</code>â€ã€‚</p> <h2 id="_2-é›†åˆç±»å‹"><a href="#_2-é›†åˆç±»å‹" class="header-anchor">#</a> 2.â€‚é›†åˆç±»å‹</h2> <p>Dafny æä¾›äº†å‡ ç§å†…ç½®çš„é›†åˆç±»å‹ã€‚</p> <h3 id="_2-0-é›†åˆ"><a href="#_2-0-é›†åˆ" class="header-anchor">#</a> 2.0.â€‚é›†åˆ</h3> <p>å¯¹äºä»»ä½•ç±»å‹ <code>T</code>ï¼Œ<code>setã€ˆTã€‰</code> ç±»å‹çš„æ¯ä¸ªå€¼éƒ½æ˜¯ <code>T</code> å€¼çš„æœ‰é™é›†åˆã€‚ é›†åˆæˆå‘˜èµ„æ ¼ç”±ç±»å‹ <code>T</code> ä¸­çš„ç›¸ç­‰æ€§ç¡®å®šï¼Œå› æ­¤åªæœ‰å½“<code>T</code> æ”¯æŒç›¸ç­‰æ€§æ—¶ï¼Œ<code>setã€ˆTã€‰</code> æ‰èƒ½åœ¨éå¹½çµä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚
å¯ä»¥ä½¿ç”¨ <em>set display</em> è¡¨è¾¾å¼å½¢æˆä¸€ä¸ªé›†åˆï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½æ˜¯ä¸€ä¸ªç©ºçš„ã€æ— åºçš„ã€ä¸åŒºåˆ†é‡å¤çš„è¡¨è¾¾å¼åˆ—è¡¨ï¼Œç”¨èŠ±æ‹¬å·æ‹¬èµ·æ¥ã€‚ ä¸ºäº†æ˜¾ç¤ºï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>{}        {2, 7, 5, 3}        {4+2, 1+5, a*b}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ˜¯è®¾ç½®æ˜¾ç¤ºçš„ä¸‰ä¸ªç¤ºä¾‹ã€‚ è¿˜æœ‰ä¸€ä¸ª <em>set comprehension</em> è¡¨è¾¾å¼ï¼ˆå¸¦æœ‰æ´»é¡µå¤¹ï¼Œå°±åƒåœ¨é€»è¾‘é‡åŒ–ä¸­ä¸€æ ·ï¼‰ï¼Œåœ¨ Dafny è¯­è¨€å‚è€ƒçš„ä¸åŒéƒ¨åˆ†è¿›è¡Œäº†æè¿°ã€‚
é™¤äº†ç›¸ç­‰å’Œä¸ç›¸ç­‰ä¹‹å¤–ï¼Œé›†åˆç±»å‹è¿˜æ”¯æŒä»¥ä¸‹å…³ç³»è¿ç®—ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>&lt;</code></td> <td>çœŸå­é›†</td></tr> <tr><td><code>&lt;=</code></td> <td>å­é›†</td></tr> <tr><td><code>&gt;=</code></td> <td>è¶…é›†</td></tr> <tr><td><code>&gt;</code></td> <td>çœŸè¶…é›†</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>ä¸ç®—æœ¯å…³ç³»è¿ç®—ç¬¦ä¸€æ ·ï¼Œè¿™â€‹â€‹äº›è¿ç®—ç¬¦æ˜¯é“¾æ¥çš„ã€‚
é›†åˆæ”¯æŒä»¥ä¸‹äºŒå…ƒè¿ç®—ç¬¦ï¼ŒæŒ‰ç»‘å®šèƒ½åŠ›é€’å¢çš„é¡ºåºåˆ—å‡ºï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>!!</code></td> <td>ä¸ç›¸äº¤</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>+</code></td> <td>è®¾ç½®è”åˆ</td></tr> <tr><td><code>-</code></td> <td>è®¾ç½®å·®å¼‚</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>*</code></td> <td>è®¾ç½®äº¤ç‚¹</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p><code>+</code>ã€<code>-</code> å’Œ <code>*</code> çš„ç»“åˆæ€§è§„åˆ™ç±»ä¼¼äºåŒåç®—æœ¯è¿ç®—ç¬¦çš„ç»“åˆæ€§è§„åˆ™ã€‚ è¡¨è¾¾å¼<code>A !! B</code>ï¼Œå®ƒçš„çº¦æŸåŠ›ä¸ç›¸ç­‰æ€§ç›¸åŒï¼ˆä½†å®ƒæ—¢ä¸ä¸ç›¸ç­‰æ€§è”ç³»ä¹Ÿä¸è¿é”ï¼‰ï¼Œè¯´é›†åˆ<code>A</code>å’Œ<code>B</code>æ²¡æœ‰å…±åŒçš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒç­‰ä»·äº</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A * B == {}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä½†æ˜¯ï¼Œä¸ç›¸äº¤è¿ç®—ç¬¦æ˜¯é“¾å¼çš„ï¼Œæ‰€ä»¥ <code>A !! B !! C !! D</code>è¡¨ç¤ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A * B == {} &amp;&amp; (A + B) * C == {} &amp;&amp; (A + B + C) * D == {}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ­¤å¤–ï¼Œå¯¹äºä»»ä½•<code>setã€ˆTã€‰</code>ç±»å‹çš„é›†åˆ<code>s</code>å’Œä»»ä½•<code>T</code>ç±»å‹çš„è¡¨è¾¾å¼<code>e</code>ï¼Œé›†åˆæ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è¡¨è¾¾å¼</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>|s|</td> <td>é›†åˆåŸºæ•°</td></tr> <tr><td><code>e in s</code></td> <td>é›†åˆæˆå‘˜</td></tr> <tr><td><code>e !in s</code></td> <td>é›†åˆéæˆå‘˜</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>è¡¨è¾¾å¼ <code>e !in s</code> æ˜¯ <code>!(e in s)</code> çš„è¯­æ³•ç®€å†™ã€‚</p> <h3 id="_2-1-multisets"><a href="#_2-1-multisets" class="header-anchor">#</a> 2.1.â€‚Multisets</h3> <p><em>multiset</em> ç±»ä¼¼äºé›†åˆï¼Œä½†è·Ÿè¸ªæ¯ä¸ªå…ƒç´ çš„å¤šé‡æ€§ï¼Œè€Œä¸ä»…ä»…æ˜¯å®ƒçš„å­˜åœ¨æˆ–ä¸å­˜åœ¨ã€‚ å¯¹äºä»»ä½•ç±»å‹ <code>T</code>ï¼Œ<code>multisetã€ˆTã€‰</code> ç±»å‹çš„æ¯ä¸ªå€¼éƒ½æ˜¯ä» <code>T</code> å€¼åˆ°è¡¨ç¤ºæ¯ä¸ªå…ƒç´ çš„å¤šé‡æ€§çš„è‡ªç„¶æ•°çš„æ˜ å°„ã€‚ Dafny ä¸­çš„å¤šé‡é›†æ˜¯æœ‰é™çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»¬åŒ…å«æœ‰é™æ•°é‡çš„æ¯ä¸ªæœ‰é™å…ƒç´ ã€‚ æ¢å¥è¯è¯´ï¼Œå¤šé‡é›†ä»…å°†æœ‰é™æ•°é‡çš„å…ƒç´ æ˜ å°„åˆ°éé›¶ï¼ˆæœ‰é™ï¼‰å¤šé‡æ€§ã€‚
ä¸é›†åˆä¸€æ ·ï¼Œå¤šé›†æˆå‘˜èµ„æ ¼ç”±ç±»å‹â€œTâ€ä¸­çš„ç›¸ç­‰æ€§ç¡®å®šï¼Œå› æ­¤åªæœ‰å½“â€œTâ€æ”¯æŒç›¸ç­‰æ—¶ï¼Œâ€œå¤šé›†ã€ˆTã€‰â€æ‰èƒ½åœ¨éå¹½çµä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚
å¯ä»¥ä½¿ç”¨ <em>multiset display</em> è¡¨è¾¾å¼æ¥å½¢æˆå¤šé‡é›†ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½æ˜¯ä¸€ä¸ªç©ºçš„ã€æ— åºåˆ—çš„è¡¨è¾¾å¼åˆ—è¡¨ï¼ŒåŒ…å«åœ¨å…³é”®å­— <code>multiset</code> åé¢çš„èŠ±æ‹¬å·ä¸­ã€‚ ä¸ºäº†æ˜¾ç¤ºï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>multiset{}    multiset{0, 1, 1, 2, 3, 5}    multiset{4+2, 1+5, a*b}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ˜¯å¤šç»„æ˜¾ç¤ºçš„ä¸‰ä¸ªç¤ºä¾‹ã€‚ æ²¡æœ‰å¤šé›†ç†è§£è¡¨è¾¾å¼ã€‚
é™¤äº†ç›¸ç­‰å’Œä¸ç›¸ç­‰ä¹‹å¤–ï¼Œå¤šé‡é›†ç±»å‹è¿˜æ”¯æŒä»¥ä¸‹å…³ç³»è¿ç®—ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>&lt;</td> <td>çœŸå¤šé›†å­é›†</td></tr> <tr><td><code>&lt;=</code></td> <td>å¤šé›†å­é›†</td></tr> <tr><td><code>&gt;=</code></td> <td>å¤šé›†è¶…é›†</td></tr> <tr><td><code>&gt;</code></td> <td>çœŸå¤šé›†è¶…é›†</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>ä¸ç®—æœ¯å…³ç³»è¿ç®—ç¬¦ä¸€æ ·ï¼Œè¿™â€‹â€‹äº›è¿ç®—ç¬¦æ˜¯é“¾æ¥çš„ã€‚
å¤šé‡é›†æ”¯æŒä»¥ä¸‹äºŒå…ƒè¿ç®—ç¬¦ï¼ŒæŒ‰ç»‘å®šèƒ½åŠ›é€’å¢çš„é¡ºåºåˆ—å‡ºï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>!!</code></td> <td>å¤šé›†ä¸ç›¸äº¤</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>+</code></td> <td>å¤šé›†è”åˆ</td></tr> <tr><td><code>-</code></td> <td>å¤šé›†å·®å¼‚</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>*</code></td> <td>å¤šé›†äº¤é›†</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p><code>+</code>ã€<code>-</code> å’Œ <code>*</code> çš„ç»“åˆæ€§è§„åˆ™ç±»ä¼¼äºåŒåç®—æœ¯è¿ç®—ç¬¦çš„ç»“åˆæ€§è§„åˆ™ã€‚ è¡¨è¾¾å¼'A !! B<code>è¡¨ç¤ºå¤šé‡é›†</code>A<code>å’Œ</code>B` æ²¡æœ‰å…±åŒçš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒç­‰ä»·äº</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>A * B == multiset{}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¸ç±»ä¼¼çš„é›†åˆè¿ç®—ç¬¦ä¸€æ ·ï¼Œ<code>!!</code> æ˜¯é“¾å¼çš„ã€‚
æ­¤å¤–ï¼Œå¯¹äºä»»ä½•ç±»å‹ä¸º<code>multisetã€ˆTã€‰çš„å¤šé‡é›†</code>s<code>ã€ç±»å‹ä¸º</code>T<code>çš„è¡¨è¾¾å¼</code>e<code>å’ŒåŸºäºéè´Ÿæ•´æ•°çš„æ•°å­—n</code>ï¼Œå¤šé‡é›†æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è¡¨è¾¾å¼</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>|s|</td> <td>å¤šé›†åŸºæ•°</td></tr> <tr><td><code>e in s</code></td> <td>å¤šé›†æˆå‘˜</td></tr> <tr><td><code>e !in s</code></td> <td>å¤šé›†éæˆå‘˜</td></tr> <tr><td><code>s[e]</code></td> <td><code>e</code> åœ¨ <code>s</code> ä¸­çš„å¤šæ ·æ€§</td></tr> <tr><td><code>s[e := n]</code></td> <td>å¤šé›†æ›´æ–° (å¤šæ ·æ€§å˜åŒ–)</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>å½“ä¸”ä»…å½“ <code>s[e] != 0</code> æ—¶ï¼Œè¡¨è¾¾å¼ <code>e in s</code> æ‰ä¼šè¿”å› <code>true</code>ã€‚ è¡¨è¾¾å¼ <code>e !in s</code> æ˜¯ <code>!(e in s)</code> çš„è¯­æ³•ç®€å†™ã€‚ è¡¨è¾¾å¼ <code>s[e := n]</code> è¡¨ç¤ºç±»ä¼¼äº <code>s</code> çš„å¤šé‡é›†ï¼Œä½†å…ƒç´  <code>e</code> çš„å¤šé‡æ€§æ˜¯ <code>n</code>ã€‚ è¯·æ³¨æ„ï¼Œå¤šé‡é›†æ›´æ–° <code>s[e := 0]</code> ä¼šäº§ç”Ÿç±»ä¼¼ <code>s</code> çš„å¤šé‡é›†ï¼Œä½†ä¸ä¼šå‡ºç°ä»»ä½• <code>e</code>ï¼ˆæ— è®º <code>s</code> é¦–å…ˆæ˜¯å¦å‡ºç°è¿‡<code>e</code>ï¼‰ã€‚ ä½œä¸ºå¦ä¸€ä¸ªç¤ºä¾‹ï¼Œè¯·æ³¨æ„ <code>s - multiset{e}</code> ç­‰ä»·äºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>if e in s then s[e := s[e] - 1] else s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-2-åºåˆ—"><a href="#_2-2-åºåˆ—" class="header-anchor">#</a> 2.2.â€‚åºåˆ—</h3> <p>å¯¹äºä»»ä½•ç±»å‹â€œTâ€ï¼Œâ€œseqã€ˆTã€‰â€ç±»å‹çš„å€¼è¡¨ç¤ºâ€œTâ€å…ƒç´ çš„<em>åºåˆ—</em>ï¼Œå³ä»è¿ç»­è‡ªç„¶æ•°çš„æœ‰é™é›†åˆï¼ˆç§°ä¸º<em>indicies</em>ï¼‰åˆ°â€œTâ€çš„æ˜ å°„ `ä»·å€¼è§‚ã€‚ ï¼ˆå°†å…¶è§†ä¸ºä¸€ä¸ªæ˜ å°„ï¼Œå› æ­¤åºåˆ—æ˜¯å¤šé‡é›†çš„å¯¹å¶ã€‚ï¼‰å¯ä»¥ä½¿ç”¨ <em>sequence display</em> è¡¨è¾¾å¼å½¢æˆåºåˆ—ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½æ˜¯ä¸€ä¸ªåŒ…å«åœ¨æ–¹æ‹¬å·ä¸­çš„ç©ºçš„ã€æœ‰åºçš„è¡¨è¾¾å¼åˆ—è¡¨ã€‚ ä¸ºäº†é˜é‡Šï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>[]        [3, 1, 4, 1, 5, 9, 3]        [4+2, 1+5, a*b]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ˜¯é¡ºåºæ˜¾ç¤ºçš„ä¸‰ä¸ªç¤ºä¾‹ã€‚ æ²¡æœ‰åºåˆ—ç†è§£è¡¨è¾¾å¼ã€‚
é™¤äº†ç›¸ç­‰å’Œä¸ç›¸ç­‰ä¹‹å¤–ï¼Œåºåˆ—ç±»å‹è¿˜æ”¯æŒä»¥ä¸‹å…³ç³»è¿ç®—ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>&lt;</td> <td>çœŸå‰ç¼€</td></tr> <tr><td><code>&lt;=</code></td> <td>å‰ç¼€</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>ä¸ç®—æœ¯å…³ç³»è¿ç®—ç¬¦ä¸€æ ·ï¼Œè¿™â€‹â€‹äº›è¿ç®—ç¬¦æ˜¯é“¾æ¥çš„ã€‚ æ³¨æ„æ²¡æœ‰<code>&gt;</code>å’Œ<code>&gt;=</code>ã€‚
åºåˆ—æ”¯æŒä»¥ä¸‹äºŒå…ƒè¿ç®—ç¬¦ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>æ“ä½œç¬¦</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>+</code></td> <td>è¿æ¥</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>è¿ç®—ç¬¦ <code>+</code> æ˜¯å…³è”çš„ï¼Œå°±åƒåŒåçš„ç®—æœ¯è¿ç®—ç¬¦ä¸€æ ·ã€‚
æ­¤å¤–ï¼Œå¯¹äºä»»ä½•ç±»å‹ä¸ºâ€œseqã€ˆTã€‰â€çš„åºåˆ—â€œsâ€ï¼Œç±»å‹ä¸ºâ€œTâ€çš„è¡¨è¾¾å¼â€œeâ€ï¼ŒåŸºäºæ•´æ•°çš„æ•°å­—â€œiâ€æ»¡è¶³â€œ0 &lt;= i &lt; |s|â€ï¼Œä»¥åŠæ•´æ•°- åŸºäºæ•°å­— <code>lo</code> å’Œ <code>hi</code> æ»¡è¶³ <code>0 &lt;= lo &lt;= hi &lt;= |s|</code>ï¼Œåºåˆ—æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è¡¨è¾¾å¼</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>|s|</td> <td>åºåˆ—é•¿åº¦</td></tr> <tr><td><code>s[i]</code></td> <td>åºåˆ—é€‰æ‹©</td></tr> <tr><td><code>s[i := e]</code></td> <td>åºåˆ—æ›´æ–°</td></tr> <tr><td><code>e in s</code></td> <td>åºåˆ—æˆå‘˜</td></tr> <tr><td><code>e !in s</code></td> <td>åºåˆ—éæˆå‘˜</td></tr> <tr><td><code>s[lo..hi]</code></td> <td>å­åºåˆ—</td></tr> <tr><td><code>s[lo..]</code></td> <td>drop</td></tr> <tr><td><code>s[..hi]</code></td> <td>take</td></tr> <tr><td><code>s[*slices*]</code></td> <td>åˆ‡ç‰‡</td></tr> <tr><td><code>multiset(s)</code></td> <td>åºåˆ—è½¬æ¢ä¸º <code>multisetâŒ©TâŒª</code></td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>è¡¨è¾¾å¼ <code>s[i := e]</code> è¿”å›ä¸€ä¸ªç±»ä¼¼ <code>s</code> çš„åºåˆ—ï¼Œé™¤äº†ç´¢å¼• <code>i</code> å¤„çš„å…ƒç´ æ˜¯ <code>e</code>ã€‚ è¡¨è¾¾å¼ <code>e in s</code> è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªç´¢å¼• <code>i</code> ä½¿å¾— <code>s[i] == e</code>ã€‚ ä»…å½“å…ƒç´ ç±»å‹â€œTâ€æ”¯æŒç›¸ç­‰æ—¶ï¼Œæ‰å…è®¸åœ¨éå¹½çµä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚ è¡¨è¾¾å¼ <code>e !in s</code> æ˜¯ <code>!(e in s)</code> çš„è¯­æ³•ç®€å†™ã€‚</p> <p>è¡¨è¾¾å¼ <code>s[lo..hi]</code> äº§ç”Ÿä¸€ä¸ªåºåˆ—ï¼Œè¯¥åºåˆ—é€šè¿‡è·å–ç¬¬ä¸€ä¸ª <code>hi</code> å…ƒç´ ç„¶ååˆ é™¤ç¬¬ä¸€ä¸ª <code>lo</code> å…ƒç´ è€Œå½¢æˆã€‚ å› æ­¤ï¼Œç»“æœåºåˆ—çš„é•¿åº¦ä¸ºâ€œhi - loâ€ã€‚ è¯·æ³¨æ„ï¼Œ<code>s[0..|s|]</code> ç­‰äº <code>s</code>ã€‚ å¦‚æœçœç•¥ä¸Šé™ï¼Œåˆ™é»˜è®¤ä¸º <code>|s|</code>ï¼Œå› æ­¤ <code>s[lo..]</code> ä¼šç”Ÿæˆé€šè¿‡åˆ é™¤ <code>s</code> çš„ç¬¬ä¸€ä¸ª <code>lo</code> å…ƒç´ å½¢æˆçš„åºåˆ—ã€‚ å¦‚æœçœç•¥ä¸‹é™ï¼Œåˆ™é»˜è®¤ä¸º 0ï¼Œå› æ­¤ s[..hi] äº§ç”Ÿç”± s çš„ç¬¬ä¸€ä¸ª hi å…ƒç´ å½¢æˆçš„åºåˆ—ã€‚</p> <p>åœ¨åºåˆ—åˆ‡ç‰‡æ“ä½œä¸­ï¼Œ<em>slices</em> æ˜¯ä¸€ä¸ªé•¿åº¦æŒ‡ç¤ºç¬¦çš„éç©ºåˆ—è¡¨ï¼Œç”±å†’å·åˆ†éš”å¹¶å¯é€‰åœ°ç»ˆæ­¢ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªå†’å·ã€‚ æ¯ä¸ªé•¿åº¦æŒ‡ç¤ºç¬¦éƒ½æ˜¯ä¸€ä¸ªåŸºäºéè´Ÿæ•´æ•°çš„æ•°å­—ï¼Œå…¶æ€»å’Œä¸å¤§äº<code>|s|</code>ã€‚ å¦‚æœæœ‰ <em>k</em> ä¸ªå†’å·ï¼Œåˆ™è¯¥æ“ä½œä¼šä» <code>s</code> ç”Ÿæˆ <em>k</em> ä¸ªè¿ç»­å­åºåˆ—ï¼Œæ¯ä¸ªé•¿åº¦ç”±ç›¸åº”çš„é•¿åº¦æŒ‡ç¤ºç¬¦æŒ‡ç¤ºï¼Œå¹¶å°†è¿™äº›ä½œä¸ºåºåˆ—åºåˆ—è¿”å›ã€‚<a href="http://leino.science/papers/krml243.html#fn-fn-slice-into-tuple" target="_blank" rel="noopener noreferrer">1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å¦‚æœ <em>slices</em> ä»¥å†’å·ç»“å°¾ï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªåˆ‡ç‰‡çš„é•¿åº¦ä¼šä¸€ç›´å»¶ä¼¸åˆ° <code>s</code> çš„æœ«å°¾ï¼Œå³ å®ƒçš„é•¿åº¦æ˜¯<code>|s|</code>å‡å»ç»™å®šé•¿åº¦æŒ‡ç¤ºç¬¦çš„æ€»å’Œã€‚ ä¾‹å¦‚ï¼Œå¯¹äºä»»ä½•é•¿åº¦è‡³å°‘ä¸º 10 çš„åºåˆ— s ï¼Œä»¥ä¸‹ç­‰å¼æˆç«‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var t := [3.14, 2.7, 1.41, 1985.44, 100.0, 37.2][1:0:3];
assert |t| == 3 &amp;&amp; t[0] == [3.14] &amp;&amp; t[1] == [];
assert t[2] == [2.7, 1.41, 1985.44];
var u := [true, false, false, true][1:1:];
assert |u| == 3 &amp;&amp; u[0][0] &amp;&amp; !u[1][0] &amp;&amp; u[2] == [false, true];
assert s[10:][0] == s[..10];
assert s[10:][1] == s[10..];
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æ“ä½œ<code>multiset(s)</code>äº§ç”Ÿåºåˆ—<code>s</code>çš„å…ƒç´ çš„å¤šé‡é›†ã€‚ ä»…å½“å…ƒç´ ç±»å‹â€œTâ€æ”¯æŒç›¸ç­‰æ—¶ï¼Œæ‰å…è®¸åœ¨éå¹½çµä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚</p> <h4 id="_2-2-0-å­—ç¬¦ä¸²"><a href="#_2-2-0-å­—ç¬¦ä¸²" class="header-anchor">#</a> 2.2.0.â€‚å­—ç¬¦ä¸²</h4> <p>åºåˆ—ç±»å‹çš„ä¸€ä¸ªç‰¹ä¾‹æ˜¯<code>seqã€ˆcharã€‰</code>ï¼ŒDafny æä¾›äº†ä¸€ä¸ªåŒä¹‰è¯ï¼š<code>string</code>ã€‚ å­—ç¬¦ä¸²ä¸å…¶ä»–åºåˆ—ç±»ä¼¼ï¼Œä½†ä¸ºåºåˆ—æ˜¾ç¤ºè¡¨è¾¾å¼æä¾›äº†é¢å¤–çš„è¯­æ³•ï¼Œå³<em>å­—ç¬¦ä¸²æ–‡å­—</em>ã€‚ å­—ç¬¦ä¸²æ–‡å­—æœ‰ä¸¤ç§è¯­æ³•å½¢å¼ï¼š<em>æ ‡å‡†å½¢å¼</em>å’Œ<em>é€å­—å½¢å¼</em>ã€‚</p> <p>æ ‡å‡†å½¢å¼çš„å­—ç¬¦ä¸²æ–‡å­—ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå¦‚ <code>&quot;Dafny&quot;</code>ã€‚ è¦åœ¨è¿™æ ·çš„å­—ç¬¦ä¸²æ–‡å­—ä¸­åŒ…å«åŒå¼•å·ï¼Œå¿…é¡»ä½¿ç”¨è½¬ä¹‰åºåˆ—ã€‚ è½¬ä¹‰åºåˆ—ä¹Ÿå¯ç”¨äºåŒ…å«å…¶ä»–å­—ç¬¦ã€‚ æ”¯æŒçš„è½¬ä¹‰åºåˆ—ä¸å­—ç¬¦æ–‡å­—ç›¸åŒï¼Œè¯·å‚é˜…ç¬¬ [0.2] èŠ‚(http://leino.science/papers/krml243.html#sec-char)ã€‚ ä¾‹å¦‚ï¼ŒDafny è¡¨è¾¾å¼ <code>&quot;say \&quot;yes\&quot;&quot;</code> è¡¨ç¤ºå­—ç¬¦ä¸² say &quot;yes&quot;ã€‚ å•å¼•å·çš„è½¬ä¹‰åºåˆ—æ˜¯å¤šä½™çš„ï¼Œå› ä¸º &quot;'&quot; å’Œ &quot;'&quot; è¡¨ç¤ºç›¸åŒçš„å­—ç¬¦ä¸²â€”â€”æä¾›è¿™ä¸¤ç§å½¢å¼æ˜¯ä¸ºäº†æ”¯æŒä¸å­—ç¬¦æ–‡å­—ç›¸åŒçš„è½¬ä¹‰åºåˆ—ã€‚</p> <p>é€å­—å½¢å¼çš„å­—ç¬¦ä¸²æ–‡å­—ç”¨ @&quot; å’Œ &quot; æ‹¬èµ·æ¥ï¼Œå¦‚ <code>@&quot;Dafny&quot;</code>ã€‚ è¦åœ¨è¿™æ ·çš„å­—ç¬¦ä¸²æ–‡å­—ä¸­åŒ…å«åŒå¼•å·ï¼Œå¿…é¡»ä½¿ç”¨è½¬ä¹‰åºåˆ—â€œâ€ï¼Œå³ä¸¤æ¬¡å†™å…¥å­—ç¬¦ã€‚ åœ¨é€å­—å½¢å¼ä¸­ï¼Œæ²¡æœ‰å…¶ä»–è½¬ä¹‰åºåˆ—ã€‚ ç”šè‡³åƒæ¢è¡Œç¬¦è¿™æ ·çš„å­—ç¬¦ä¹Ÿå¯ä»¥å†™åœ¨å­—ç¬¦ä¸²æ–‡å­—ä¸­ï¼ˆå› æ­¤åœ¨ç¨‹åºæ–‡æœ¬ä¸­è·¨è¶Šå¤šè¡Œï¼‰ã€‚
ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¸‰ä¸ªè¡¨è¾¾å¼è¡¨ç¤ºç›¸åŒçš„å­—ç¬¦ä¸²ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>&quot;C:\\tmp.txt&quot;
@&quot;C:\tmp.txt&quot;
['C', ':', '\\', 't', 'm', 'p', '.', 't', 'x', 't']
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>ç”±äºå­—ç¬¦ä¸²æ˜¯åºåˆ—ï¼Œå› æ­¤åœ¨å®ƒä»¬ä¸Šå®šä¹‰äº†å…³ç³»è¿ç®—ç¬¦ &lt; å’Œ <code>&lt;=</code>ã€‚ ä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™äº›è¿ç®—ç¬¦ä»ç„¶åˆ†åˆ«è¡¨ç¤ºæ­£ç¡®çš„å‰ç¼€å’Œå‰ç¼€ï¼Œè€Œä¸æ˜¯å¯èƒ½éœ€è¦çš„æŸç§å­—æ¯æ¯”è¾ƒï¼Œä¾‹å¦‚ï¼Œåœ¨å¯¹å­—ç¬¦ä¸²è¿›è¡Œæ’åºæ—¶ã€‚</p> <h3 id="_2-3-æœ‰é™ä¸æ— é™å›¾"><a href="#_2-3-æœ‰é™ä¸æ— é™å›¾" class="header-anchor">#</a> 2.3.â€‚æœ‰é™ä¸æ— é™å›¾</h3> <p>å¯¹äºä»»ä½•ç±»å‹<code>T</code>å’Œ<code>U</code>ï¼Œ<code>mapã€ˆTï¼ŒUã€‰</code>ç±»å‹çš„å€¼è¡¨ç¤ºä»<code>T</code>åˆ°<code>U</code>çš„*ï¼ˆæœ‰é™ï¼‰æ˜ å°„*ã€‚ æ¢å¥è¯è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªç”±<code>T</code>ç´¢å¼•çš„æŸ¥æ‰¾è¡¨ã€‚ åœ°å›¾çš„ <em>domain</em> æ˜¯ä¸€ç»„æœ‰é™çš„ <code>T</code> å€¼ï¼Œå®ƒä»¬å…·æœ‰å…³è”çš„ <code>U</code> å€¼ã€‚ ç”±äºåŸŸä¸­çš„é”®æ˜¯ä½¿ç”¨ <code>T</code> ç±»å‹ä¸­çš„ç›¸ç­‰æ€§è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå› æ­¤åªæœ‰å½“<code>T</code> æ”¯æŒç›¸ç­‰æ€§æ—¶ï¼Œç±»å‹<code>mapã€ˆT,Uã€‰</code> æ‰èƒ½åœ¨éå¹½çµä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚</p> <p>ç±»ä¼¼åœ°ï¼Œå¯¹äºä»»ä½•ç±»å‹ <code>T</code> å’Œ <code>U</code>ï¼Œ<code>imapâŸ¨T,UâŸ©</code> ç±»å‹çš„å€¼è¡¨ç¤º*ï¼ˆå¯èƒ½ï¼‰æ— é™æ˜ å°„*ã€‚ åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ<code>imap&lt;T,U&gt;</code> ç±»ä¼¼äº <code>map&lt;T,U&gt;</code>ï¼Œä½†æ˜¯ <code>imap&lt;T,U&gt;</code> ç±»å‹çš„æ˜ å°„å…è®¸æœ‰ä¸€ä¸ªæ— é™åŸŸã€‚</p> <p>å¯ä»¥ä½¿ç”¨ <em>map display</em> è¡¨è¾¾å¼å½¢æˆåœ°å›¾ï¼Œè¯¥è¡¨è¾¾å¼å¯èƒ½æ˜¯ä¸€ä¸ªç©ºçš„ã€æœ‰åºçš„ <em>maplets</em> åˆ—è¡¨ï¼Œæ¯ä¸ª maplet å…·æœ‰ <code>t := u</code> çš„å½¢å¼ï¼Œå…¶ä¸­ <code>t</code> æ˜¯ <code>T</code> ç±»å‹çš„è¡¨è¾¾å¼ï¼Œå¹¶ä¸” <code>u</code> æ˜¯<code>U</code> ç±»å‹çš„è¡¨è¾¾å¼ï¼Œæ”¾åœ¨å…³é”®å­—<code>map</code> åé¢çš„æ–¹æ‹¬å·ä¸­ã€‚ ä¸ºäº†æ˜¾ç¤ºï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>map[]    map[20 := true, 3 := false, 20 := false]    map[a+b := c+d]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ˜¯åœ°å›¾æ˜¾ç¤ºçš„ä¸‰ä¸ªç¤ºä¾‹ã€‚ é€šè¿‡ä½¿ç”¨å…³é”®å­— <code>imap</code> è€Œä¸æ˜¯ <code>map</code>ï¼Œç”Ÿæˆçš„åœ°å›¾å°†æ˜¯ <code>imap&lt;T,U&gt;</code> ç±»å‹è€Œä¸æ˜¯ <code>map&lt;T,U&gt;</code>ã€‚ è¯·æ³¨æ„ï¼Œå…è®¸æ— é™æ˜ å°„ (<code>imap</code>) å…·æœ‰æœ‰é™åŸŸï¼Œè€Œä¸å…è®¸æœ‰é™æ˜ å°„ (<code>map</code>) å…·æœ‰æ— é™åŸŸã€‚ å¦‚æœåŒä¸€ä¸ªé”®å‡ºç°å¤šæ¬¡ï¼Œåˆ™ç»“æœæ˜ å°„ä¸­åªå‡ºç°æœ€åä¸€æ¬¡å‡ºç°ã€‚<a href="http://leino.science/papers/krml243.html#fn-fn-map-display" target="_blank" rel="noopener noreferrer">2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è¿˜æœ‰ä¸€ä¸ª * åœ°å›¾ç†è§£è¡¨è¾¾å¼*ï¼Œåœ¨ Dafny è¯­è¨€å‚è€ƒçš„ä¸åŒéƒ¨åˆ†è¿›è¡Œäº†è§£é‡Šã€‚</p> <p>å¯¹äº<code>map&lt;T,U&gt;</code>ç±»å‹çš„ä»»ä½•æ˜ å°„<code>fm</code>ï¼Œ<code>map&lt;T,U&gt;</code>æˆ–<code>imap&lt;T,U&gt;</code>ç±»å‹çš„ä»»ä½•æ˜ å°„<code>m</code>ï¼Œ<code>ç±»å‹</code>çš„ä»»ä½•è¡¨è¾¾å¼<code>t</code> T<code>ï¼Œ</code>U<code>ç±»å‹çš„ä»»ä½•è¡¨è¾¾å¼</code>u<code>ï¼Œä»¥åŠ</code>m<code>åŸŸä¸­çš„ä»»ä½•</code>d<code>ï¼ˆå³æ»¡è¶³</code>d in m`ï¼‰ï¼Œæ˜ å°„æ”¯æŒä»¥ä¸‹æ“ä½œï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è¡¨è¾¾å¼</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td>|fm|</td> <td>åœ°å›¾åŸºæ•°</td></tr> <tr><td><code>m[d]</code></td> <td>åœ°å›¾é€‰æ‹©</td></tr> <tr><td><code>m[t := u]</code></td> <td>åœ°å›¾æ›´æ–°</td></tr> <tr><td><code>t in m</code></td> <td>æ˜ å°„åŸŸæˆå‘˜</td></tr> <tr><td><code>t !in m</code></td> <td>æ˜ å°„åŸŸéæˆå‘˜</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p><code>|fm|</code> è¡¨ç¤º<code>fm</code> ä¸­çš„æ˜ å°„ä¸ªæ•°ï¼Œå³<code>fm</code> çš„åŸŸçš„åŸºæ•°ã€‚ è¯·æ³¨æ„ï¼Œæ— é™æ˜ å°„ä¸æ”¯æŒåŸºæ•°è¿ç®—ç¬¦ã€‚ è¡¨è¾¾å¼ <code>m[d]</code> è¿”å› <code>m</code> ä¸ <code>d</code> å…³è”çš„ <code>U</code> å€¼ã€‚ è¡¨è¾¾å¼ <code>m[t := u]</code> æ˜¯ä¸€ä¸ªç±»ä¼¼äº <code>m</code> çš„æ˜ å°„ï¼Œé™¤äº†é”® <code>t</code> å¤„çš„å…ƒç´ æ˜¯ <code>u</code>ã€‚</p> <p>è¡¨è¾¾å¼ <code>t in m</code> è¡¨ç¤º <code>t</code> åœ¨ <code>m</code> çš„åŸŸä¸­ï¼Œè€Œ <code>t !in m</code> æ˜¯ <code>!(t in m)</code> çš„è¯­æ³•ç®€å†™ã€‚ <a href="http://leino.science/papers/krml243.html#fn-fn-map-membership" target="_blank" rel="noopener noreferrer">3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> è¿™æ˜¯ä¸€ä¸ªå°ä¾‹å­ï¼Œå…¶ä¸­ç±»å‹ä¸º <code>map&lt;int,real&gt;</code> çš„åœ°å›¾ <code>cache</code> ç”¨äºç¼“å­˜ Joule-Thomson ç³»æ•°çš„è®¡ç®—å€¼ ç»™å®šæ¸©åº¦ä¸‹çš„ä¸€äº›å›ºå®šæ°”ä½“ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>if K in cache {  // check if temperature is in domain of cache
  coeff := cache[K];  // read result in cache
} else {
  coeff := ComputeJouleThomsonCoefficient(K);  // do expensive computation
  cache := cache[K := coeff];  // update the cache
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_3-è±¡å¾ç±»å‹"><a href="#_3-è±¡å¾ç±»å‹" class="header-anchor">#</a> 3.â€‚è±¡å¾ç±»å‹</h2> <p>æœ‰æ—¶é€šè¿‡å¤šä¸ªåç§°äº†è§£ä¸€ä¸ªç±»å‹æˆ–æŠ½è±¡åœ°å¤„ç†ä¸€ä¸ªç±»å‹å¾ˆæœ‰ç”¨ã€‚</p> <h3 id="_3-0-åŒä¹‰è¯ç±»å‹"><a href="#_3-0-åŒä¹‰è¯ç±»å‹" class="header-anchor">#</a> 3.0.â€‚åŒä¹‰è¯ç±»å‹</h3> <p><em>ç±»å‹åŒä¹‰è¯</em>å£°æ˜ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type YâŒ©TâŒª = G
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å£°æ˜ <code>Yã€ˆTã€‰</code> æ˜¯ç±»å‹ <code>G</code> çš„åŒä¹‰è¯ã€‚ è¿™é‡Œï¼Œ<code>T</code> æ˜¯ä¸€ä¸ªç±»å‹å‚æ•°çš„éç©ºåˆ—è¡¨ï¼ˆæ¯ä¸ªå‚æ•°éƒ½å¯é€‰åœ°ç”¨åç¼€â€œ<code>(==)</code>â€æŒ‡å®šï¼‰ï¼Œå®ƒå¯ä»¥ç”¨ä½œ<code>G</code> ä¸­çš„è‡ªç”±ç±»å‹å˜é‡ã€‚ å¦‚æœåŒä¹‰è¯æ²¡æœ‰ç±»å‹å‚æ•°ï¼Œåˆ™åˆ é™¤â€œ<code>ã€ˆTã€‰</code>â€ã€‚ åœ¨æ‰€æœ‰æƒ…å†µä¸‹ï¼Œç±»å‹åŒä¹‰è¯åªæ˜¯åŒä¹‰è¯ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œé™¤äº†å¯èƒ½äº§ç”Ÿçš„é”™è¯¯æ¶ˆæ¯ä¹‹å¤–ï¼Œ<code>Yã€ˆTã€‰</code> å’Œ <code>G</code> ä¹‹é—´ä»æ¥æ²¡æœ‰åŒºåˆ«ã€‚</p> <p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç±»å‹åŒä¹‰è¯çš„åç§°å¯èƒ½ä¼šæé«˜ç¨‹åºçš„å¯è¯»æ€§ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type ReplacementsâŒ©TâŒª = mapâŒ©T,TâŒª
type Vertex = int
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å¦‚ç¬¬ <a href="http://leino.science/papers/krml243.html#sec-string" target="_blank" rel="noopener noreferrer">2.2.0<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> ä¸­æ‰€è¿°ï¼Œ<code>string</code> æ˜¯<code>seqã€ˆcharã€‰</code> çš„å†…ç½®ç±»å‹åŒä¹‰è¯ï¼Œå¥½åƒ å®ƒå°†è¢«å®£å¸ƒå¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type string = seqâŒ©charâŒª
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_3-1-ä¸é€æ˜ç±»å‹"><a href="#_3-1-ä¸é€æ˜ç±»å‹" class="header-anchor">#</a> 3.1.â€‚ä¸é€æ˜ç±»å‹</h3> <p>ç±»å‹åŒä¹‰è¯çš„ä¸€ä¸ªç‰¹ä¾‹æ˜¯æœªæŒ‡å®šçš„ã€‚ è¿™æ ·çš„ç±»å‹ç®€å•åœ°é€šè¿‡ä»¥ä¸‹æ–¹å¼å£°æ˜ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type YâŒ©TâŒª
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å®ƒè¢«ç§°ä¸º<em>ä¸é€æ˜ç±»å‹</em>ã€‚ å®ƒçš„å®šä¹‰å¯ä»¥åœ¨ç²¾ç‚¼æ¨¡å—ä¸­æ˜¾ç¤ºã€‚ ä¸ºäº†è¡¨æ˜ <code>Y</code> è¡¨ç¤ºæ”¯æŒç›¸ç­‰çš„ç±»å‹ï¼Œå¯ä»¥åœ¨åç§°â€œ<code>Y</code>â€ä¹‹åç´§è·Ÿâ€œ<code>(==)</code>â€ã€‚</p> <p>ä¾‹å¦‚ï¼Œå£°æ˜</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type T
function F(t: T): T
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å¯ç”¨äºåœ¨æŸä¸ªä»»æ„ç±»å‹â€œTâ€ä¸Šå»ºæ¨¡æœªè§£é‡Šçš„å‡½æ•°â€œFâ€ã€‚ ä½œä¸ºå¦ä¸€ä¸ªä¾‹å­ï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>type MonadâŒ©TâŒª
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¯ä»¥æŠ½è±¡åœ°ç”¨äºè¡¨ç¤ºä»»æ„å‚æ•°åŒ–çš„ monadã€‚</p> <h2 id="_4-æ•°æ®ç±»å‹"><a href="#_4-æ•°æ®ç±»å‹" class="header-anchor">#</a> 4.â€‚æ•°æ®ç±»å‹</h2> <p>Dafny æä¾›äº†ä¸¤ç§ä»£æ•°æ•°æ®ç±»å‹ï¼Œä¸€ç§æ˜¯å½’çº³å®šä¹‰çš„ï¼Œå¦ä¸€ç§æ˜¯åå½’çº³å®šä¹‰çš„ã€‚ æ¯ä¸ªæ•°æ®ç±»å‹çš„æ˜¾ç€å±æ€§æ˜¯è¯¥ç±»å‹çš„æ¯ä¸ªå€¼å”¯ä¸€æ ‡è¯†æ•°æ®ç±»å‹çš„æ„é€ å‡½æ•°ä¹‹ä¸€ï¼Œå¹¶ä¸”æ¯ä¸ªæ„é€ å‡½æ•°çš„å‚æ•°éƒ½æ˜¯å•å°„çš„ã€‚</p> <h3 id="_4-0-å½’çº³ç±»å‹"><a href="#_4-0-å½’çº³ç±»å‹" class="header-anchor">#</a> 4.0.â€‚å½’çº³ç±»å‹</h3> <p>å½’çº³æ•°æ®ç±»å‹çš„å€¼å¯ä»¥çœ‹ä½œæ˜¯æœ‰é™æ ‘ï¼Œå…¶ä¸­å¶å­æ˜¯åŸºæœ¬ç±»å‹ã€æ•°å€¼ç±»å‹ã€å¼•ç”¨ç±»å‹ã€å…±å½’çº³æ•°æ®ç±»å‹æˆ–å‡½æ•°ç±»å‹çš„å€¼ã€‚ å®é™…ä¸Šï¼Œå¯ä»¥ä½¿ç”¨ Dafny æœ‰æ ¹æ®çš„ &lt; æ’åºæ¥æ¯”è¾ƒå½’çº³æ•°æ®ç±»å‹çš„å€¼ã€‚</p> <p>å½’çº³æ•°æ®ç±»å‹å£°æ˜å¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype DâŒ©TâŒª = Ctors
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å…¶ä¸­ <code>*Ctors*</code> æ˜¯ä¸€ä¸ªéç©ºçš„ <code>|</code> åˆ†éš”çš„ <em>(datatype) æ„é€ å‡½æ•°</em> çš„æ•°æ®ç±»å‹åˆ—è¡¨ã€‚ æ¯ä¸ªæ„é€ å‡½æ•°éƒ½æœ‰ä»¥ä¸‹å½¢å¼ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>C(params)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å…¶ä¸­ <code>*params*</code> æ˜¯ä¸€ä¸ªé€—å·åˆ†éš”çš„ç±»å‹åˆ—è¡¨ï¼Œå‰é¢å¯é€‰å‚æ•°åç§°å’Œå†’å·ï¼Œå‰é¢å¯é€‰å…³é”®å­— <code>ghost</code>ã€‚ å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰å‚æ•°ï¼Œåˆ™å¯ä»¥çœç•¥æ„é€ å‡½æ•°åç§°åé¢çš„æ‹¬å·ã€‚ å¦‚æœæ²¡æœ‰æ„é€ å‡½æ•°æ¥å—å‚æ•°ï¼Œåˆ™è¯¥ç±»å‹é€šå¸¸ç§°ä¸º<em>æšä¸¾</em>ï¼› ä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype Friends = Agnes | Agatha | Jermaine | Jack
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¯¹äºæ¯ä¸ªæ„é€ å‡½æ•° <code>C</code>ï¼ŒDafny å®šä¹‰äº†ä¸€ä¸ª <em>discriminator</em> <code>C?</code>ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¿”å› <code>true</code> çš„æˆå‘˜ï¼Œå½“ä¸”ä»…å½“æ•°æ®ç±»å‹å€¼æ˜¯ä½¿ç”¨ <code>C</code> æ„é€ çš„ã€‚ å¯¹äºæ„é€ å‡½æ•° <code>C</code> çš„æ¯ä¸ªå‘½åå‚æ•° <code>p</code>ï¼ŒDafny å®šä¹‰äº†ä¸€ä¸ª <em>destructor</em> <code>p</code>ï¼Œå®ƒæ˜¯ä»ç”¨äºæ„é€ æ•°æ®ç±»å‹å€¼çš„ <code>C</code> è°ƒç”¨è¿”å› <code>p</code> å‚æ•°çš„æˆå‘˜ï¼› å®ƒçš„ä½¿ç”¨è¦æ±‚ <code>C?</code> æˆç«‹ã€‚ ä¾‹å¦‚ï¼Œå¯¹äºæ ‡å‡†çš„ <code>List</code> ç±»å‹</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype ListâŒ©TâŒª = Nil | Cons(head: T, tail: ListâŒ©TâŒª)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä»¥ä¸‹æˆç«‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>Cons(5, Nil).Cons? &amp;&amp; Cons(5, Nil).head == 5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ³¨æ„è¡¨è¾¾å¼</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>Cons(5, Nil).tail.head
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ ¼å¼ä¸æ­£ç¡®ï¼Œå› ä¸º <code>Cons(5, Nil).tail</code> ä¸æ»¡è¶³ <code>Cons?</code>ã€‚</p> <p>ææ„å‡½æ•°çš„åç§°åœ¨æ•°æ®ç±»å‹çš„æ‰€æœ‰æ„é€ å‡½æ•°ä¸­å¿…é¡»æ˜¯å”¯ä¸€çš„ã€‚ æ„é€ å‡½æ•°å¯ä»¥ä¸å°é—­æ•°æ®ç±»å‹åŒåï¼› è¿™å¯¹äºé€šå¸¸ç§°ä¸º<em>è®°å½•ç±»å‹</em>çš„å•æ„é€ å‡½æ•°æ•°æ®ç±»å‹ç‰¹åˆ«æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼Œé»‘ç™½åƒç´ çš„è®°å½•ç±»å‹å¯èƒ½è¡¨ç¤ºå¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype Pixel = Pixel(x: int, y: int, on: bool)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¦è°ƒç”¨æ„é€ å‡½æ•°ï¼Œé€šå¸¸åªéœ€è¦æåŠæ„é€ å‡½æ•°çš„åç§°ï¼Œä½†å¦‚æœè¿™ä¸æ˜ç¡®ï¼Œåˆ™å§‹ç»ˆå¯ä»¥é€šè¿‡æ•°æ®ç±»å‹çš„åç§°æ¥é™å®šæ„é€ å‡½æ•°çš„åç§°ã€‚ æ¯”å¦‚ä¸Šé¢çš„<code>Cons(5, Nil)</code>å¯ä»¥å†™æˆ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>List.Cons(5, List.Nil)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä½œä¸ºæ˜¾å¼è°ƒç”¨æ•°æ®ç±»å‹æ„é€ å‡½æ•°çš„æ›¿ä»£æ–¹æ³•ï¼Œå¯ä»¥ä½¿ç”¨ <em>datatype update</em> è¡¨è¾¾å¼å°†æ•°æ®ç±»å‹å€¼æ„é€ ä¸ºä¸€ä¸ªå‚æ•°ä»ç»™å®šæ•°æ®ç±»å‹å€¼çš„å˜åŒ–ã€‚ å¯¹äºä»»ä½•ç±»å‹ä¸ºæ•°æ®ç±»å‹çš„â€œdâ€ï¼Œè¯¥æ•°æ®ç±»å‹åŒ…æ‹¬æ„é€ å‡½æ•°â€œCâ€ï¼Œè¯¥æ„é€ å‡½æ•°å…·æœ‰åä¸ºâ€œfâ€çš„ç±»å‹ä¸ºâ€œTâ€çš„å‚æ•°ï¼ˆææ„å‡½æ•°ï¼‰ï¼Œä»¥åŠä»»ä½•ç±»å‹ä¸ºâ€œTâ€çš„è¡¨è¾¾å¼â€œtâ€ï¼Œ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>d[f := t]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ„é€ ä¸€ä¸ªç±»ä¼¼äº <code>d</code> ä½†å…¶ <code>f</code> å‚æ•°æ˜¯ <code>t</code> çš„å€¼ã€‚ è¯¥æ“ä½œè¦æ±‚ <code>d</code> æ»¡è¶³ <code>C?</code>ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹ç­‰å¼æˆç«‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>Cons(4, Nil)[tail := Cons(3, Nil)] == Cons(4, Cons(3, Nil))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-1-å…ƒç»„ç±»å‹"><a href="#_4-1-å…ƒç»„ç±»å‹" class="header-anchor">#</a> 4.1.â€‚å…ƒç»„ç±»å‹</h3> <p>Dafny æ„å»ºäº†å¯¹åº”äºå…ƒç»„çš„è®°å½•ç±»å‹ï¼Œå¹¶ä¸ºå®ƒä»¬æä¾›äº†ä¸€ç§æ–¹ä¾¿çš„ç‰¹æ®Šè¯­æ³•ï¼Œå³æ‹¬å·ã€‚ ä¾‹å¦‚ï¼Œå¯èƒ½å·²å£°æ˜ä¸ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>datatype PairâŒ©T,UâŒª = Pair(0: T, 1: U)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Dafny æä¾›äº†ç±»å‹ <code>(T, U)</code> å’Œæ„é€ å‡½æ•° <code>(t, u)</code>ï¼Œå¥½åƒæ•°æ®ç±»å‹çš„åç§°æ˜¯â€œâ€ï¼Œå¹¶ä¸”å®ƒçš„ç±»å‹å‚æ•°åœ¨åœ†æ‹¬å·ä¸­ç»™å‡ºï¼Œå¹¶ä¸”å¥½åƒæ„é€ å‡½æ•°åç§°æ˜¯â€œâ€ . è¯·æ³¨æ„ï¼Œææ„å‡½æ•°åç§°æ˜¯â€œ0â€å’Œâ€œ1â€ï¼Œå®ƒä»¬æ˜¯æˆå‘˜çš„åˆæ³•æ ‡è¯†ç¬¦åç§°ã€‚ ä¾‹å¦‚ï¼Œæ˜¾ç¤ºå…ƒç»„ææ„å‡½æ•°çš„ä½¿ç”¨ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªåŒ…å« 2 å…ƒç»„çš„å±æ€§ï¼ˆå³ <em>pairs</em>ï¼‰ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>(5, true).1 == true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Dafny å£°æ˜ <em>n</em> å…ƒç»„ï¼Œå…¶ä¸­ <em>n</em> ä¸º 0 æˆ– 2 æˆ–æ›´é«˜ã€‚ æ²¡æœ‰ 1 å…ƒç»„ï¼Œå› ä¸ºå›´ç»•å•ä¸ªç±»å‹æˆ–å•ä¸ªå€¼çš„æ‹¬å·æ²¡æœ‰è¯­ä¹‰æ„ä¹‰ã€‚ 0 å…ƒç»„ç±»å‹ <code>()</code> é€šå¸¸è¢«ç§°ä¸º <em>unit ç±»å‹</em>ï¼Œå®ƒçš„å•ä¸ªå€¼ï¼Œä¹Ÿå†™ä½œ <code>()</code>ï¼Œè¢«ç§°ä¸º <em>unit</em>ã€‚</p> <h3 id="_4-2-å…±åŒå½’çº³ç±»å‹"><a href="#_4-2-å…±åŒå½’çº³ç±»å‹" class="header-anchor">#</a> 4.2.â€‚å…±åŒå½’çº³ç±»å‹</h3> <p>å°½ç®¡ Dafny åšæŒè®¤ä¸ºæœ‰ä¸€ç§æ–¹æ³•å¯ä»¥ä»å¤´å¼€å§‹æ„é€ æ¯ä¸ªå½’çº³æ•°æ®ç±»å‹å€¼ï¼Œä½† Dafny è¿˜æ”¯æŒ <em>co-inductive datatypes</em>ï¼Œå…¶æ„é€ å‡½æ•°è¢«å»¶è¿Ÿè¯„ä¼°ï¼Œå› æ­¤å…è®¸æ— é™ç»“æ„ã€‚ ä½¿ç”¨å…³é”®å­—â€œcodatatypeâ€å£°æ˜å…±å½’çº³æ•°æ®ç±»å‹ï¼› é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒåƒå½’çº³æ•°æ®ç±»å‹ä¸€æ ·è¢«å£°æ˜å’Œä½¿ç”¨ã€‚</p> <p>ä¾‹å¦‚,</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>codatatype IListâŒ©TâŒª = Nil | Cons(head: T, tail: IListâŒ©TâŒª)
codatatype StreamâŒ©TâŒª = More(head: T, tail: StreamâŒ©TâŒª)
codatatype TreeâŒ©TâŒª = Node(left: TreeâŒ©TâŒª, value: T, right: TreeâŒ©TâŒª)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>åˆ†åˆ«å£°æ˜å¯èƒ½æ— é™çš„åˆ—è¡¨ï¼ˆå³å¯ä»¥æ˜¯æœ‰é™æˆ–æ— é™çš„åˆ—è¡¨ï¼‰ã€æ— é™æµï¼ˆå³å§‹ç»ˆæ— é™çš„åˆ—è¡¨ï¼‰å’Œæ— é™äºŒå‰æ ‘ï¼ˆå³æ¯ä¸ªåˆ†æ”¯æ°¸è¿œå­˜åœ¨çš„æ ‘ï¼‰ã€‚</p> <h2 id="_5-å‚ç…§ç±»å‹"><a href="#_5-å‚ç…§ç±»å‹" class="header-anchor">#</a> 5.â€‚å‚ç…§ç±»å‹</h2> <p>Dafny æä¾›äº†è®¸å¤š<em>å‚è€ƒç±»å‹</em>ã€‚ è¿™äº›ä»£è¡¨å¯¹ç¨‹åºå †ä¸­åŠ¨æ€åˆ†é…çš„å¯¹è±¡çš„<em>å¼•ç”¨</em>ã€‚ è¦è®¿é—®å¯¹è±¡çš„æˆå‘˜ï¼Œå¯¹å¯¹è±¡çš„å¼•ç”¨ï¼ˆå³<em>æŒ‡é’ˆ</em> æˆ–<em>å¯¹è±¡æ ‡è¯†</em>ï¼‰è¢«<em>å–æ¶ˆå¼•ç”¨</em>ã€‚</p> <p>ç‰¹æ®Šå€¼ <code>null</code> æ˜¯æ¯ä¸ªå¼•ç”¨ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚<a href="http://leino.science/papers/krml243.html#fn-fn-nullable" target="_blank" rel="noopener noreferrer">4<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_5-0-ç±»"><a href="#_5-0-ç±»" class="header-anchor">#</a> 5.0.â€‚ç±»</h3> <p><em>class</em> <code>C</code> æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œå£°æ˜å¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>class CâŒ©TâŒª extends J
{
  members
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å…¶ä¸­ç±»å‹å‚æ•°åˆ—è¡¨<code>T</code>æ˜¯å¯é€‰çš„ï¼Œâ€œ<code>extends J</code>â€ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå®ƒè¡¨ç¤ºè¯¥ç±»æ‰©å±•äº†ä¸€ä¸ªç‰¹å¾â€œJâ€ã€‚ ç±»çš„æˆå‘˜æ˜¯ <em>fields</em>ã€<em>functions</em> å’Œ <em>methods</em>ã€‚ è¿™äº›æ˜¯é€šè¿‡å–æ¶ˆå¼•ç”¨å¯¹â€œCâ€å®ä¾‹çš„å¼•ç”¨æ¥è®¿é—®æˆ–è°ƒç”¨çš„ã€‚ é™¤éå‡½æ•°æˆ–æ–¹æ³•å£°æ˜ä¸º <code>static</code>ï¼Œå¦åˆ™å‡½æ•°æˆ–æ–¹æ³•ä¼šåœ¨ <code>C</code> çš„ <em>instance</em> ä¸Šè°ƒç”¨ã€‚ æœºæ¢°åœ°ï¼Œè¿™åªæ˜¯æ„å‘³ç€è¯¥æ–¹æ³•é‡‡ç”¨éšå¼ <em>receiver</em> å‚æ•°ï¼Œå³ç”¨äºè®¿é—®æˆå‘˜çš„å®ä¾‹ã€‚ åœ¨å®ä¾‹å‡½æ•°æˆ–æ–¹æ³•çš„è§„èŒƒå’Œä¸»ä½“ä¸­ï¼Œæ¥æ”¶å™¨å‚æ•°å¯ä»¥é€šè¿‡å…³é”®å­— <code>this</code> æ˜¾å¼å¼•ç”¨ã€‚ ä½†æ˜¯ï¼Œåœ¨è¿™æ ·çš„åœ°æ–¹ï¼Œ<code>this</code>çš„æˆå‘˜ä¹Ÿå¯ä»¥æ— æ¡ä»¶åœ°è¢«æåŠã€‚ ä¸ºäº†è¯´æ˜ï¼Œåˆæ ¼çš„ <code>this.f</code> å’Œä¸åˆæ ¼çš„ <code>f</code> åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­æŒ‡çš„æ˜¯åŒä¸€å¯¹è±¡çš„åŒä¸€å­—æ®µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>class C {
  var f: int;
  method Example() returns (b: bool)
  {
    b := f == this.f;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>æ‰€ä»¥æ–¹æ³•ä½“æ€»æ˜¯å°† <code>true</code> åˆ†é…ç»™è¾“å‡ºå‚æ•° <code>b</code>ã€‚ å¯¹åŒä¸€æ¥æ”¶è€…å’Œæˆå‘˜çš„åˆæ ¼å’Œä¸åˆæ ¼è®¿é—®ä¹‹é—´æ²¡æœ‰è¯­ä¹‰å·®å¼‚ã€‚</p> <p>ä¸€ä¸ª <code>C</code> å®ä¾‹æ˜¯ä½¿ç”¨ <code>new</code> åˆ›å»ºçš„ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>c := new C;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¯·æ³¨æ„ï¼Œ<code>new</code> åªæ˜¯åˆ†é…ä¸€ä¸ª <code>C</code> å¯¹è±¡å¹¶è¿”å›å¯¹å®ƒçš„å¼•ç”¨ï¼› å…¶å­—æ®µçš„åˆå§‹å€¼æ˜¯å®ƒä»¬å„è‡ªç±»å‹çš„ä»»æ„å€¼ã€‚ å› æ­¤ï¼Œé€šå¸¸åœ¨åˆ›å»ºåç«‹å³è°ƒç”¨ç§°ä¸º <em>initialization method</em> çš„æ–¹æ³•ï¼Œä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>c := new C;
c.InitFromList(xs, 3);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>å½“åˆå§‹åŒ–æ–¹æ³•æ²¡æœ‰out-parameterå¹¶ä¸”ä¿®æ”¹ä¸è¶…è¿‡<code>this</code>æ—¶ï¼Œé‚£ä¹ˆä¸Šé¢çš„ä¸¤ä¸ªè¯­å¥å¯ä»¥åˆå¹¶ä¸ºä¸€ä¸ªï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>c := new C.InitFromList(xs, 3);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¯·æ³¨æ„ï¼Œä¸€ä¸ªç±»å¯ä»¥åŒ…å«å¤šä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥éšæ—¶è°ƒç”¨ï¼Œè€Œä¸ä»…ä»…æ˜¯ä½œä¸º<code>new</code>çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”<code>new</code>ä¸éœ€è¦åœ¨åˆ›å»ºæ—¶è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•ã€‚</p> <p>è¦ç¼–å†™ç»“æ„åŒ–çš„é¢å‘å¯¹è±¡ç¨‹åºï¼Œé€šå¸¸ä¾èµ–äºä»…ä»¥ç‰¹å®šæ–¹å¼æ„é€ å¯¹è±¡ã€‚ ä¸ºæ­¤ï¼ŒDafny æä¾›äº† <em>constructor (method)s</em>ï¼Œè¿™æ˜¯ä¸€ç§å—é™å½¢å¼çš„åˆå§‹åŒ–æ–¹æ³•ã€‚ æ„é€ å‡½æ•°æ˜¯ç”¨å…³é”®å­—<code>constructor</code>è€Œä¸æ˜¯<code>method</code>å£°æ˜çš„ã€‚ å½“ä¸€ä¸ªç±»åŒ…å«æ„é€ å‡½æ•°æ—¶ï¼Œå¯¹è¯¥ç±»çš„æ¯æ¬¡è°ƒç”¨ <code>new</code> éƒ½å¿…é¡»ä¼´éšå¯¹æ„é€ å‡½æ•°ä¹‹ä¸€çš„è°ƒç”¨ã€‚ æ­¤å¤–ï¼Œä¸èƒ½åœ¨å…¶ä»–æ—¶é—´è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåªèƒ½åœ¨å¯¹è±¡åˆ›å»ºæœŸé—´è°ƒç”¨ã€‚ é™¤äº†è¿™äº›é™åˆ¶ä¹‹å¤–ï¼Œä½¿ç”¨æ™®é€šåˆå§‹åŒ–æ–¹æ³•å’Œä½¿ç”¨æ„é€ å‡½æ•°ä¹‹é—´æ²¡æœ‰è¯­ä¹‰ä¸Šçš„åŒºåˆ«ã€‚</p> <p>Dafny è®¾è®¡å…è®¸å‘½åæ„é€ å‡½æ•°ï¼Œè¿™ä¿ƒè¿›äº†ä½¿ç”¨ä¸Šé¢çš„â€œInitFromListâ€ä¹‹ç±»çš„åç§°ã€‚ å°½ç®¡å¦‚æ­¤ï¼Œè®¸å¤šç±»åªæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°æˆ–æœ‰ä¸€ä¸ªå…¸å‹çš„æ„é€ å‡½æ•°ã€‚ å› æ­¤ï¼ŒDafny å…è®¸ä¸€ä¸ª<em>åŒ¿åæ„é€ å‡½æ•°</em>ï¼Œå³åç§°æœ¬è´¨ä¸Šæ˜¯â€œâ€çš„æ„é€ å‡½æ•°ã€‚ ä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>class Item {
  constructor (x: int, y: int)
  // ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è°ƒç”¨æ­¤æ„é€ å‡½æ•°æ—¶ï¼Œä¼šåˆ é™¤â€œ<code>.</code>â€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>m := new Item(45, 29);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¯·æ³¨æ„ï¼ŒåŒ¿åæ„é€ å‡½æ•°åªæ˜¯å‘½åæ„é€ å‡½æ•°çš„ä¸€ç§æ–¹å¼ï¼› ä¹Ÿå¯ä»¥æœ‰å…¶ä»–æ„é€ å‡½æ•°ã€‚</p> <h3 id="_5-1-æ•°ç»„"><a href="#_5-1-æ•°ç»„" class="header-anchor">#</a> 5.1.â€‚æ•°ç»„</h3> <p>Dafny æ”¯æŒä»»ä½•æ­£ç»´åº¦çš„å¯å˜å›ºå®šé•¿åº¦<em>æ•°ç»„ç±»å‹</em>ã€‚ æ•°ç»„ç±»å‹æ˜¯å¼•ç”¨ç±»å‹ã€‚</p> <h4 id="_5-1-0-ä¸€ç»´æ•°ç»„"><a href="#_5-1-0-ä¸€ç»´æ•°ç»„" class="header-anchor">#</a> 5.1.0.â€‚ä¸€ç»´æ•°ç»„</h4> <p><code>n</code> <code>T</code> å…ƒç´ çš„ä¸€ç»´æ•°ç»„åˆ›å»ºå¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a := new T[n];
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ•°ç»„å…ƒç´ çš„åˆå§‹å€¼æ˜¯â€œTâ€ç±»å‹çš„ä»»æ„å€¼ã€‚ ä½¿ç”¨ä¸å¯å˜çš„ <code>Length</code> æˆå‘˜æ£€ç´¢æ•°ç»„çš„é•¿åº¦ã€‚ ä¾‹å¦‚ä¸Šé¢åˆ†é…çš„æ•°ç»„æ»¡è¶³ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a.Length == n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¯¹äº <code>0 &lt;= i &lt; a.Length</code> èŒƒå›´å†…çš„ä»»ä½•åŸºäºæ•´æ•°çš„æ•°å­— <code>i</code>ï¼Œ<em>array selection</em> è¡¨è¾¾å¼ <code>a[i]</code> æ£€ç´¢å…ƒç´  <code>i</code>ï¼ˆå³ï¼Œå‰é¢æœ‰ <code>i</code> æ•°ç»„ä¸­çš„å…ƒç´ ï¼‰ã€‚ å¯ä»¥ä½¿ç”¨æ•°ç»„æ›´æ–°è¯­å¥å°†å­˜å‚¨åœ¨ <code>i</code> çš„å…ƒç´ æ›´æ”¹ä¸ºå€¼ <code>t</code>ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a[i] := t;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è­¦å‘Šï¼šç”±<code>new T[n]</code>åˆ›å»ºçš„æ•°ç»„ç±»å‹æ˜¯<code>arrayã€ˆTã€‰</code>ã€‚ ä¸€ä¸ªå®¹æ˜“çŠ¯çš„é”™è¯¯æ˜¯åœ¨ <code>new</code> åé¢å†™ <code>array&lt;T&gt;</code> è€Œä¸æ˜¯ <code>T</code>ã€‚ ä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var a := new arrayâŒ©TâŒª;
var b := new arrayâŒ©TâŒª[n];
var c := new arrayâŒ©TâŒª(n);  // resolution error
var d := new array(n);  // resolution error
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ç¬¬ä¸€æ¡è¯­å¥åˆ†é…äº†ä¸€ä¸ªç±»å‹ä¸º <code>arrayã€ˆTã€‰ çš„æ•°ç»„ï¼Œä½†é•¿åº¦æœªçŸ¥ã€‚ ç¬¬äºŒä¸ªåˆ†é…ä¸€ä¸ªé•¿åº¦ä¸ºâ€œnâ€çš„â€œarrayã€ˆarrayã€ˆTã€‰ã€‰â€ç±»å‹çš„æ•°ç»„ï¼Œå³ä¸€ä¸ªåŒ…å«â€œnâ€ç±»å‹çš„â€œarrayã€ˆTã€‰â€å€¼çš„æ•°ç»„ã€‚ ç¬¬ä¸‰æ¡è¯­å¥åˆ†é…ä¸€ä¸ªç±»å‹ä¸º</code>arrayã€ˆTã€‰<code>çš„æ•°ç»„ï¼Œç„¶åå°è¯•è°ƒç”¨è¿™ä¸ªæ•°ç»„çš„åŒ¿åæ„é€ å‡½æ•°ï¼Œä¼ é€’å‚æ•°</code>n<code>ã€‚ ç”±äº</code>array<code>æ²¡æœ‰æ„é€ å‡½æ•°ï¼Œæ›´ä¸ç”¨è¯´åŒ¿åæ„é€ å‡½æ•°äº†ï¼Œè¿™ä¸ªè¯­å¥ä¼šäº§ç”Ÿé”™è¯¯ã€‚ å¦‚æœå¯¹äºéœ€è¦ç±»å‹å‚æ•°çš„ç±»å‹çœç•¥äº†ç±»å‹å‚æ•°åˆ—è¡¨ï¼ŒDafny å°†å°è¯•å¡«å†™è¿™äº›ï¼Œå› æ­¤åªè¦å¯ä»¥æ¨æ–­å‡º</code>array<code>ç±»å‹å‚æ•°ï¼Œå°±å¯ä»¥çœç•¥â€œ</code>ã€ˆTã€‰ <code>â€ åœ¨ä¸Šé¢çš„ç¬¬å››ä¸ªè¯­å¥ä¸­ã€‚ ä½†æ˜¯ï¼Œä¸ç¬¬ä¸‰æ¡è¯­å¥ä¸€æ ·ï¼Œ</code>array` æ²¡æœ‰åŒ¿åæ„é€ å‡½æ•°ï¼Œå› æ­¤ä¼šç”Ÿæˆé”™è¯¯æ¶ˆæ¯ã€‚</p> <p>ä¸€ç»´æ•°ç»„æ”¯æŒå°†ä¸€ç³»åˆ—è¿ç»­å…ƒç´ è½¬æ¢ä¸ºåºåˆ—çš„æ“ä½œã€‚ å¯¹äºä»»ä½•ç±»å‹ä¸º<code>arrayã€ˆTã€‰</code>çš„æ•°ç»„<code>a</code>ï¼ŒåŸºäºæ•´æ•°çš„æ•°å­—<code>lo</code>å’Œ<code>hi</code>æ»¡è¶³<code>0 &lt;= lo &lt;= hi &lt;= a.Length</code>ï¼Œä»¥ä¸‹æ“ä½œå„è‡ªäº§ç”Ÿä¸€ä¸ª<code>seq ã€ˆTã€‰</code>ï¼š</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td>è¡¨è¾¾å¼</td> <td>æè¿°</td></tr> <tr><td></td> <td></td></tr> <tr><td><code>a[lo..hi]</code></td> <td>å­æ•°ç»„è½¬ä¸ºåºåˆ—</td></tr> <tr><td><code>a[lo..]</code></td> <td>drop</td></tr> <tr><td><code>a[..hi]</code></td> <td>take</td></tr> <tr><td><code>a[..]</code></td> <td>æ•°ç»„è½¬æ¢ä¸ºåºåˆ—</td></tr> <tr><td></td> <td></td></tr></tbody></table> <p>è¡¨è¾¾å¼ <code>a[lo..hi]</code> è·å–æ•°ç»„çš„ç¬¬ä¸€ä¸ª <code>hi</code> å…ƒç´ ï¼Œç„¶ååˆ é™¤å…¶ä¸­çš„ç¬¬ä¸€ä¸ª <code>lo</code> å…ƒç´ å¹¶è¿”å›å‰©ä½™çš„åºåˆ—ã€‚ å› æ­¤ï¼Œç»“æœåºåˆ—çš„é•¿åº¦ä¸ºâ€œhi - loâ€ã€‚ å…¶ä»–æ“ä½œæ˜¯ç¬¬ä¸€ä¸ªæ“ä½œçš„ç‰¹æ®Šå®ä¾‹ã€‚ å¦‚æœçœç•¥ <code>lo</code>ï¼Œåˆ™é»˜è®¤ä¸º <code>0</code>ï¼Œå¦‚æœçœç•¥ <code>hi</code>ï¼Œåˆ™é»˜è®¤ä¸º <code>a.Length</code>ã€‚ åœ¨æœ€åä¸€ä¸ªæ“ä½œä¸­ï¼Œ<code>lo</code> å’Œ <code>hi</code> éƒ½è¢«çœç•¥äº†ï¼Œå› æ­¤ <code>a[..]</code> è¿”å›ç”± <code>a</code> çš„æ‰€æœ‰æ•°ç»„å…ƒç´ ç»„æˆçš„åºåˆ—ã€‚</p> <p>å­æ•°ç»„æ“ä½œåœ¨è§„èŒƒä¸­ç‰¹åˆ«æœ‰ç”¨ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨å˜é‡â€œloâ€å’Œâ€œhiâ€æ¥åˆ’åˆ†ä»ç„¶å¯ä»¥æ‰¾åˆ°æœç´¢â€œkeyâ€çš„å­æ•°ç»„çš„äºŒåˆ†æœç´¢ç®—æ³•çš„å¾ªç¯ä¸å˜é‡å¯ä»¥è¡¨ç¤ºå¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>key !in a[..lo] &amp;&amp; key !in a[hi..]
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦ä¸€ä¸ªç”¨é€”æ˜¯è¯´æŸä¸ªèŒƒå›´çš„æ•°ç»„å…ƒç´ è‡ªæ–¹æ³•å¼€å§‹ä»¥æ¥æ²¡æœ‰æ”¹å˜ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>a[lo..hi] == old(a[lo..hi])
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æˆ–ä»å¾ªç¯å¼€å§‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>ghost var prevElements := a[..];
while // ...
  invariant a[lo..hi] == prevElements[lo..hi];
{
  // ...
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>æ³¨æ„è¿™ä¸ªä¾‹å­ä¸­çš„<code>prevElements</code>çš„ç±»å‹æ˜¯<code>seq&lt;T&gt;</code>ï¼Œå¦‚æœ<code>a</code>çš„ç±»å‹æ˜¯<code>array&lt;T&gt;</code>ã€‚</p> <p>å­æ•°ç»„æ“ä½œçš„æœ€åä¸€ä¸ªç¤ºä¾‹åœ¨äºè¡¨ç¤ºæ•°ç»„çš„å…ƒç´ æ˜¯æ–¹æ³•å¼€å¤´çš„æ•°ç»„å…ƒç´ çš„æ’åˆ—ï¼Œå°±åƒåœ¨å¤§å¤šæ•°æ’åºç®—æ³•ä¸­æ‰€åšçš„é‚£æ ·ã€‚ åœ¨è¿™é‡Œï¼Œå­æ•°ç»„æ“ä½œä¸åºåˆ—åˆ°å¤šé›†çš„è½¬æ¢ç›¸ç»“åˆï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>multiset(a[..]) == multiset(old(a[..]))
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-1-1-å¤šç»´æ•°ç»„"><a href="#_5-1-1-å¤šç»´æ•°ç»„" class="header-anchor">#</a> 5.1.1.â€‚å¤šç»´æ•°ç»„</h4> <p>2 ç»´æˆ–æ›´å¤šç»´çš„æ•°ç»„å¤§å¤šç±»ä¼¼äºä¸€ç»´æ•°ç»„ï¼Œä¸åŒä¹‹å¤„åœ¨äº <code>new</code> éœ€è¦æ›´å¤šé•¿åº¦å‚æ•°ï¼ˆæ¯ä¸ªç»´åº¦ä¸€ä¸ªï¼‰ï¼Œå¹¶ä¸”æ•°ç»„é€‰æ‹©è¡¨è¾¾å¼å’Œæ•°ç»„æ›´æ–°è¯­å¥éœ€è¦æ›´å¤šç´¢å¼•ã€‚ ä¾‹å¦‚ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>matrix := new T[m, n];
matrix[i, j], matrix[x, y] := matrix[x, y], matrix[i, j];
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åˆ›å»ºä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œå…¶ç»´åº¦çš„é•¿åº¦åˆ†åˆ«ä¸ºâ€œmâ€å’Œâ€œnâ€ï¼Œç„¶åäº¤æ¢â€œi,jâ€å’Œâ€œx,yâ€å¤„çš„å…ƒç´ ã€‚ <code>matrix</code> çš„ç±»å‹æ˜¯ <code>array2&lt;T&gt;</code>ï¼Œå¯¹äºé«˜ç»´æ•°ç»„ï¼ˆ<code>array3&lt;T&gt;</code>ã€<code>array4&lt;T&gt;</code> ç­‰ï¼‰ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä½†æ˜¯è¯·æ³¨æ„ï¼Œæ²¡æœ‰ç±»å‹ <code>array0&lt;T&gt;</code>ï¼Œæœ¬æ¥å¯ä»¥æ˜¯ <code>array1&lt;T&gt;</code> çš„ä¸œè¥¿å®é™…ä¸Šåªæ˜¯å‘½åä¸º <code>array&lt;T&gt;</code>ã€‚</p> <p>ä¸Šé¢çš„ <code>new</code> æ“ä½œè¦æ±‚ <code>m</code> å’Œ <code>n</code> æ˜¯åŸºäºéè´Ÿæ•´æ•°çš„æ•°å­—ã€‚ å¯ä»¥ä½¿ç”¨ä¸å¯å˜å­—æ®µ <code>Length0</code> å’Œ <code>Length1</code> æ£€ç´¢è¿™äº›é•¿åº¦ã€‚ ä¾‹å¦‚ï¼Œä»¥ä¸‹ä¿å­˜äº†ä¸Šé¢åˆ›å»ºçš„æ•°ç»„ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>matrix.Length0 == m &amp;&amp; matrix.Length1 == n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é«˜ç»´æ•°ç»„ç±»ä¼¼ï¼ˆ<code>Length0</code>ã€<code>Length1</code>ã€<code>Length2</code>ã€...ï¼‰ã€‚ æ•°ç»„é€‰æ‹©è¡¨è¾¾å¼å’Œæ•°ç»„æ›´æ–°è¯­å¥è¦æ±‚ç´¢å¼•åœ¨èŒƒå›´å†…ã€‚ ä¾‹å¦‚ï¼Œä¸Šé¢çš„äº¤æ¢è¯­å¥åªæœ‰åœ¨ä»¥ä¸‹æƒ…å†µä¸‹æ‰æ˜¯æ ¼å¼æ­£ç¡®çš„ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>0 &lt;= i &lt; matrix.Length0 &amp;&amp; 0 &lt;= j &lt; matrix.Length1 &amp;&amp;
0 &lt;= x &lt; matrix.Length0 &amp;&amp; 0 &lt;= y &lt; matrix.Length1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>ä¸ä¸€ç»´æ•°ç»„ç›¸æ¯”ï¼Œæ²¡æœ‰å°†å…ƒç´ çš„å»¶ä¼¸ä»å¤šç»´æ•°ç»„è½¬æ¢ä¸ºåºåˆ—çš„æ“ä½œã€‚</p> <h3 id="_5-2-ç‰¹å¾"><a href="#_5-2-ç‰¹å¾" class="header-anchor">#</a> 5.2.â€‚ç‰¹å¾</h3> <p><em>trait</em> æ˜¯ä¸€ä¸ªâ€œæŠ½è±¡è¶…ç±»â€ï¼Œæˆ–è€…ç§°å®ƒä¸ºâ€œæ¥å£â€æˆ–â€œmixinâ€ã€‚ ç‰¹å¾å¯¹ Dafny æ¥è¯´æ˜¯æ–°çš„ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå‘å±•ä¸€æ®µæ—¶é—´ã€‚
ä¸€ä¸ª trait çš„å£°æ˜å¾ˆåƒä¸€ä¸ªç±»çš„å£°æ˜ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>trait J
{
  members
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>å…¶ä¸­ <code>*members*</code> å¯ä»¥åŒ…å«å­—æ®µã€å‡½æ•°å’Œæ–¹æ³•ï¼Œä½†ä¸èƒ½åŒ…å«æ„é€ å‡½æ•°æ–¹æ³•ã€‚ å…è®¸å°†å‡½æ•°å’Œæ–¹æ³•å£°æ˜ä¸ºâ€œé™æ€â€ã€‚</p> <p>æ‰©å±•ç‰¹å¾â€œJâ€çš„å¼•ç”¨ç±»å‹â€œCâ€å¯ä»¥åˆ†é…ç»™â€œJâ€ï¼Œä½†ä¸èƒ½åè¿‡æ¥ã€‚ <code>J</code> çš„æˆå‘˜å¯ä»¥ä½œä¸º<code>C</code> çš„æˆå‘˜ä½¿ç”¨ã€‚ <code>J</code> ä¸­çš„æˆå‘˜ä¸å…è®¸åœ¨<code>C</code> ä¸­é‡æ–°å£°æ˜ï¼Œé™¤éè¯¥æˆå‘˜æ˜¯åœ¨<code>J</code> ä¸­æ²¡æœ‰ä¸»ä½“çš„é<code>static</code> å‡½æ•°æˆ–æ–¹æ³•ã€‚ é€šè¿‡è¿™æ ·åšï¼Œç±»å‹â€œCâ€å¯ä»¥ä¸ºæˆå‘˜æä¾›æ›´å¼ºå¤§çš„è§„èŒƒå’Œä¸»ä½“ã€‚</p> <p><code>new</code> ä¸å…è®¸ä¸ç‰¹å¾ä¸€èµ·ä½¿ç”¨ã€‚ å› æ­¤ï¼Œæ²¡æœ‰åˆ†é…ç±»å‹æ˜¯ç‰¹å¾çš„å¯¹è±¡ã€‚ ä½†æ˜¯å½“ç„¶å¯ä»¥æœ‰ä¸€ä¸ªç±» C çš„å¯¹è±¡å®ç°äº†ä¸€ä¸ªç‰¹å¾ J ï¼Œå¹¶ä¸”å¯¹è¿™æ ·ä¸€ä¸ª C å¯¹è±¡çš„å¼•ç”¨å¯ä»¥ç”¨ä½œç±»å‹ J çš„å€¼ã€‚</p> <p>ä¾‹å¦‚ï¼Œä»¥ä¸‹ç‰¹å¾è¡¨ç¤ºå¯ç§»åŠ¨çš„å‡ ä½•å½¢çŠ¶ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>trait Shape
{
  function method Width(): real
    reads this
  method Move(dx: real, dy: real)
    modifies this
  method MoveH(dx: real)
    modifies this
  {
    Move(dx, 0.0);
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>æˆå‘˜ <code>Width</code> å’Œ <code>Move</code> æ˜¯ <em>abstract</em> ï¼ˆå³æ— ä¸»ä½“ï¼‰ï¼Œå¹¶ä¸”å¯ä»¥ç”±æ‰©å±• trait çš„ä¸åŒç±»ä»¥ä¸åŒæ–¹å¼å®ç°ã€‚ æ–¹æ³• <code>MoveH</code> çš„å®ç°åœ¨ trait ä¸­ç»™å‡ºï¼Œå› æ­¤è¢«æ‰€æœ‰æ‰©å±• <code>Shape</code> çš„ç±»ä½¿ç”¨ã€‚ è¿™é‡Œæœ‰ä¸¤ä¸ªç±»ï¼Œæ¯ä¸ªç±»éƒ½æ‰©å±•äº†â€œShapeâ€ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>class UnitSquare extends Shape
{
  var x: real, y: real;
  function method Width(): real {  // note the empty reads clause
    1.0
  }
  method Move(dx: real, dy: real)
    modifies this
  {
    x, y := x + dx, y + dy;
  }
}
class LowerRightTriangle extends Shape
{
  var xNW: real, yNW: real, xSE: real, ySE: real;
  function method Width(): real
    reads this
  {
    xSE - xNW
  }
  method Move(dx: real, dy: real)
    modifies this
  {
    xNW, yNW, xSE, ySE := xNW + dx, yNW + dy, xSE + dx, ySE + dy;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>è¯·æ³¨æ„ï¼Œç±»å¯ä»¥å£°æ˜å…¶ä»–æˆå‘˜ï¼Œå®ƒä»¬ä¸ºç‰¹å¾çš„æŠ½è±¡æˆå‘˜æä¾›å®ç°ï¼Œå®ƒä»¬é‡å¤æˆå‘˜ç­¾åï¼Œå¹¶ä¸”å®ƒä»¬è´Ÿè´£æä¾›è‡ªå·±çš„æˆå‘˜è§„èŒƒï¼Œè¿™äº›è§„èŒƒæ—¢åŠ å¼ºäº†ç‰¹å¾ä¸­çš„ç›¸åº”è§„èŒƒï¼Œåˆæ˜¯ å¯¹æä¾›çš„æœºæ„æ„Ÿåˆ°æ»¡æ„ã€‚ æœ€åï¼Œè¿™æ˜¯ä¸€äº›åˆ›å»ºä¸¤ä¸ªç±»å®ä¾‹å¹¶å°†å®ƒä»¬ä¸€èµ·ç”¨ä½œå½¢çŠ¶çš„ä»£ç :</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var myShapes: seqâŒ©ShapeâŒª;
var A := new UnitSquare;
myShapes := [A];
var tri := new LowerRightTriangle;
myShapes := myShapes + [tri];  // myShapes contains two Shape values, of different classes
myShapes[1].MoveH(myShapes[0].Width());  // move shape 1 to the right by the width of shape 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="_5-3-ç±»å‹-object"><a href="#_5-3-ç±»å‹-object" class="header-anchor">#</a> 5.3.â€‚ç±»å‹ <code>object</code></h3> <p>æœ‰ä¸€ä¸ªå†…ç½®çš„å¼•ç”¨ç±»å‹<code>object</code>ï¼Œå®ƒå°±åƒæ‰€æœ‰å¼•ç”¨ç±»å‹çš„è¶…ç±»å‹ã€‚<a href="http://leino.science/papers/krml243.html#fn-fn-object-trait" target="_blank" rel="noopener noreferrer">5<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> type <code>object</code> æ˜¯ä¸ºäº†å¯ç”¨å¯¹<em>åŠ¨æ€å¸§</em>çš„ç»Ÿä¸€å¤„ç†ã€‚ ç‰¹åˆ«æ˜¯ï¼Œä¿ç•™ç±»å‹ä¸º <code>setã€ˆobjectã€‰ çš„å¹½çµå­—æ®µï¼ˆé€šå¸¸å‘½åä¸º</code>Repr` è¡¨ç¤ºâ€œè¡¨ç¤ºâ€ï¼‰å¾ˆæœ‰ç”¨ã€‚</p> <h3 id="_5-4-è¿­ä»£å™¨ç±»å‹"><a href="#_5-4-è¿­ä»£å™¨ç±»å‹" class="header-anchor">#</a> 5.4.â€‚è¿­ä»£å™¨ç±»å‹</h3> <p><em>iterator</em> ä¸ºç¼–å†™è¿­ä»£è¿”å›å…ƒç´ çš„ä»£ç æä¾›äº†ç¼–ç¨‹æŠ½è±¡ã€‚ è¿™äº› CLU é£æ ¼çš„è¿­ä»£å™¨æ˜¯<em>ååŒä¾‹ç¨‹</em>ï¼Œå› ä¸ºå®ƒä»¬è·Ÿè¸ªè‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå¹¶ä¸”æ§åˆ¶å¯ä»¥ä¼ å…¥å’Œä¼ å‡ºè¿­ä»£å™¨ä¸»ä½“ã€‚</p> <p>è¿­ä»£å™¨å£°æ˜å¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>iterator IterâŒ©TâŒª(in-params) yields (yield-params)
  specification
{
  body
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å…¶ä¸­ <code>T</code> æ˜¯ç±»å‹å‚æ•°çš„åˆ—è¡¨ï¼ˆé€šå¸¸ï¼Œå¦‚æœæ²¡æœ‰ç±»å‹å‚æ•°ï¼Œåˆ™çœç•¥â€œ<code>ã€ˆTã€‰</code>â€ï¼‰ã€‚ è¿™ä¸ªå£°æ˜äº§ç”Ÿäº†ä¸€ä¸ªåŒåçš„å¼•ç”¨ç±»å‹ï¼Œ<code>Iterã€ˆTã€‰</code>ã€‚ åœ¨ç­¾åä¸­ï¼Œin-parameters å’Œ yield-parameters æ˜¯è¿­ä»£å™¨å¯¹æ–¹æ³•çš„ in-parameters å’Œ out-parameters çš„æ¨¡æ‹Ÿã€‚ ä¸åŒä¹‹å¤„åœ¨äºï¼Œæ–¹æ³•çš„è¾“å‡ºå‚æ•°åªè¿”å›ç»™è°ƒç”¨è€…ä¸€æ¬¡ï¼Œè€Œè¿­ä»£å™¨çš„ yield å‚æ•°åœ¨è¿­ä»£å™¨ä¸»ä½“æ‰§è¡Œ <code>yield</code> æ—¶è¿”å›ã€‚ è§„èŒƒçš„è¯¦ç»†ä¿¡æ¯åœ¨ Dafny è¯­è¨€å‚è€ƒçš„ä¸åŒéƒ¨åˆ†ä¸­è¿›è¡Œäº†æè¿°ã€‚ ä¸»ä½“ç”±è¯­å¥ç»„æˆï¼Œå°±åƒåœ¨æ–¹æ³•ä¸»ä½“ä¸­ä¸€æ ·ï¼Œä½†ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>yield</code> è¯­å¥ã€‚</p> <p>ä»è¿­ä»£å™¨å®¢æˆ·ç«¯çš„è§’åº¦æ¥çœ‹ï¼Œ<code>iterator</code> å£°æ˜å¯ä»¥ç†è§£ä¸ºç”Ÿæˆå…·æœ‰å„ç§æˆå‘˜çš„ç±»<code>Iterã€ˆTã€‰</code>ï¼Œä¸‹é¢å°†æè¿°å…¶ç®€åŒ–ç‰ˆæœ¬ã€‚</p> <p>`Iterã€ˆTã€‰ ç±»åŒ…å«ä¸€ä¸ªåŒ¿åæ„é€ å‡½æ•°ï¼Œå…¶å‚æ•°æ˜¯è¿­ä»£å™¨çš„å†…å‚æ•°ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>predicate Valid()
constructor (in-params)
  modifies this
  ensures Valid()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>ä½¿ç”¨ <code>new</code> å’Œè¿™ä¸ªåŒ¿åæ„é€ å‡½æ•°åˆ›å»ºäº†ä¸€ä¸ªè¿­ä»£å™¨ã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªæ„¿æ„ä» <code>start</code> è¿”å›åä¸ªè¿ç»­æ•´æ•°çš„è¿­ä»£å™¨å¯ä»¥å£°æ˜å¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>iterator Gen(start: int) yields (x: int)
{
  var i := 0;
  while i &lt; 10 {
    x := start + i;
    yield;
    i := i + 1;
  }
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>è¿™ä¸ªè¿­ä»£å™¨çš„ä¸€ä¸ªå®ä¾‹æ˜¯ä½¿ç”¨ä»¥ä¸‹æ–¹æ³•åˆ›å»ºçš„ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>iter := new Gen(30);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è°“è¯â€œValid()â€è¡¨ç¤ºè¿­ä»£å™¨ä½•æ—¶å¤„äºå¯ä»¥å°è¯•è®¡ç®—æ›´å¤šå…ƒç´ çš„çŠ¶æ€ã€‚ å®ƒæ˜¯æ„é€ å‡½æ•°çš„åç½®æ¡ä»¶ï¼Œå‡ºç°åœ¨â€œMoveNextâ€æˆå‘˜çš„è§„èŒƒä¸­ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>method MoveNext() returns (more: bool)
  requires Valid()
  modifies this
  ensures more ==&gt; Valid()
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>è¯·æ³¨æ„ï¼Œåªè¦ <code>MoveNext</code> è¿”å› <code>true</code>ï¼Œè¿­ä»£å™¨ä»ç„¶æœ‰æ•ˆã€‚ ä¸€æ—¦ <code>MoveNext</code> è¿”å› <code>false</code>ï¼Œå°±ä¸èƒ½å†è°ƒç”¨ <code>MoveNext</code> æ–¹æ³•ã€‚ è¯·æ³¨æ„ï¼Œå®¢æˆ·ç«¯æ²¡æœ‰ä¹‰åŠ¡ç»§ç»­è°ƒç”¨ <code>MoveNext</code> ç›´åˆ°å®ƒè¿”å› <code>false</code>ï¼Œå¹¶ä¸”å…è®¸è¿­ä»£å™¨çš„ä¸»ä½“æ°¸è¿œä¿æŒè¿”å›å…ƒç´ ã€‚</p> <p>è¿­ä»£å™¨çš„è¾“å…¥å‚æ•°å­˜å‚¨åœ¨è¿­ä»£å™¨ç±»çš„ä¸å¯å˜å­—æ®µä¸­ã€‚ ä¸ºäº†æ ¹æ®ä¸Šé¢çš„ç¤ºä¾‹è¿›è¡Œè¯´æ˜ï¼Œè¿­ä»£å™¨ç±»â€œGenâ€åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var start: int;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>äº§é‡å‚æ•°ä¹Ÿå¯¼è‡´è¿­ä»£å™¨çš„æˆå‘˜
class:</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var x: int;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™äº›å­—æ®µç”±â€œMoveNextâ€æ–¹æ³•è®¾ç½®ã€‚ å¦‚æœ <code>MoveNext</code> è¿”å› <code>true</code>ï¼Œåˆ™è¿™äº›å­—æ®µä¸­æä¾›äº†æœ€æ–°çš„æ”¶ç›Šç‡å€¼ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä»é‚£é‡Œè¯»å–å®ƒä»¬ã€‚</p> <p>ä¸ºäº†å¸®åŠ©ç¼–å†™è§„èŒƒï¼Œè¿­ä»£å™¨ç±»è¿˜åŒ…å«ä¿ç•™â€œMoveNextâ€è¿”å›å€¼çš„å†å²è®°å½•çš„å¹½çµæˆå‘˜ã€‚ è¿™äº›å¹½çµå­—æ®µçš„åç§°è·Ÿåœ¨ yield å‚æ•°çš„åç§°ä¹‹åï¼Œå¹¶åœ¨åç§°åé¢é™„åŠ äº†ä¸€ä¸ªâ€œ<code>s</code>â€ï¼ˆè¡¨ç¤ºå¤æ•°ï¼‰ã€‚ åç§°æ£€æŸ¥è§„åˆ™ç¡®ä¿è¿™äº›åç§°ä¸ä¼šå¼•èµ·æ­§ä¹‰ã€‚ å› æ­¤ï¼Œä¸Šè¿°â€œGenâ€çš„è¿­ä»£å™¨ç±»åŒ…å«ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>ghost var xs: seqâŒ©intâŒª;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™äº›å†å²å­—æ®µç”±â€œMoveNextâ€è‡ªåŠ¨æ›´æ”¹ï¼Œä½†ä¸èƒ½ç”±ç”¨æˆ·ä»£ç åˆ†é…ã€‚</p> <p>æœ€åï¼Œè¿­ä»£å™¨ç±»åŒ…å«ä¸€äº›ç”¨äºè§„èŒƒçš„ç‰¹æ®Šå­—æ®µã€‚ ç‰¹åˆ«æ˜¯ï¼Œè¿­ä»£å™¨è§„èŒƒè®°å½•åœ¨ä»¥ä¸‹ä¸å¯å˜å­—æ®µä¸­ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>ghost var _reads: setâŒ©objectâŒª;
ghost var _modifies: setâŒ©objectâŒª;
ghost var _decreases0: T0;
ghost var _decreases1: T1;
// ...
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å…¶ä¸­ï¼Œè¿­ä»£å™¨çš„ <code>decreases</code> å­å¥çš„æ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ª <code>_decreases*i*: T*i*</code> å­—æ®µã€‚ [6](http://leino.science/papers/krml243.html#fn-fn-iterator -field-names) å¦å¤–è¿˜æœ‰ä¸€ä¸ªå­—æ®µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>ghost var _new: setâŒ©objectâŒª;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä»£è¡¨è¿­ä»£å™¨ä¸»ä½“åˆ†é…çš„ä»»ä½•å¯¹è±¡éƒ½å°†æ·»åŠ åˆ°å…¶ä¸­ã€‚ è¿­ä»£å™¨ä¸»ä½“å¯ä»¥ä» <code>_new</code> é›†ä¸­åˆ é™¤å…ƒç´ ï¼Œä½†ä¸èƒ½é€šè¿‡èµ‹å€¼ç»™ <code>_new</code> æ·»åŠ ä»»ä½•å…ƒç´ ã€‚</p> <p>è¯·æ³¨æ„ï¼Œåœ¨è¿­ä»£å™¨çš„å‰ææ¡ä»¶ä¸­ï¼Œå³åšæŒæ„é€ è¿­ä»£å™¨ï¼Œå†…å‚æ•°ç¡®å®æ˜¯å†…å‚æ•°ï¼Œè€Œä¸æ˜¯ <code>this</code> çš„å­—æ®µã€‚</p> <h3 id="_5-5-å¼‚æ­¥ä»»åŠ¡ç±»å‹"><a href="#_5-5-å¼‚æ­¥ä»»åŠ¡ç±»å‹" class="header-anchor">#</a> 5.5.â€‚å¼‚æ­¥ä»»åŠ¡ç±»å‹</h3> <p>Dafny ä¸­å¦ä¸€ä¸ªå¯èƒ½ä¼šç»å†ä¸€äº›æ¼”å˜çš„å®éªŒæ€§åŠŸèƒ½æ˜¯<em>å¼‚æ­¥æ–¹æ³•</em>ã€‚ è°ƒç”¨å¼‚æ­¥æ–¹æ³•æ—¶ï¼Œå®ƒä¸ä¼šè¿”å› out-parameters çš„å€¼ï¼Œè€Œæ˜¯è¿”å› *async-task ç±»å‹ * çš„å®ä¾‹ã€‚ åœ¨<code>C</code>ç±»ä¸­å£°æ˜çš„å¼‚æ­¥æ–¹æ³•ï¼Œå…·æœ‰ä»¥ä¸‹ç­¾åï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>async method AMâŒ©TâŒª(in-params) returns (out-params)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ä¹Ÿäº§ç”Ÿäº†ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ç±»å‹<code>AMã€ˆTã€‰</code>ï¼ˆåœ¨å°é—­ç±»ä¹‹å¤–ï¼Œç±»å‹çš„åç§°éœ€è¦é™å®š<code>C.AMã€ˆTã€‰</code>ï¼‰ã€‚ async-task ç±»å‹æ˜¯ä¸€ä¸ªå¼•ç”¨ç±»å‹ï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæœ‰å„ç§æˆå‘˜çš„ç±»ï¼Œä¸‹é¢ä»‹ç»å®ƒçš„ç®€åŒ–ç‰ˆæœ¬ã€‚
å¼‚æ­¥æ–¹æ³•çš„æ¯ä¸ªç±»å‹ä¸º<code>X</code>çš„å‚æ•°<code>x</code>éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡ç±»å‹çš„ä¸å¯å˜å¹½çµå­—æ®µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>ghost var x: X;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ¯ä¸ª<code>Y</code>ç±»å‹çš„è¾“å‡ºå‚æ•°<code>y</code>éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªå­—æ®µ</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var y: Y;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è¿™äº›å­—æ®µä¼šåœ¨å¼‚æ­¥æ–¹æ³•æˆåŠŸç­‰å¾…æ—¶è‡ªåŠ¨æ›´æ”¹ï¼Œä½†ä¸èƒ½ç”±ç”¨æˆ·ä»£ç åˆ†é…ã€‚</p> <p>async-task ç±»å‹è¿˜æœ‰ä¸€äº›ç‰¹æ®Šå­—æ®µï¼Œç”¨äºè·Ÿè¸ªä¾èµ–å…³ç³»ã€æœªå®Œæˆçš„ä»»åŠ¡ã€æ–°åˆ†é…çš„å¯¹è±¡ç­‰ã€‚éšç€å¼‚æ­¥æ–¹æ³•è®¾è®¡çš„å‘å±•ï¼Œè¿™äº›å­—æ®µå°†è¢«æ›´è¯¦ç»†åœ°æè¿°ã€‚</p> <h2 id="_6-å‡½æ•°ç±»å‹"><a href="#_6-å‡½æ•°ç±»å‹" class="header-anchor">#</a> 6.â€‚å‡½æ•°ç±»å‹</h2> <p>å‡½æ•°æ˜¯ Dafny ä¸­çš„ä¸€ç­‰å€¼ã€‚ å‡½æ•°ç±»å‹å…·æœ‰ <code>(T) -&gt; U</code> çš„å½¢å¼ï¼Œå…¶ä¸­ <code>T</code> æ˜¯ä¸€ä¸ªä»¥é€—å·åˆ†éš”çš„ç±»å‹åˆ—è¡¨ï¼Œè€Œ <code>U</code> æ˜¯ä¸€ä¸ªç±»å‹ã€‚ <code>T</code> è¢«ç§°ä¸ºå‡½æ•°çš„ <em>domain type(s)</em> å¹¶ä¸” <code>U</code> æ˜¯å®ƒçš„ <em>range type</em>ã€‚ ä¾‹å¦‚ï¼Œå‡½æ•°çš„ç±»å‹</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>function F(x: int, b: bool): real
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æ˜¯<code>(int, bool) -&gt; real</code>ã€‚ å‚æ•°ä¸å…è®¸ä¸ºghostã€‚</p> <p>ä¸ºäº†ç®€åŒ–å‡½æ•°åŸŸç”±ä¸€ä¸ªç±»å‹åˆ—è¡¨ç»„æˆçš„åŸºæœ¬æƒ…å†µçš„å¤–è§‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹å¯ä»¥åˆ é™¤åŸŸç±»å‹å‘¨å›´çš„æ‹¬å·ï¼Œå¦‚ <code>T -&gt; U</code>ã€‚ åœ¨ä¸€ç§ç±»å‹æ˜¯å…ƒç»„ç±»å‹çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ— å®³çš„ç®€åŒ–éœ€è¦é¢å¤–çš„è§£é‡Šï¼Œå› ä¸ºå…ƒç»„ç±»å‹ä¹Ÿæ˜¯ç”¨æ‹¬å·æ‹¬èµ·æ¥çš„ã€‚ å¦‚æœå‡½æ•°æ¥å—ä¸€ä¸ªå…ƒç»„å‚æ•°ï¼Œåˆ™éœ€è¦é¢å¤–çš„ä¸€ç»„æ‹¬å·ã€‚ ä¾‹å¦‚ï¼Œå‡½æ•°</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>function G(pair: (int, bool)): real
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç±»å‹ä¸º <code>((int, bool)) -&gt; real</code>ã€‚ æ³¨æ„å¿…è¦çš„åŒæ‹¬å·ã€‚ ç±»ä¼¼åœ°ï¼Œä¸å¸¦å‚æ•°çš„å‡½æ•°ä¸å¸¦ 0 å…ƒç»„ä½œä¸ºå‚æ•°çš„å‡½æ•°ä¸åŒã€‚ ä¾‹å¦‚ï¼Œå‡½æ•°</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>function NoArgs(): real
function Z(unit: ()): real
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åˆ†åˆ«æœ‰ <code>() -&gt; real</code> å’Œ <code>(()) -&gt; real</code> ç±»å‹ã€‚</p> <p>å‡½æ•°ç®­å¤´ <code>-&gt;</code> æ˜¯å³ç»“åˆçš„ï¼Œæ‰€ä»¥ <code>A -&gt; B -&gt; C</code> è¡¨ç¤º <code>A -&gt; (B -&gt; C)</code>ã€‚ å¦ä¸€ä¸ªå…³è”éœ€è¦æ˜¾å¼æ‹¬å·ï¼š<code>(A -&gt; B) -&gt; C</code>ã€‚</p> <p>è¯·æ³¨æ„ï¼Œå‘½åå‡½æ•°çš„æ¥æ”¶å™¨å‚æ•°ä¸æ˜¯ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚ ç›¸åï¼Œå®ƒåœ¨æŸ¥æ‰¾å‡½æ•°æ—¶ä½¿ç”¨ï¼Œç„¶åå¯ä»¥è¢«è®¤ä¸ºæ˜¯è¢«æ•è·åˆ°å‡½æ•°å®šä¹‰ä¸­ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ä¸Šé¢çš„å‡½æ•°â€œFâ€åœ¨ç±»â€œCâ€ä¸­å£°æ˜ï¼Œè€Œâ€œcâ€å¼•ç”¨äº†ä¸€ä¸ªâ€œCâ€ç±»å‹çš„å¯¹è±¡ï¼› é‚£ä¹ˆï¼Œä»¥ä¸‹æ˜¯æ­£ç¡®çš„ç±»å‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var f: (int, bool) -&gt; real := c.F;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>è€Œå†™å¦‚ä¸‹å†…å®¹æ˜¯ä¸æ­£ç¡®çš„ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var f': (C, int, bool) -&gt; real := F;  // not correct
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åœ¨å…¶ç±»å‹ç­¾åä¹‹å¤–ï¼Œæ¯ä¸ªå‡½æ•°å€¼éƒ½å…·æœ‰ä¸‰ä¸ªå±æ€§ï¼Œå¦‚ä¸‹æ‰€è¿°ã€‚</p> <p>æ¯ä¸ªå‡½æ•°éƒ½éšå«åœ°å°†å †ä½œä¸ºå‚æ•°ã€‚ ç„¶è€Œï¼Œæ²¡æœ‰ä»»ä½•å‡½æ•°ä¾èµ–äº<em>æ•´ä¸ª</em>å †ã€‚ å‡½æ•°çš„ä¸€ä¸ªå±æ€§æ˜¯å®ƒåœ¨ç»™å®šè¾“å…¥æ‰€ä¾èµ–çš„å †ä½ç½®é›†ä¸Šå£°æ˜çš„ä¸Šé™ã€‚ è¿™è®©éªŒè¯è€…å¯ä»¥ç¡®å®šæŸäº›å †ä¿®æ”¹å¯¹æŸä¸ªå‡½æ•°è¿”å›çš„å€¼æ²¡æœ‰å½±å“ã€‚ å¯¹äºå‡½æ•°<code>f: T -&gt; U</code>å’Œ<code>T</code>ç±»å‹çš„å€¼<code>t</code>ï¼Œä¾èµ–é›†è¡¨ç¤ºä¸º<code>f.reads(t)</code>å¹¶ä¸”å…·æœ‰<code>setã€ˆobjectã€‰</code>ç±»å‹ã€‚</p> <p>å‡½æ•°çš„ç¬¬äºŒä¸ªå±æ€§æºäºæ¯ä¸ªå‡½æ•°éƒ½å¯èƒ½æ˜¯<em>éƒ¨åˆ†çš„</em>ã€‚ æ¢å¥è¯è¯´ï¼Œå‡½æ•°çš„å±æ€§æ˜¯å®ƒçš„<em>å‰ææ¡ä»¶</em>ã€‚ å¯¹äºå‡½æ•°<code>f: T -&gt; U</code>ï¼Œ<code>T</code>ç±»å‹çš„å‚æ•°å€¼<code>t</code>çš„<code>f</code>çš„å‰ææ¡ä»¶è¡¨ç¤ºä¸º<code>f.requires(t)</code>å¹¶ä¸”å…·æœ‰<code>bool</code>ç±»å‹ã€‚</p> <p>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå±æ€§æ›´ä¸ºæ˜æ˜¾â€”â€”å‡½æ•°ä½“ã€‚ å¯¹äºå‡½æ•°â€œf: T -&gt; Uâ€ï¼Œè¯¥å‡½æ•°å¯¹â€œTâ€ç±»å‹çš„è¾“å…¥â€œtâ€äº§ç”Ÿçš„å€¼è¡¨ç¤ºä¸ºâ€œf(t)â€ï¼Œå¹¶ä¸”å…·æœ‰â€œUâ€ç±»å‹ã€‚</p> <p>è¯·æ³¨æ„ï¼Œ<code>f.reads</code> å’Œ <code>f.requires</code> æœ¬èº«å°±æ˜¯å‡½æ•°ã€‚ å‡è®¾ <code>f</code> çš„ç±»å‹ä¸º <code>T -&gt; U</code>ï¼Œè€Œ <code>t</code> çš„ç±»å‹ä¸º <code>T</code>ã€‚ é‚£ä¹ˆï¼Œ<code>f.reads</code> æ˜¯ <code>T -&gt; setã€ˆobjectã€‰</code> ç±»å‹çš„å‡½æ•°ï¼Œå…¶ <code>reads</code> å’Œ <code>requires</code> å±æ€§æ˜¯ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>f.reads.reads(t) == f.reads(t)
f.reads.requires(t) == true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><code>f.requires</code> æ˜¯ <code>T -&gt; bool</code> ç±»å‹çš„å‡½æ•°ï¼Œå…¶ <code>reads</code> å’Œ <code>requires</code> å±æ€§ä¸ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>f.requires.reads(t) == f.reads(t)
f.requires.requires(t) == true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_6-0-lambdaè¡¨è¾¾å¼"><a href="#_6-0-lambdaè¡¨è¾¾å¼" class="header-anchor">#</a> 6.0.â€‚Lambdaè¡¨è¾¾å¼</h3> <p>é™¤äº†å‘½åå‡½æ•°ä¹‹å¤–ï¼ŒDafny è¿˜æ”¯æŒå®šä¹‰å‡½æ•°çš„è¡¨è¾¾å¼ã€‚ è¿™äº›è¢«ç§°ä¸º <em>lambda (expression)s</em>ï¼ˆä¸€äº›è¯­è¨€å°†å®ƒä»¬ç§°ä¸º <em>åŒ¿åå‡½æ•°</em>ï¼‰ã€‚ lambda è¡¨è¾¾å¼å…·æœ‰ä»¥ä¸‹å½¢å¼ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>(params) specification =&gt; body
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å…¶ä¸­ <code>*params*</code> æ˜¯ä»¥é€—å·åˆ†éš”çš„å‚æ•°å£°æ˜åˆ—è¡¨ï¼Œæ¯ä¸ªå‚æ•°å£°æ˜çš„å½¢å¼ä¸º <code>x</code> æˆ– <code>x: T</code>ã€‚ å‚æ•°çš„ç±»å‹â€˜Tâ€™åœ¨å¯ä»¥æ¨æ–­æ—¶å¯ä»¥çœç•¥ã€‚ å¦‚æœä¸éœ€è¦æ ‡è¯†ç¬¦<code>x</code>ï¼Œå¯ä»¥ç”¨â€œ<code>_</code>â€ä»£æ›¿ã€‚ å¦‚æœ <code>*params*</code> åŒ…å«ä¸€ä¸ªæ²¡æœ‰æ˜ç¡®ç±»å‹çš„å‚æ•° <code>x</code>ï¼ˆæˆ– <code>_</code>ï¼‰ï¼Œåˆ™å¯ä»¥åˆ é™¤æ‹¬å·ï¼› ä¾‹å¦‚ï¼Œè¿”å›ç»™å®šæ•´æ•°çš„åç»§çš„å‡½æ•°å¯ä»¥å†™æˆä»¥ä¸‹ lambda è¡¨è¾¾å¼ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>x =&gt; x + 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>*specification*</code> æ˜¯ <code>requires E</code> æˆ– <code>reads W</code> çš„å­å¥åˆ—è¡¨ï¼Œå…¶ä¸­ <code>E</code> æ˜¯å¸ƒå°”è¡¨è¾¾å¼ï¼Œ <code>W</code> æ˜¯æ¡†æ¶è¡¨è¾¾å¼ã€‚</p> <p><code>*body*</code> æ˜¯å®šä¹‰å‡½æ•°è¿”å›å€¼çš„è¡¨è¾¾å¼ã€‚ å¯¹äºæ»¡è¶³å‰ææ¡ä»¶çš„å‚æ•°çš„æ‰€æœ‰å¯èƒ½å€¼ï¼Œä¸»ä½“å¿…é¡»æ ¼å¼æ­£ç¡®ï¼ˆå°±åƒå‘½åå‡½æ•°å’Œæ–¹æ³•çš„ä¸»ä½“ä¸€æ ·ï¼‰ã€‚ åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™æ„å‘³ç€æœ‰å¿…è¦ç¼–å†™æ˜ç¡®çš„ <code>requires</code> å’Œ <code>reads</code> å­å¥ã€‚ ä¾‹å¦‚ï¼Œlambda è¡¨è¾¾å¼</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>x requires x != 0 =&gt; 100 / x
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœçœç•¥ <code>requires</code> å­å¥ï¼Œåˆ™æ ¼å¼ä¸æ­£ç¡®ï¼Œå› ä¸ºå¯èƒ½ä¼šè¢«é›¶é™¤ã€‚</p> <p>åœ¨å‡½æ•°ä¸èƒ½æ˜¯éƒ¨åˆ†çš„å¹¶ä¸”å¯¹è¯»å–å †æ²¡æœ‰é™åˆ¶çš„è®¾ç½®ä¸­ï¼Œå‡½æ•° <code>F: T -&gt; U</code> çš„ <em>eta æ‰©å±•</em>ï¼ˆå³ï¼Œå°† <code>F</code> åŒ…è£…åœ¨è¿™æ ·çš„ lambda è¡¨è¾¾å¼ä¸­ï¼‰ lambda è¡¨è¾¾å¼ç­‰ä»·äº <code>F</code>) çš„æ–¹å¼å°†å†™ä½œ <code>x =&gt; F(x)</code>ã€‚ åœ¨ Dafny ä¸­ï¼Œeta æ‰©å±•è¿˜å¿…é¡»è€ƒè™‘å‡½æ•°çš„å‰ææ¡ä»¶å’Œè¯»å–é›†ï¼Œå› æ­¤ <code>F</code> çš„ eta æ‰©å±•å¦‚ä¸‹æ‰€ç¤ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>x requires F.requires(x) reads F.reads(x) =&gt; F(x)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_7-æ–°ç±»å‹"><a href="#_7-æ–°ç±»å‹" class="header-anchor">#</a> 7.â€‚æ–°ç±»å‹</h2> <p>å¯ä»¥ä½¿ç”¨ <em>newtype</em> å£°æ˜<a href="http://leino.science/papers/krml243.html#fn-fn-newtype-name" target="_blank" rel="noopener noreferrer">7<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> å£°æ˜æ–°çš„æ•°å­—ç±»å‹</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>newtype N = x: M | Q
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å…¶ä¸­â€œMâ€æ˜¯æ•°å­—ç±»å‹ï¼Œâ€œQâ€æ˜¯å¸ƒå°”è¡¨è¾¾å¼ï¼Œå¯ä»¥å°†â€œxâ€ç”¨ä½œè‡ªç”±å˜é‡ã€‚ å¦‚æœ<code>M</code>æ˜¯ä¸€ä¸ªåŸºäºæ•´æ•°çš„æ•°å€¼ç±»å‹ï¼Œé‚£ä¹ˆ<code>N</code>ä¹Ÿæ˜¯ï¼› å¦‚æœâ€œMâ€æ˜¯å®æ•°ï¼Œé‚£ä¹ˆâ€œNâ€ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ å¦‚æœå¯ä»¥ä» <code>Q</code> æ¨æ–­å‡ºç±»å‹ <code>M</code>ï¼Œåˆ™å¯ä»¥çœç•¥â€œ<code>:M</code>â€ã€‚ å¦‚æœ <code>Q</code> åªæ˜¯ <code>true</code>ï¼Œé‚£ä¹ˆå£°æ˜å¯ä»¥ç®€å•åœ°ç»™å‡ºï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>newtype N = M
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>ç±»å‹â€œMâ€è¢«ç§°ä¸ºâ€œNâ€çš„<em>åŸºæœ¬ç±»å‹</em>ã€‚</p> <p>newtype æ˜¯ä¸€ç§æ•°å­—ç±»å‹ï¼Œå®ƒæ”¯æŒä¸å…¶åŸºæœ¬ç±»å‹ç›¸åŒçš„æ“ä½œã€‚ newtype ä¸å…¶ä»–æ•°å­—ç±»å‹ä¸åŒä¸”ä¸å…¼å®¹ï¼› ç‰¹åˆ«æ˜¯ï¼Œå¦‚æœæ²¡æœ‰æ˜¾å¼è½¬æ¢ï¼Œå®ƒå°±ä¸èƒ½åˆ†é…ç»™å®ƒçš„åŸºæœ¬ç±»å‹ã€‚ å¯¹ newtype çš„æ“ä½œä¸å…¶åŸºç±»å‹çš„æ“ä½œä¹‹é—´çš„ä¸€ä¸ªé‡è¦åŒºåˆ«æ˜¯ newtype æ“ä½œä»…åœ¨ç»“æœæ»¡è¶³è°“è¯ <code>Q</code> æ—¶æ‰è¢«å®šä¹‰ï¼Œå¯¹äº newtype çš„å­—é¢é‡ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ [8](http:// /leino.science/papers/krml243.html#fn-fn-newtype-design-questionï¼‰</p> <p>ä¾‹å¦‚ï¼Œå‡è®¾ <code>lo</code> å’Œ <code>hi</code> æ˜¯åŸºäºæ•´æ•°çš„æ•°å­—ï¼Œå®ƒä»¬æ»¡è¶³ <code>0 &lt;= lo &lt;= hi</code> å¹¶è€ƒè™‘ä»¥ä¸‹ä»£ç ç‰‡æ®µï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var mid := (lo + hi) / 2;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœ <code>lo</code> å’Œ <code>hi</code> çš„ç±»å‹ä¸º <code>int</code>ï¼Œé‚£ä¹ˆä»£ç ç‰‡æ®µæ˜¯åˆæ³•çš„ï¼› ç‰¹åˆ«æ˜¯ï¼Œå®ƒæ°¸è¿œä¸ä¼šæº¢å‡ºï¼Œå› ä¸º <code>int</code> æ²¡æœ‰ä¸Šé™ã€‚ ç›¸åï¼Œå¦‚æœ <code>lo</code> å’Œ <code>hi</code> æ˜¯æ–°ç±»å‹ <code>int32</code> çš„å˜é‡ï¼Œå£°æ˜å¦‚ä¸‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>newtype int32 = x | -0x80000000 &lt;= x &lt; 0x80000000
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>é‚£ä¹ˆä»£ç ç‰‡æ®µæ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºåŠ æ³•çš„ç»“æœå¯èƒ½æ— æ³•æ»¡è¶³<code>int32</code>å®šä¹‰ä¸­çš„è°“è¯ã€‚ ä»£ç ç‰‡æ®µå¯ä»¥é‡å†™ä¸º</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var mid := lo + (hi - lo) / 2;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ<code>int</code> å’Œ <code>int32</code> éƒ½æ˜¯åˆæ³•çš„ã€‚</p> <p>ç”±äº newtype ä¸å…¶åŸºç±»å‹ä¸å…¼å®¹ï¼Œå¹¶ä¸”ç”±äº newtype æ“ä½œçš„æ‰€æœ‰ç»“æœéƒ½æ˜¯ newtype çš„æˆå‘˜ï¼Œå› æ­¤ Dafny çš„ç¼–è¯‘å™¨å¯ä»¥è‡ªç”±åœ°ä¸“é—¨åŒ– newtype çš„è¿è¡Œæ—¶è¡¨ç¤ºã€‚ ä¾‹å¦‚ï¼Œé€šè¿‡ä»”ç»†æ£€æŸ¥ä¸Šé¢ <code>int32</code> çš„å®šä¹‰ï¼Œç¼–è¯‘å™¨å¯èƒ½ä¼šå†³å®šåœ¨ç›®æ ‡ç¡¬ä»¶ä¸­ä½¿ç”¨å¸¦ç¬¦å·çš„ 32 ä½æ•´æ•°æ¥å­˜å‚¨ <code>int32</code> å€¼ã€‚</p> <p>è¯·æ³¨æ„ï¼Œ<code>Q</code> ä¸­çš„ç»‘å®šå˜é‡<code>x</code> çš„ç±»å‹ä¸º<code>M</code>ï¼Œè€Œä¸æ˜¯<code>N</code>ã€‚ nå› æ­¤ï¼Œå¯èƒ½æ— æ³•å°±â€œNâ€å€¼è¯´æ˜â€œQâ€ã€‚ ä¾‹å¦‚ï¼Œè€ƒè™‘ä»¥ä¸‹ç±»å‹çš„ 8 ä½ 2 çš„è¡¥ç æ•´æ•°ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>newtype int8 = x: int | -128 &lt;= x &lt; 128
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¹¶è€ƒè™‘ä¸€ä¸ªç±»å‹ä¸º<code>int8</code>çš„å˜é‡<code>c</code>ã€‚ è¡¨è¾¾å¼</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>-128 &lt;= c &lt; 128
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å®šä¹‰ä¸æ˜ç¡®ï¼Œå› ä¸ºæ¯”è¾ƒè¦æ±‚æ¯ä¸ªæ“ä½œæ•°çš„ç±»å‹ä¸ºâ€œint8â€ï¼Œè¿™æ„å‘³ç€æ–‡å­—â€œ128â€è¢«æ£€æŸ¥ä¸ºâ€œint8â€ç±»å‹ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚ ç¼–å†™æ­¤è¡¨è¾¾å¼çš„æ­£ç¡®æ–¹æ³•æ˜¯åœ¨ <code>c</code> ä¸Šä½¿ç”¨è½¬æ¢æ“ä½œï¼Œå¦‚ä¸‹æ‰€è¿°ï¼Œå°†å…¶è½¬æ¢ä¸ºåŸºæœ¬ç±»å‹ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>-128 &lt;= int(c) &lt; 128
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>æœ‰ä¸€ä¸ªé™åˆ¶ï¼Œå³å€¼<code>0</code>å¿…é¡»æ˜¯æ¯ä¸ªæ–°ç±»å‹çš„ä¸€éƒ¨åˆ†ã€‚<a href="http://leino.science/papers/krml243.html#fn-fn-newtype-zero" target="_blank" rel="noopener noreferrer">9<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_7-0-æ•°å­—è½¬æ¢æ“ä½œ"><a href="#_7-0-æ•°å­—è½¬æ¢æ“ä½œ" class="header-anchor">#</a> 7.0.â€‚æ•°å­—è½¬æ¢æ“ä½œ</h3> <p>å¯¹äºæ¯ä¸ªæ•°å­—ç±»å‹<code>N</code>ï¼Œéƒ½æœ‰ä¸€ä¸ªåŒåçš„è½¬æ¢å‡½æ•°ã€‚ å®ƒæ˜¯ä¸€ä¸ªéƒ¨åˆ†æ’ç­‰å‡½æ•°ã€‚ å®ƒæ˜¯åœ¨ç»™å®šå€¼ï¼ˆå¯ä»¥æ˜¯ä»»ä½•æ•°å­—ç±»å‹ï¼‰æ˜¯è½¬æ¢ä¸ºçš„ç±»å‹çš„æˆå‘˜æ—¶å®šä¹‰çš„ã€‚ å½“ä»åŸºäºå®æ•°çš„æ•°å€¼ç±»å‹è½¬æ¢ä¸ºåŸºäºæ•´æ•°çš„æ•°å€¼ç±»å‹æ—¶ï¼Œè¯¥æ“ä½œè¦æ±‚åŸºäºå®æ•°çš„å‚æ•°æ²¡æœ‰å°æ•°éƒ¨åˆ†ã€‚ ï¼ˆè¦å°†åŸºäºå®æ•°çš„æ•°å€¼å‘ä¸‹èˆå…¥åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ï¼Œè¯·ä½¿ç”¨ <code>.Trunc</code> æˆå‘˜ï¼Œè¯·å‚é˜…ç¬¬ [0.1] èŠ‚ï¼ˆhttp://leino.science/papers/krml243.html#sec-numeric-typesï¼‰ã€‚ )</p> <p>ä½¿ç”¨ä¸Šé¢çš„ä¾‹å­æ¥è¯´æ˜ï¼Œå¦‚æœ <code>lo</code> å’Œ <code>hi</code> çš„ç±»å‹æ˜¯ <code>int32</code>ï¼Œé‚£ä¹ˆä»£ç ç‰‡æ®µå¯ä»¥åˆæ³•åœ°å†™æˆå¦‚ä¸‹</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var mid := (int(lo) + int(hi)) / 2;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å…¶ä¸­<code>mid</code>çš„ç±»å‹è¢«æ¨æ–­ä¸º<code>int</code>ã€‚ ç”±äºé™¤æ³•çš„ç»“æœå€¼æ˜¯ <code>int32</code> ç±»å‹çš„æˆå‘˜ï¼Œå› æ­¤å¯ä»¥å¼•å…¥å¦ä¸€ç§è½¬æ¢æ“ä½œï¼Œä½¿ <code>mid</code> çš„ç±»å‹ä¸º <code>int32</code>ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>var mid := int32((int(lo) + int(hi)) / 2);
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å¦‚æœç¼–è¯‘å™¨ç¡®å®ä¸“é—¨é’ˆå¯¹<code>int32</code>çš„è¿è¡Œæ—¶è¡¨ç¤ºï¼Œé‚£ä¹ˆè¿™äº›è¯­å¥çš„ä»£ä»·æ˜¯ä¸¤ä¸ªæˆ–ä¸‰ä¸ªè¿è¡Œæ—¶è½¬æ¢ã€‚</p> <h2 id="_8-å­é›†ç±»å‹"><a href="#_8-å­é›†ç±»å‹" class="header-anchor">#</a> 8.â€‚å­é›†ç±»å‹</h2> <p><em>å­é›†ç±»å‹</em>æ˜¯å¯¹ç°æœ‰ç±»å‹çš„é™åˆ¶ä½¿ç”¨ï¼Œç§°ä¸ºå­é›†ç±»å‹çš„<em>åŸºæœ¬ç±»å‹</em>ã€‚ å­é›†ç±»å‹å°±åƒåŸºç±»å‹å’ŒåŸºç±»å‹ä¸Šçš„è°“è¯çš„ç»„åˆä½¿ç”¨ã€‚</p> <p>å§‹ç»ˆå…è®¸ä»å­é›†ç±»å‹åˆ°å…¶åŸºæœ¬ç±»å‹çš„èµ‹å€¼ã€‚ å¦‚æœåˆ†é…çš„å€¼ç¡®å®æ»¡è¶³å­é›†ç±»å‹çš„è°“è¯ï¼Œåˆ™å…è®¸ä»åŸºæœ¬ç±»å‹åˆ°å­é›†ç±»å‹çš„å¦ä¸€ä¸ªæ–¹å‘çš„åˆ†é…ã€‚ ï¼ˆæ³¨æ„ï¼Œç›¸æ¯”ä¹‹ä¸‹ï¼Œnewtype å’Œå®ƒçš„åŸºç±»å‹ä¹‹é—´çš„èµ‹å€¼æ˜¯ä¸å…è®¸çš„ï¼Œå³ä½¿èµ‹å€¼æ˜¯ç›®æ ‡ç±»å‹çš„å€¼ã€‚å¯¹äºè¿™æ ·çš„èµ‹å€¼ï¼Œå¿…é¡»ä½¿ç”¨æ˜¾å¼è½¬æ¢ï¼Œå‚è§ç¬¬ [7.0]ï¼ˆhttp: //leino.science/papers/krml243.html#sec-numeric-conversions)ã€‚) Dafny æ”¯æŒä¸€ç§å­é›†ç±»å‹ï¼Œå³å†…ç½®ç±»å‹ <code>nat</code>ï¼Œå…¶åŸºæœ¬ç±»å‹ä¸º <code>int</code>ã€‚[10](http: //leino.science/papers/krml243.html#fn-fn-more-subset-typesï¼‰</p> <p>ç±»å‹<code>nat</code>æŒ‡å®š<code>int</code>çš„éè´Ÿå­èŒƒå›´ã€‚ ä¸€ä¸ªå¾ˆå¥½åœ°ä½¿ç”¨å­é›†ç±»å‹â€œnatâ€çš„ç®€å•ç¤ºä¾‹æ˜¯æ ‡å‡†æ–æ³¢é‚£å¥‘å‡½æ•°ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>function Fib(n: nat): nat
{
  if n &lt; 2 then n else Fib(n-2) + Fib(n-1)
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>æ­¤å‡½æ•°çš„ç­‰æ•ˆä½†ç¬¨æ‹™çš„å…¬å¼ï¼ˆä»¥è°ƒç”¨ç«™ç‚¹äº§ç”Ÿçš„ä»»ä½•é”™è¯¯æ¶ˆæ¯çš„æªè¾ä¸ºæ¨¡ï¼‰å°†ä½¿ç”¨ç±»å‹<code>int</code>å¹¶åœ¨å‰ç½®æ¡ä»¶å’Œåç½®æ¡ä»¶ä¸­ç¼–å†™é™åˆ¶è°“è¯ï¼š</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>function Fib(n: int): int
  requires 0 &lt;= n  // the function argument must be non-negative
  ensures 0 &lt;= Fib(n)  // the function result is non-negative
{
  if n &lt; 2 then n else Fib(n-2) + Fib(n-1)
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>ç±»å‹æ¨æ–­æ°¸è¿œä¸ä¼šå°†å˜é‡çš„ç±»å‹æ¨æ–­ä¸ºå­é›†ç±»å‹ã€‚ ç›¸åï¼Œå®ƒä¼šå°†ç±»å‹æ¨æ–­ä¸ºå­é›†ç±»å‹çš„åŸºæœ¬ç±»å‹ã€‚ ä¾‹å¦‚ï¼Œ<code>x</code> çš„ç±»å‹</p> <div class="language-dafny line-numbers-mode"><pre class="language-text"><code>forall x :: P(x)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>å°†æ˜¯ <code>int</code>ï¼Œå³ä½¿è°“è¯ <code>P</code> å£°æ˜å…¶å‚æ•°çš„ç±»å‹ä¸º <code>nat</code>ã€‚</p> <h4 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="header-anchor">#</a> å‚è€ƒèµ„æ–™</h4> <p>ç”±äº Nadia Polikarpova å’Œ Paqui Lucio çš„è¯„è®ºï¼Œæœ¬æ–‡æ¡£å¾—åˆ°äº†æ”¹è¿›ã€‚</p> <hr> <ol start="0"><li>æ”¯æŒå¹³ç­‰åªæ˜¯äººä»¬å¯ä»¥æƒ³è±¡çš„ä¸°å¯Œç±»å‹ç³»ç»Ÿä¸­çš„ç±»å‹æ‹¥æœ‰çš„ä¼—å¤š<em>æ¨¡å¼</em>ä¹‹ä¸€ã€‚ ä¾‹å¦‚ï¼Œå…¶ä»–æ¨¡å¼å¯èƒ½åŒ…æ‹¬å…·æœ‰æ€»è®¢å•ã€å¯é›¶åˆå§‹åŒ–ä»¥åŠå¯èƒ½æ— äººå±…ä½ã€‚ å¦‚æœ Dafny å°†æ¥æ”¯æŒæ›´å¤šæ¨¡å¼ï¼Œâ€œ<code>( )</code>â€åç¼€è¯­æ³•å¯èƒ½ä¼šè¢«æ‰©å±•ã€‚ ç›®å‰ï¼Œåç¼€åªèƒ½è¡¨ç¤ºæ”¯æŒå¹³ç­‰çš„æ¨¡å¼ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-type-mode" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>ç°åœ¨Dafnyæ”¯æŒå†…ç½®å…ƒç»„ï¼Œæ‰“ç®—æŠŠåºåˆ—åˆ‡ç‰‡æ“ä½œæ”¹æˆè¿”å› ä¸æ˜¯å­åºåˆ—çš„åºåˆ—ï¼Œè€Œæ˜¯å­åºåˆ—çš„å…ƒç»„ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-slice-into-tuple" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>è¿™å¯èƒ½ä¼šåœ¨æœªæ¥å‘ç”Ÿå˜åŒ–ï¼Œä¸å…è®¸å¤šæ¬¡å‡ºç°ç›¸åŒçš„é”®ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-map-display" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>è¿™åœ¨æœªæ¥å¯èƒ½ä¼šæ”¹å˜å¦‚ä¸‹ï¼š<code>in</code>å’Œ<code>!in</code> åœ°å›¾å°†ä¸å†æ”¯æŒæ“ä½œã€‚ ç›¸åï¼Œå¯¹äºä»»ä½•åœ°å›¾ <code>m</code>ï¼Œ<code>m.Domain</code> å°†è¿”å›å…¶åŸŸä½œä¸ºä¸€ä¸ªé›†åˆï¼Œè€Œ <code>m.Range</code> å°†è¿”å›ï¼Œä¹Ÿä½œä¸ºä¸€ä¸ªé›†åˆï¼Œåœ¨å…¶åŸŸä¸‹çš„ <code>m</code> çš„å›¾åƒã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-map-membership" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>è¿™å°†åœ¨ Dafny çš„æœªæ¥ç‰ˆæœ¬ä¸­å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°†åŒæ—¶æ”¯æŒå¯ç©ºå’Œï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼‰é -null å¼•ç”¨ç±»å‹ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-nullable" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>å¾ˆå¿«ï¼Œ<code>object</code> å°†æˆä¸ºä¸€ä¸ªå†…ç½®çš„ trait è€Œä¸æ˜¯å†…ç½®çš„ç‰¹æ®Š ç­çº§ã€‚ å‘ç”Ÿè¿™ç§æƒ…å†µæ—¶ï¼Œå°†ä¸å†å¯èƒ½æ‰§è¡Œâ€œæ–°å¯¹è±¡â€ã€‚ <code>object</code> ä¸èƒ½ç”¨ä½œç±»å‹å‚æ•°çš„å½“å‰ç¼–è¯‘å™¨é™åˆ¶ä¹Ÿå°†æ¶ˆå¤±ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-object-trait" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>å°†ç‰¹æ®Šå­—æ®µ<code>_reads</code>å’Œ<code>_modifies</code>é‡å‘½åä¸ºç›¸åŒæ˜¯æœ‰æ„ä¹‰çš„ åç§°ä½œä¸ºç›¸åº”çš„å…³é”®å­—ï¼Œâ€œè¯»å–â€å’Œâ€œä¿®æ”¹â€ï¼Œå°±åƒå¯¹å‡½æ•°å€¼æ‰€åšçš„é‚£æ ·ã€‚ æ­¤å¤–ï¼Œå„ç§ <code>_decreases*i*</code> å­—æ®µå¯ä»¥ç»„åˆæˆä¸€ä¸ªåä¸º <code>decreases</code> çš„å­—æ®µï¼Œå…¶ç±»å‹æ˜¯ <em>n</em> å…ƒç»„ã€‚
<a href="http://leino.science/papers/krml243.html#back-fn-fn-iterator-field-names" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>æ˜¯å¦åº”è¯¥å°†<code>newtype</code>é‡å‘½åä¸º<code>numtype</code>ï¼Ÿ <a href="http://leino.science/papers/krml243.html#back-fn-fn-newtype-name" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>è‡ªåŠ¨å®šä¹‰â€œè°“è¯Nâ€æœ‰ç”¨å—ï¼Ÿ(m:M){Q} `? <a href="http://leino.science/papers/krml243.html#back-fn-fn-newtype-design-question" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>é™åˆ¶æ˜¯ç”±äºå½“å‰ç¼–è¯‘å™¨çš„é™åˆ¶ã€‚ è¿™å°†åœ¨æœªæ¥å‘ç”Ÿå˜åŒ–ï¼Œä¹Ÿå°†ä¸ºå­é›†ç±»å‹å’Œéç©ºå¼•ç”¨ç±»å‹å¼€è¾Ÿå¯èƒ½æ€§ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-newtype-zero" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>Dafny çš„æœªæ¥ç‰ˆæœ¬å°†æ”¯æŒç”¨æˆ·å®šä¹‰çš„å­é›†ç±»å‹ã€‚ <a href="http://leino.science/papers/krml243.html#back-fn-fn-more-subset-types" target="_blank" rel="noopener noreferrer">â†©<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/aaron-clou/dafnycommunity/edit/master/docs/40.èµ„æº/10.å¸¸ç”¨å·¥å…·/00.Dafny type system.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2022/03/26, 19:35:15</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/dafnycommunity/pages/be298d/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">åœ¨é›†åˆä¸Šè¿­ä»£</div></a> <a href="/dafnycommunity/pages/0f17ab/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Style Guide for Dafny programs</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        â†
        <a href="/dafnycommunity/pages/be298d/" class="prev">åœ¨é›†åˆä¸Šè¿­ä»£</a></span> <span class="next"><a href="/dafnycommunity/pages/0f17ab/">Style Guide for Dafny programs</a>â†’
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/dafnycommunity/archives/" class="iconfont icon-bi">æœ€è¿‘æ›´æ–°</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/dafnycommunity/pages/0978ce/"><div>
            å¯»æ‰¾æœ€å¤§å’Œæœ€å°æ•°
            <!----></div></a> <span class="date">04-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/dafnycommunity/pages/e3e481/"><div>
            æ–æ³¢é‚£å¥‘æ•°åˆ—
            <!----></div></a> <span class="date">04-06</span></dt></dl><dl><dd>03</dd> <dt><a href="/dafnycommunity/pages/02fdef/"><div>
            çº¿æ€§æŸ¥è¯¢
            <!----></div></a> <span class="date">04-06</span></dt></dl> <dl><dd></dd> <dt><a href="/dafnycommunity/archives/" class="more">æ›´å¤šæ–‡ç« &gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/Aaron-clou/dafnycommunity" title="Github" target="_blank" class="iconfont icon-github-fill"></a><a href="https://gitee.com/leo214/dafnycommunity" title="Gitee" target="_blank" class="iconfont icon-gitee2"></a><a href="1374921025@qq.com" title="Email" target="_blank" class="iconfont icon-email-fill"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="æœ¬ç«™ä¸»é¢˜">Vdoing</a> 
    | Copyright Â© 2022-2022
    <span>Li Jiahai | Dafny Community | 2022</span></div> <div class="buttons"><div title="è¿”å›é¡¶éƒ¨" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="å»è¯„è®º" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="ä¸»é¢˜æ¨¡å¼" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          è·Ÿéšç³»ç»Ÿ
        </li><li class="iconfont icon-rijianmoshi">
          æµ…è‰²æ¨¡å¼
        </li><li class="iconfont icon-yejianmoshi">
          æ·±è‰²æ¨¡å¼
        </li><li class="iconfont icon-yuedu">
          é˜…è¯»æ¨¡å¼
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><!----><div id="tcomment"></div><div></div></div></div>
    <script src="/dafnycommunity/assets/js/app.99d07194.js" defer></script><script src="/dafnycommunity/assets/js/2.ab4658c0.js" defer></script><script src="/dafnycommunity/assets/js/63.83de9482.js" defer></script><script src="/dafnycommunity/assets/js/7.5451cfed.js" defer></script><script src="/dafnycommunity/assets/js/4.06497870.js" defer></script>
  </body>
</html>
